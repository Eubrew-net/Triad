
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Inst_Wl183_2016_2019</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-08-20"><meta name="DC.source" content="Inst_Wl183_2016_2019.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Brewer Evaluation</a></li><li><a href="#3">Configs: Operative</a></li><li><a href="#4">Configs: Check</a></li><li><a href="#6">EVENTOS</a></li><li><a href="#7">Historical review AVG info</a></li><li><a href="#12">DT</a></li><li><a href="#15">Command-Print</a></li><li><a href="#16">Temperature dependence</a></li><li><a href="#17">Global temperature</a></li><li><a href="#19">dark evaluation</a></li><li><a href="#20">DARK</a></li><li><a href="#22">Filter attenuation</a></li><li><a href="#23">SC's</a></li><li><a href="#24">CZ Report</a></li><li><a href="#25">DSP's</a></li><li><a href="#26">Historic</a></li></ul></div><pre class="codeinput"><span class="comment">% options_pub=struct('outputDir',fullfile('..','html'),'showCode',true);</span>
<span class="comment">% close all; publish(fullfile(pwd,'Inst_Wl183.m'),options_pub);</span>
</pre><h2 id="2">Brewer Evaluation</h2><pre class="codeinput">clear <span class="string">all</span>;
file_setup=<span class="string">'calizo_setup'</span>;
run(fullfile(<span class="string">'..'</span>,file_setup));     <span class="comment">% configuracion por defecto</span>

Cal.n_inst=find(Cal.brw==183);
Cal.Date.CALC_DAYS=datenum(2015,6,1):now;

OP_config =Cal.brw_config_files{Cal.n_inst,1};
ALT_config=Cal.brw_config_files{Cal.n_inst,2};

Cal.file_latex = fullfile(<span class="string">'..'</span>,<span class="string">'latex'</span>);
Cal.dir_figs   = fullfile(Cal.file_latex,filesep(),<span class="string">'figures'</span>);
mkdir(Cal.dir_figs);
</pre><pre class="codeoutput">
Cal = 

  struct with fields:

    path_root: '/Users/aredondasm/CODE/rbcce.aemet.es/iberonesia'

Config files OK
</pre><h2 id="3">Configs: Operative</h2><pre class="codeinput">[a b c]=fileparts(OP_config);
<span class="keyword">try</span>
   <span class="keyword">if</span> ~strcmpi(strcat(b,c),sprintf(<span class="string">'config%d.cfg'</span>,Cal.brw(Cal.n_inst)))
      fprintf(strcat(1,<span class="string">'\rCUIDADO!! Puede que las configuraciones cargadas no sean las esperadas\n'</span>,<span class="keyword">...</span>
                       <span class="string">'(Expected: %s, Loading: %s)\n'</span>),<span class="keyword">...</span>
              sprintf(<span class="string">'config%d.cfg'</span>,Cal.brw(Cal.n_inst)),strcat(b,c));
   <span class="keyword">end</span>
   events_cfg_op=getcfgs(Cal.Date.CALC_DAYS,OP_config);
   fprintf(<span class="string">'\nBrewer %s: Operative Config.\n'</span>,Cal.brw_name{Cal.n_inst});
   displaytable(events_cfg_op.data(2:end,:),cellstr(datestr(events_cfg_op.data(1,:),1))',12,<span class="string">'.5g'</span>,events_cfg_op.legend(2:end));
<span class="keyword">catch</span> exception
   fprintf(<span class="string">'%s, brewer: %s\n'</span>,exception.message,Cal.brw_str{Cal.n_inst});
<span class="keyword">end</span>
matrix2latex_config(events_cfg_op.data(2:end,:),fullfile(Cal.file_latex,[<span class="string">'Op_config_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                    <span class="string">'rowlabels'</span>,events_cfg_op.legend(2:end),<span class="string">'columnlabels'</span>,cellstr(datestr(events_cfg_op.data(1,:),1))',<span class="keyword">...</span>
                    <span class="string">'size'</span>,<span class="string">'footnotesize'</span>);

[c,ia]=unique(events_cfg_op.data(2:end,:)',<span class="string">'rows'</span>,<span class="string">'stable'</span>);
tableop_183=array2table(c,<span class="string">'VariableNames'</span>,str2name(events_cfg_op.legend(2:end)));
tableop_183.Date=datetime(datestr(events_cfg_op.data(1,ia)));
tableop_183=tableop_183(:,[end,1:end-1])
</pre><pre class="codeoutput">
Brewer IZO#183: Operative Config.
                |  10-Apr-2015 |  09-Jun-2015 |  27-Sep-2015 |  17-Feb-2016 |  11-Mar-2016 |  18-Mar-2016 |  13-Jul-2016 |  01-Dec-2016 |  05-Dec-2016 |  13-Feb-2017 |  06-Mar-2017 |  06-Nov-2017 |  14-Jan-2018 |  27-Feb-2018 |  01-Mar-2018 |  25-Apr-2018 |  29-Oct-2018 |  20-Apr-2019
 o3 Temp coef 1 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
 o3 Temp coef 2 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292
 o3 Temp coef 3 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149
 o3 Temp coef 4 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384
 o3 Temp coef 5 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919
 O3 on O3 Ratio |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |       0.3405 |       0.3405 |       0.3405 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341
ETC on O3 Ratio |         1640 |         1630 |         1630 |         1630 |         1630 |         1630 |         1630 |         1630 |         1630 |         1620 |         1620 |         1620 |         1625 |         1625 |         1555 |         1555 |         1565 |         1555
Dead time (sec) |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.4e-08 |      2.4e-08 |      2.5e-08 |      2.5e-08
            csn |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020
    ND filter 0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
    ND filter 1 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350
    ND filter 2 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250
    ND filter 3 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100
    ND filter 4 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500
    ND filter 5 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800
             R6 |          395 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |          385 |        307.5 |        307.5 |        307.5 |        307.5
             R5 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550
          F#2_C |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
          F#3_C |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
          F#4_C |           -8 |           -8 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0

tableop_183 =

  9&times;21 table

       Date        o3TempCoef1    o3TempCoef2    o3TempCoef3    o3TempCoef4    o3TempCoef5    O3OnO3Ratio    ETCOnO3Ratio    DeadTime_sec_    csn     NDFilter0    NDFilter1    NDFilter2    NDFilter3    NDFilter4    NDFilter5     R6      R5     F_2_C    F_3_C    F_4_C
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    _____________    ____    _________    _________    _________    _________    _________    _________    _____    ___    _____    _____    _____

    10-Apr-2015         0           0.0292         0.2149          0.384         0.4919          0.341           1640           2.3e-08       1020        0          4350         10250        14100        21500        25800        395    550      0        0       -8  
    09-Jun-2015         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800        385    550      0        0       -8  
    27-Sep-2015         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800        385    550      0        0        0  
    18-Mar-2016         0           0.0292         0.2149          0.384         0.4919         0.3405           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800        385    550      0        0        0  
    13-Feb-2017         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800        385    550      0        0        0  
    14-Jan-2018         0           0.0292         0.2149          0.384         0.4919          0.341           1625           2.3e-08       1020        0          4350         10250        14100        21500        25800        385    550      0        0        0  
    01-Mar-2018         0           0.0292         0.2149          0.384         0.4919          0.341           1555           2.4e-08       1020        0          4350         10250        14100        21500        25800      307.5    550      0        0        0  
    29-Oct-2018         0           0.0292         0.2149          0.384         0.4919          0.341           1565           2.5e-08       1020        0          4350         10250        14100        21500        25800      307.5    550      0        0        0  
    20-Apr-2019         0           0.0292         0.2149          0.384         0.4919          0.341           1555           2.5e-08       1020        0          4350         10250        14100        21500        25800      307.5    550      0        0        0  

</pre><h2 id="4">Configs: Check</h2><pre class="codeinput">[a b c]=fileparts(ALT_config);
<span class="keyword">try</span>
   <span class="keyword">if</span> ~strcmpi(strcat(b,c),sprintf(<span class="string">'config%d_a.cfg'</span>,Cal.brw(Cal.n_inst)))
      fprintf(strcat(1,<span class="string">'\rCUIDADO!! Puede que las configuraciones cargadas no sean las esperadas\n'</span>,<span class="keyword">...</span>
                       <span class="string">'(Expected: %s, Loading: %s)\n'</span>),<span class="keyword">...</span>
              sprintf(<span class="string">'config%d_a.cfg'</span>,Cal.brw(Cal.n_inst)),strcat(b,c));
   <span class="keyword">end</span>
   events_cfg_chk=getcfgs(Cal.Date.CALC_DAYS,ALT_config);
   fprintf(<span class="string">'\nBrewer %s: Second Config.\n'</span>,Cal.brw_name{Cal.n_inst});
   displaytable(events_cfg_chk.data(2:end,:),cellstr(datestr(events_cfg_chk.data(1,:),1))',12,<span class="string">'.5g'</span>,events_cfg_chk.legend(2:end));
<span class="keyword">catch</span> exception
   fprintf(<span class="string">'%s, brewer: %s\n'</span>,exception.message,Cal.brw_str{Cal.n_inst});
<span class="keyword">end</span>
matrix2latex_config(events_cfg_chk.data(2:end,:),fullfile(Cal.file_latex,[<span class="string">'Chk_config_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                    <span class="string">'rowlabels'</span>,events_cfg_chk.legend(2:end),<span class="string">'columnlabels'</span>,cellstr(datestr(events_cfg_chk.data(1,:),1))',<span class="keyword">...</span>
                    <span class="string">'size'</span>,<span class="string">'footnotesize'</span>);

[c,ia]=unique(events_cfg_chk.data(2:end,:)',<span class="string">'rows'</span>,<span class="string">'stable'</span>)
tablec_183=array2table(c,<span class="string">'VariableNames'</span>,str2name(events_cfg_op.legend(2:end)))
tablec_183.Date=datetime(datestr(events_cfg_op.data(1,ia)));
tablec_183=tablec_183(:,[end,1:end-1])
</pre><pre class="codeoutput">
Brewer IZO#183: Second Config.
                |  10-Apr-2015 |  09-Jun-2015 |  27-Sep-2015 |  17-Feb-2016 |  11-Mar-2016 |  18-Mar-2016 |  13-Jul-2016 |  01-Dec-2016 |  05-Dec-2016 |  13-Feb-2017 |  06-Mar-2017 |  06-Nov-2017 |  14-Jan-2018 |  27-Feb-2018 |  01-Mar-2018 |  25-Apr-2018 |  29-Oct-2018 |  20-Apr-2019
 o3 Temp coef 1 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
 o3 Temp coef 2 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292 |       0.0292
 o3 Temp coef 3 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149 |       0.2149
 o3 Temp coef 4 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384 |        0.384
 o3 Temp coef 5 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919 |       0.4919
 O3 on O3 Ratio |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |         0.34 |         0.34 |         0.34 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341 |        0.341
ETC on O3 Ratio |         1640 |         1630 |         1630 |         1630 |         1630 |         1630 |         1630 |         1630 |         1630 |         1620 |         1620 |         1620 |         1620 |         1620 |         1555 |         1555 |         1565 |         1555
Dead time (sec) |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08 |      2.3e-08
            csn |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020 |         1020
    ND filter 0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
    ND filter 1 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350 |         4350
    ND filter 2 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250 |        10250
    ND filter 3 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100 |        14100
    ND filter 4 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500 |        21500
    ND filter 5 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800 |        25800
             R6 |          395 |          385 |          385 |          385 |          385 |          385 |          389 |          389 |          388 |          386 |          381 |          381 |          305 |          305 |          305 |          305 |          303 |          300
             R5 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550 |          550
          F#2_C |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
          F#3_C |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0
          F#4_C |           -8 |           -8 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0 |            0

c =

   1.0e+04 *

  Columns 1 through 7

         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1640
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1630
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1630
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1630
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1630
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1630
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1620
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1620
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1620
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1555
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1565
         0    0.0000    0.0000    0.0000    0.0000    0.0000    0.1555

  Columns 8 through 14

    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500
    0.0000    0.1020         0    0.4350    1.0250    1.4100    2.1500

  Columns 15 through 20

    2.5800    0.0395    0.0550         0         0   -0.0008
    2.5800    0.0385    0.0550         0         0   -0.0008
    2.5800    0.0385    0.0550         0         0         0
    2.5800    0.0385    0.0550         0         0         0
    2.5800    0.0389    0.0550         0         0         0
    2.5800    0.0388    0.0550         0         0         0
    2.5800    0.0386    0.0550         0         0         0
    2.5800    0.0381    0.0550         0         0         0
    2.5800    0.0305    0.0550         0         0         0
    2.5800    0.0305    0.0550         0         0         0
    2.5800    0.0303    0.0550         0         0         0
    2.5800    0.0300    0.0550         0         0         0


ia =

     1
     2
     3
     6
     7
     9
    10
    11
    13
    15
    17
    18


tablec_183 =

  12&times;20 table

    o3TempCoef1    o3TempCoef2    o3TempCoef3    o3TempCoef4    o3TempCoef5    O3OnO3Ratio    ETCOnO3Ratio    DeadTime_sec_    csn     NDFilter0    NDFilter1    NDFilter2    NDFilter3    NDFilter4    NDFilter5    R6     R5     F_2_C    F_3_C    F_4_C
    ___________    ___________    ___________    ___________    ___________    ___________    ____________    _____________    ____    _________    _________    _________    _________    _________    _________    ___    ___    _____    _____    _____

         0           0.0292         0.2149          0.384         0.4919          0.341           1640           2.3e-08       1020        0          4350         10250        14100        21500        25800      395    550      0        0       -8  
         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      385    550      0        0       -8  
         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      385    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919           0.34           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      385    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919           0.34           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      389    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      388    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800      386    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800      381    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800      305    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1555           2.3e-08       1020        0          4350         10250        14100        21500        25800      305    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1565           2.3e-08       1020        0          4350         10250        14100        21500        25800      303    550      0        0        0  
         0           0.0292         0.2149          0.384         0.4919          0.341           1555           2.3e-08       1020        0          4350         10250        14100        21500        25800      300    550      0        0        0  


tablec_183 =

  12&times;21 table

       Date        o3TempCoef1    o3TempCoef2    o3TempCoef3    o3TempCoef4    o3TempCoef5    O3OnO3Ratio    ETCOnO3Ratio    DeadTime_sec_    csn     NDFilter0    NDFilter1    NDFilter2    NDFilter3    NDFilter4    NDFilter5    R6     R5     F_2_C    F_3_C    F_4_C
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    _____________    ____    _________    _________    _________    _________    _________    _________    ___    ___    _____    _____    _____

    10-Apr-2015         0           0.0292         0.2149          0.384         0.4919          0.341           1640           2.3e-08       1020        0          4350         10250        14100        21500        25800      395    550      0        0       -8  
    09-Jun-2015         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      385    550      0        0       -8  
    27-Sep-2015         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      385    550      0        0        0  
    18-Mar-2016         0           0.0292         0.2149          0.384         0.4919           0.34           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      385    550      0        0        0  
    13-Jul-2016         0           0.0292         0.2149          0.384         0.4919           0.34           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      389    550      0        0        0  
    05-Dec-2016         0           0.0292         0.2149          0.384         0.4919          0.341           1630           2.3e-08       1020        0          4350         10250        14100        21500        25800      388    550      0        0        0  
    13-Feb-2017         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800      386    550      0        0        0  
    06-Mar-2017         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800      381    550      0        0        0  
    14-Jan-2018         0           0.0292         0.2149          0.384         0.4919          0.341           1620           2.3e-08       1020        0          4350         10250        14100        21500        25800      305    550      0        0        0  
    01-Mar-2018         0           0.0292         0.2149          0.384         0.4919          0.341           1555           2.3e-08       1020        0          4350         10250        14100        21500        25800      305    550      0        0        0  
    29-Oct-2018         0           0.0292         0.2149          0.384         0.4919          0.341           1565           2.3e-08       1020        0          4350         10250        14100        21500        25800      303    550      0        0        0  
    20-Apr-2019         0           0.0292         0.2149          0.384         0.4919          0.341           1555           2.3e-08       1020        0          4350         10250        14100        21500        25800      300    550      0        0        0  

</pre><h2 id="6">EVENTOS</h2><pre class="codeinput">event_info=getevents(Cal,<span class="string">'gr'</span>,<span class="string">'events'</span>);


matrix2latex_ctable(cellstr(datestr(event_info.dates)),fullfile(Cal.file_latex,[<span class="string">'table_events_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                   <span class="string">'rowlabels'</span>,event_info.labels',<span class="string">'columnlabels'</span>,{<span class="string">'DATE'</span>},<span class="keyword">...</span>
                                   <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);


event_info.labels
cellstr(datestr(event_info.dates))'

t_events=display_table(event_info.labels',{<span class="string">'events'</span>},30,<span class="string">'%f'</span>,cellstr(datestr(event_info.dates))');

<span class="comment">%%eventos importantes-&gt; SELECCIONAMOS LOS IMPORTANTES&lt;-</span>
ev=table();
ev.label=event_info.labels';
ev.dates=datetime(datestr(event_info.dates))
events_table=ev;


event_info.labels=event_info.labels;
event_info.dates=event_info.dates;


<span class="comment">% event_info.labels=event_info.labels(4:end);</span>
<span class="comment">% event_info.dates=event_info.dates(4:end);</span>
 displaytable(event_info.labels',{<span class="string">'events'</span>},30,<span class="string">'%f'</span>,cellstr(datestr(event_info.dates))');
</pre><pre class="codeoutput">
ans =

  1&times;18 cell array

  Columns 1 through 4

    {'"SL replc."'}    {'"IOS 15"'}    {'"Lab  1000W"'}    {'"Storm"'}

  Columns 5 through 7

    {' " Kipp&amp;Zonen m&#8230;'}    {'"Lab 1000W"'}    {'"SL replacement"'}

  Columns 8 through 11

    {'"Bad weather"'}    {'"183 Roof"'}    {'"183 Roof"'}    {'"Kipp &amp; Zonen"'}

  Columns 12 through 14

    {'"HV jump  1545-&#8230;'}    {'"Bad weather.HV&#8230;'}    {'"Bad weather"'}

  Columns 15 through 17

    {'"183 roof"'}    {'"SL replacement"'}    {'"Sof back to 3.&#8230;'}

  Column 18

    {'"Maintenance"'}


ans =

  1&times;18 cell array

  Columns 1 through 4

    {'10-Apr-2015'}    {'09-Jun-2015'}    {'27-Sep-2015'}    {'17-Feb-2016'}

  Columns 5 through 8

    {'11-Mar-2016'}    {'18-Mar-2016'}    {'13-Jul-2016'}    {'01-Dec-2016'}

  Columns 9 through 12

    {'05-Dec-2016'}    {'13-Feb-2017'}    {'06-Mar-2017'}    {'06-Nov-2017'}

  Columns 13 through 16

    {'14-Jan-2018'}    {'27-Feb-2018'}    {'01-Mar-2018'}    {'25-Apr-2018'}

  Columns 17 through 18

    {'29-Oct-2018'}    {'20-Apr-2019'}


ev =

  18&times;2 table

                    label                        dates   
    ______________________________________    ___________

    '"SL replc."'                             10-Apr-2015
    '"IOS 15"'                                09-Jun-2015
    '"Lab  1000W"'                            27-Sep-2015
    '"Storm"'                                 17-Feb-2016
    ' " Kipp&amp;Zonen maintenance"'              11-Mar-2016
    '"Lab 1000W"'                             18-Mar-2016
    '"SL replacement"'                        13-Jul-2016
    '"Bad weather"'                           01-Dec-2016
    '"183 Roof"'                              05-Dec-2016
    '"183 Roof"'                              13-Feb-2017
    '"Kipp &amp; Zonen"'                          06-Mar-2017
    '"HV jump  1545--&gt;1533"'                  06-Nov-2017
    '"Bad weather.HV back original value"'    14-Jan-2018
    '"Bad weather"'                           27-Feb-2018
    '"183 roof"'                              01-Mar-2018
    '"SL replacement"'                        25-Apr-2018
    '"Sof back to 3.77"'                      29-Oct-2018
    '"Maintenance"'                           20-Apr-2019

            |                         events
10-Apr-2015 |                    "SL replc." | 
09-Jun-2015 |                       "IOS 15" | 
27-Sep-2015 |                   "Lab  1000W" | 
17-Feb-2016 |                        "Storm" | 
11-Mar-2016 |      " Kipp&amp;Zonen maintenance" | 
18-Mar-2016 |                    "Lab 1000W" | 
13-Jul-2016 |               "SL replacement" | 
01-Dec-2016 |                  "Bad weather" | 
05-Dec-2016 |                     "183 Roof" | 
13-Feb-2017 |                     "183 Roof" | 
06-Mar-2017 |                 "Kipp &amp; Zonen" | 
06-Nov-2017 |         "HV jump  1545--&gt;1533" | 
14-Jan-2018 | "Bad weather.HV back original  | 
27-Feb-2018 |                  "Bad weather" | 
01-Mar-2018 |                     "183 roof" | 
25-Apr-2018 |               "SL replacement" | 
29-Oct-2018 |             "Sof back to 3.77" | 
20-Apr-2019 |                  "Maintenance" | 
</pre><h2 id="7">Historical review AVG info</h2><pre class="codeinput">close <span class="string">all</span>;
[tabla_avg,sl_data,dt_data,rs_data,ap_data ]=report_avg(Cal,<span class="string">'grp'</span>,<span class="string">'events'</span>,<span class="string">'outlier_flag'</span>,{<span class="string">'sl'</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>});

f=figure(findobj(<span class="string">'Tag'</span>,<span class="string">'SLAVG_F5'</span>));
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)
hold <span class="string">all</span>;

f=figure(findobj(<span class="string">'Tag'</span>,<span class="string">'SLAVG_R6'</span>));
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)
 set(gca,<span class="string">'YLim'</span>,median(events_cfg_op.data(17,:))+[-30,30])
hold <span class="string">all</span>;
s(1)=stairs([events_cfg_op.data(1,:) sl_data(end,1)],[events_cfg_op.data(17,:) events_cfg_op.data(17,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>
s(2)=stairs([events_cfg_chk.data(1,:) sl_data(end,1)],[events_cfg_chk.data(17,:) events_cfg_chk.data(17,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,2);
legend(s,{<span class="string">'R6 ref (Op)'</span>,<span class="string">'R6 ref (Chk)'</span>},<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);

f=figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'SLAVG_R6'</span>)));
Width=36; Height=12;
R6tag=[Cal.brw_str{Cal.n_inst},<span class="string">'_'</span>,get(f,<span class="string">'tag'</span>)];
set(f,<span class="string">'tag'</span>,R6tag)
ylim([320 400])

f=figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'DTAVG'</span>)));
hold <span class="string">on</span>
<span class="keyword">try</span>
 [a,b]=findchangepts(rmmissing(dt_data(:,5)),<span class="string">'MinThreshold'</span>, 1700,<span class="string">'MinDistance'</span>,7,<span class="string">'Statistic'</span>,<span class="string">'mean'</span>);

 vline_v(datenum(dt_data(a,1)),<span class="string">'r'</span>,cellstr(datestr(dt_data(a,1))))
<span class="keyword">catch</span>
    disp(<span class="string">'signal'</span>);
<span class="keyword">end</span>


printfiles_report(f,Cal.dir_figs,<span class="string">'Width'</span>,Width,<span class="string">'Height'</span>,Height);
</pre><pre class="codeoutput">--------- Validation OK --------------
List of arguments given default values:
               None                   
--------------------------------------
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_01.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_02.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_03.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_04.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_05.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_06.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_07.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_08.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_09.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_10.png" alt=""> <pre class="codeinput">table_avg_183=array2table(tabla_avg.data,<span class="string">'VariableNames'</span>,str2name([<span class="string">'fecha'</span>,tabla_avg.data_lbl]));
table_avg_183.Date=datetime(datestr(tabla_avg.data(:,1)));
table_avg_183.Properties.RowNames=varname(tabla_avg.events);
table_avg_183=table_avg_183(:,[end,1:end-1])
<span class="keyword">try</span>
  rows2vars(table_avg_183)
<span class="keyword">catch</span>
  disp(<span class="string">'transpose'</span>);
<span class="keyword">end</span>

input.data=table_avg_183(:,2:end); <span class="comment">%(solo los n&iuml;&iquest;&frac12;meros,quitamos las fechas()</span>
input.transposeTable = 1;
input.tableCaption = <span class="string">'Brewer #156 average table'</span>;
latex_avg = latexTable(input);
cellwrite(<span class="string">'table_avg_183.tex'</span>,latex_avg);
writetable(table_avg_183,<span class="string">'table_avg_183.xls'</span>)
</pre><pre class="codeoutput">
table_avg_183 =

  18&times;34 table

                                            Date          fecha         R6        std        R5      std_1      N     DTHigh     std_2     DTLow      std_3     N_1      HT       std_4      x_5V       std_5      SLCurrent      std_6      N_2      RS0        std_7         RS1        std_8         RS2        std_9         RS3        std_10        RS4        std_11        RS5        std_12        RS6        std_13      N_3
                                         ___________    __________    ______    _______    ______    ______    ___    ______    _______    ______    _______    ___    ______    _______    ______    _________    _________    _________    ___    _______    __________    _______    __________    _______    __________    _______    __________    _______    __________    _______    __________    _______    __________    ___

    x_SLReplc__                          10-Apr-2015    7.3606e+05    394.71     1.1606    681.86    1.9588      7    21.137    0.15294    21.218    0.28631      8    1542.9     0.9795    5.0609    0.0044538     1.8894      0.0022428      8    0.99965    0.00068007    0.99859    0.00037562    0.99909     0.0006679    0.99914    0.00067996    0.99902    0.00054715    0.99919     0.0004106    0.99985    0.00068191      8
    x_IOS15_                             09-Jun-2015    7.3612e+05    386.04     1.0966    666.55    1.7071     93    21.932    0.44981    22.052      0.974    108    1540.7     1.6098    5.0622    0.0044148     1.8762        0.05267    108    0.99926     0.0047092     0.9988     0.0078273    0.99918      0.010652    0.99852      0.012907    0.99855     0.0060275     0.9994     0.0079526    0.99916     0.0055711    108
    x_Lab1000W_                          27-Sep-2015    7.3623e+05    384.64     1.0085    665.17    1.9482    132    22.546    0.29813    21.893    0.87452    137    1541.4     2.3704    5.0616    0.0069634     1.9018        0.15743    137    0.99907     0.0031697    0.99856     0.0031801    0.99822     0.0049802    0.99829     0.0048225    0.99867     0.0042997    0.99879     0.0026488    0.99925     0.0030842    137
    x_Storm_                             17-Feb-2016    7.3638e+05    385.56    0.68493    668.67    1.2472      9    22.536    0.19496    22.243    0.56923      9    1542.9     0.9795    5.0606    0.0040196     1.8628      0.0031159     10    0.99923    0.00040277    0.99886    0.00029481    0.99894    0.00058521    0.99879    0.00020787    0.99888    0.00031895    0.99894    0.00027126    0.99961    0.00033811      9
    x_Kipp_ZonenMaintenance_             11-Mar-2016     7.364e+05    385.83    0.89753     669.5     1.118      6    22.873    0.08724    22.578    0.47587      6    1541.3    0.92348    5.0623    0.0051426     1.8664      0.0015915      6    0.99963    0.00057057    0.99915     0.0004113    0.99895    0.00034034    0.99913    0.00021344    0.99915    0.00051235      0.999    0.00040825    0.99975     0.0001893      6
    x_Lab1000W__1                        18-Mar-2016    7.3641e+05    385.66    0.73222    668.33    1.6703    109    23.001    0.25199    22.771     1.1227    111    1541.2     1.6229    5.0627    0.0047294     1.8666        0.18808    113    0.99925     0.0011423    0.99879    0.00069984    0.99909    0.00099669    0.99902    0.00059246    0.99919    0.00047282    0.99921    0.00054676    0.99963     0.0007191    111
    x_SLReplacement_                     13-Jul-2016    7.3652e+05    389.21    0.88996    675.98     1.802    121    23.232     0.2754    23.245    0.73456    126    1541.2     1.3584    5.0603    0.0040647     1.8992       0.056287    127    0.99935    0.00091657    0.99897    0.00072592    0.99893    0.00080698    0.99896    0.00076648    0.99907    0.00070796    0.99917     0.0006066    0.99969    0.00048069    126
    x_BadWeather_                        01-Dec-2016    7.3666e+05       387          0       670         0      1       NaN        NaN       NaN        NaN      0       NaN        NaN       NaN          NaN        NaN            NaN      0        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN      0
    x_183Roof_                           05-Dec-2016    7.3667e+05    389.17     1.1445    677.29    2.8215     65     22.94    0.47149    22.519    0.76213     65    1541.8     1.0553    5.0597    0.0033302     1.8903       0.010091     65    0.99956    0.00061041    0.99881    0.00058707    0.99879    0.00085545    0.99889    0.00062677    0.99899    0.00077556    0.99898    0.00099957    0.99967    0.00047255     65
    x_183Roof__1                         13-Feb-2017    7.3674e+05     387.3      1.005    672.75    1.7571     20    23.053    0.24991    22.557    0.43001     21    1541.6    0.91401    5.0606    0.0031534     1.8888       0.011202     21    0.99965    0.00039595     0.9989    0.00055676    0.99885     0.0005315    0.99895    0.00034999    0.99903    0.00038439    0.99909     0.0003536    0.99975    0.00041475     21
    x_Kipp_Zonen_                        06-Mar-2017    7.3676e+05    380.75    0.90951    664.38    1.7201    238    23.875     4.2379    23.594     1.3072    231    1541.1     1.3477    5.0619    0.0047352     1.8724       0.043321    233    0.99868      0.013637    0.99961      0.030747     0.9997      0.017324    0.99891      0.020472    0.99927     0.0092198    0.99987      0.030639      0.999      0.014186    230
    x_HVJump1545___1533_                 06-Nov-2017    7.3700e+05    379.95     1.1329    663.03      2.07     63    23.581    0.35276    23.972    0.75228     64      1532     1.7074    5.0387    0.0045651     2.3685      0.0068939     64    0.99934    0.00062208    0.99867    0.00074831     0.9987     0.0010213    0.99875      0.001019    0.99871     0.0013722    0.99916       0.00109    0.99945     0.0010446     64
    x_BadWeather_HVBackOriginalValue_    14-Jan-2018    7.3707e+05    338.69     36.817    584.88    70.183     16    23.012    0.39624    23.723    0.74332     16    1542.2     0.9484    5.0643    0.0017763      1.862        0.04536     16    0.99975     0.0018265    0.99869     0.0013402    0.99876     0.0025337    0.99919     0.0025393    0.99912     0.0016456    0.99878     0.0015569    0.99929      0.002176     16
    x_BadWeather__1                      27-Feb-2018    7.3712e+05       307          0       524         0      1       NaN        NaN       NaN        NaN      0       NaN        NaN       NaN          NaN        NaN            NaN      0        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN        NaN           NaN      0
    x_183Roof__2                         01-Mar-2018    7.3712e+05    305.66      2.668    519.06    8.2107     47    23.544     3.4409    24.199     5.1062     54    1541.3     1.5653     5.062    0.0046999     2.0262        0.18232     54     1.0043       0.03834      1.004      0.040284     1.0039      0.038803     1.0226       0.17406     1.0039      0.037221     1.0063      0.054444      1.004      0.035588     54
    x_SLReplacement__1                   25-Apr-2018    7.3718e+05    303.37     1.4797    518.78     2.356    184    22.845    0.53986    24.878      1.213    187    1541.6     1.2579    5.0634     0.003337     1.8238       0.058909    187    0.99912     0.0028648    0.99862     0.0042658    0.99872     0.0055213     0.9989     0.0051717    0.99909     0.0048255    0.99884     0.0038034    0.99946     0.0031664    187
    x_SofBackTo3_77_                     29-Oct-2018    7.3736e+05    302.82     1.3441    519.94    3.6975    163    22.307    0.50377     25.04     1.0084    166    1541.4     1.0949    5.0635    0.0032351     1.7925       0.013538    168    0.99939     0.0016892    0.99905       0.00218    0.99922     0.0026978    0.99916     0.0025113    0.99916      0.002144    0.99927      0.001805    0.99978     0.0016239    166
    x_Maintenance_                       20-Apr-2019    7.3754e+05    299.93       1.06    513.54    1.7761    117     22.31    0.52139    25.619     1.3565    120      1541     1.4059    5.0628    0.0035628     1.7603       0.019141    120    0.99922     0.0024156     0.9985     0.0039269    0.99885     0.0047169    0.99862     0.0046208    0.99886     0.0039228    0.99903     0.0033839    0.99956      0.002292    120


ans =

  34&times;19 table

    OriginalVariableNames     x_SLReplc__       x_IOS15_        x_Lab1000W_       x_Storm_       x_Kipp_ZonenMaintenance_    x_Lab1000W__1    x_SLReplacement_    x_BadWeather_     x_183Roof_      x_183Roof__1     x_Kipp_Zonen_    x_HVJump1545___1533_    x_BadWeather_HVBackOriginalValue_    x_BadWeather__1    x_183Roof__2     x_SLReplacement__1    x_SofBackTo3_77_    x_Maintenance_
    _____________________    _____________    _____________    _____________    _____________    ________________________    _____________    ________________    _____________    _____________    _____________    _____________    ____________________    _________________________________    _______________    _____________    __________________    ________________    ______________

         'Date'              [10-Apr-2015]    [09-Jun-2015]    [27-Sep-2015]    [17-Feb-2016]         [11-Mar-2016]          [18-Mar-2016]     [13-Jul-2016]      [01-Dec-2016]    [05-Dec-2016]    [13-Feb-2017]    [06-Mar-2017]       [06-Nov-2017]                  [14-Jan-2018]               [27-Feb-2018]     [01-Mar-2018]      [25-Apr-2018]        [29-Oct-2018]      [20-Apr-2019] 
         'fecha'             [     736064]    [     736124]    [     736234]    [     736377]         [     736400]          [     736407]     [     736524]      [     736665]    [     736669]    [     736739]    [     736760]       [     737005]                  [     737074]               [     737118]     [     737120]      [     737175]        [     737362]      [     737535] 
         'R6'                [   394.7143]    [   386.0430]    [   384.6439]    [   385.5556]         [   385.8333]          [   385.6606]     [   389.2066]      [        387]    [   389.1692]    [   387.3000]    [   380.7479]       [   379.9524]                  [   338.6875]               [        307]     [   305.6596]      [   303.3696]        [   302.8160]      [   299.9316] 
         'std'               [     1.1606]    [     1.0966]    [     1.0085]    [     0.6849]         [     0.8975]          [     0.7322]     [     0.8900]      [          0]    [     1.1445]    [     1.0050]    [     0.9095]       [     1.1329]                  [    36.8166]               [          0]     [     2.6680]      [     1.4797]        [     1.3441]      [     1.0600] 
         'R5'                [   681.8571]    [   666.5484]    [   665.1742]    [   668.6667]         [   669.5000]          [   668.3303]     [   675.9752]      [        670]    [   677.2923]    [   672.7500]    [   664.3824]       [   663.0317]                  [   584.8750]               [        524]     [   519.0600]      [   518.7826]        [   519.9448]      [   513.5385] 
         'std_1'             [     1.9588]    [     1.7071]    [     1.9482]    [     1.2472]         [     1.1180]          [     1.6703]     [     1.8020]      [          0]    [     2.8215]    [     1.7571]    [     1.7201]       [     2.0700]                  [    70.1827]               [          0]     [     8.2107]      [     2.3560]        [     3.6975]      [     1.7761] 
         'N'                 [          7]    [         93]    [        132]    [          9]         [          6]          [        109]     [        121]      [          1]    [         65]    [         20]    [        238]       [         63]                  [         16]               [          1]     [         47]      [        184]        [        163]      [        117] 
         'DTHigh'            [    21.1374]    [    21.9316]    [    22.5463]    [    22.5356]         [    22.8732]          [    23.0015]     [    23.2319]      [        NaN]    [    22.9396]    [    23.0526]    [    23.8748]       [    23.5810]                  [    23.0125]               [        NaN]     [    23.5436]      [    22.8447]        [    22.3068]      [    22.3096] 
         'std_2'             [     0.1529]    [     0.4498]    [     0.2981]    [     0.1950]         [     0.0872]          [     0.2520]     [     0.2754]      [        NaN]    [     0.4715]    [     0.2499]    [     4.2379]       [     0.3528]                  [     0.3962]               [        NaN]     [     3.4409]      [     0.5399]        [     0.5038]      [     0.5214] 
         'DTLow'             [    21.2181]    [    22.0521]    [    21.8933]    [    22.2430]         [    22.5777]          [    22.7714]     [    23.2447]      [        NaN]    [    22.5189]    [    22.5565]    [    23.5944]       [    23.9723]                  [    23.7229]               [        NaN]     [    24.1987]      [    24.8783]        [    25.0404]      [    25.6191] 
         'std_3'             [     0.2863]    [     0.9740]    [     0.8745]    [     0.5692]         [     0.4759]          [     1.1227]     [     0.7346]      [        NaN]    [     0.7621]    [     0.4300]    [     1.3072]       [     0.7523]                  [     0.7433]               [        NaN]     [     5.1062]      [     1.2130]        [     1.0084]      [     1.3565] 
         'N_1'               [          8]    [        108]    [        137]    [          9]         [          6]          [        111]     [        126]      [          0]    [         65]    [         21]    [        231]       [         64]                  [         16]               [          0]     [         54]      [        187]        [        166]      [        120] 
         'HT'                [ 1.5429e+03]    [ 1.5407e+03]    [ 1.5414e+03]    [ 1.5429e+03]         [ 1.5413e+03]          [ 1.5412e+03]     [ 1.5412e+03]      [        NaN]    [ 1.5418e+03]    [ 1.5416e+03]    [ 1.5411e+03]       [ 1.5320e+03]                  [ 1.5422e+03]               [        NaN]     [ 1.5413e+03]      [ 1.5416e+03]        [ 1.5414e+03]      [ 1.5410e+03] 
         'std_4'             [     0.9795]    [     1.6098]    [     2.3704]    [     0.9795]         [     0.9235]          [     1.6229]     [     1.3584]      [        NaN]    [     1.0553]    [     0.9140]    [     1.3477]       [     1.7074]                  [     0.9484]               [        NaN]     [     1.5653]      [     1.2579]        [     1.0949]      [     1.4059] 
         'x_5V'              [     5.0609]    [     5.0622]    [     5.0616]    [     5.0606]         [     5.0623]          [     5.0627]     [     5.0603]      [        NaN]    [     5.0597]    [     5.0606]    [     5.0619]       [     5.0387]                  [     5.0643]               [        NaN]     [     5.0620]      [     5.0634]        [     5.0635]      [     5.0628] 
         'std_5'             [     0.0045]    [     0.0044]    [     0.0070]    [     0.0040]         [     0.0051]          [     0.0047]     [     0.0041]      [        NaN]    [     0.0033]    [     0.0032]    [     0.0047]       [     0.0046]                  [     0.0018]               [        NaN]     [     0.0047]      [     0.0033]        [     0.0032]      [     0.0036] 
         'SLCurrent'         [     1.8894]    [     1.8762]    [     1.9018]    [     1.8628]         [     1.8664]          [     1.8666]     [     1.8992]      [        NaN]    [     1.8903]    [     1.8888]    [     1.8724]       [     2.3685]                  [     1.8620]               [        NaN]     [     2.0262]      [     1.8238]        [     1.7925]      [     1.7603] 
         'std_6'             [     0.0022]    [     0.0527]    [     0.1574]    [     0.0031]         [     0.0016]          [     0.1881]     [     0.0563]      [        NaN]    [     0.0101]    [     0.0112]    [     0.0433]       [     0.0069]                  [     0.0454]               [        NaN]     [     0.1823]      [     0.0589]        [     0.0135]      [     0.0191] 
         'N_2'               [          8]    [        108]    [        137]    [         10]         [          6]          [        113]     [        127]      [          0]    [         65]    [         21]    [        233]       [         64]                  [         16]               [          0]     [         54]      [        187]        [        168]      [        120] 
         'RS0'               [     0.9996]    [     0.9993]    [     0.9991]    [     0.9992]         [     0.9996]          [     0.9992]     [     0.9994]      [        NaN]    [     0.9996]    [     0.9996]    [     0.9987]       [     0.9993]                  [     0.9998]               [        NaN]     [     1.0043]      [     0.9991]        [     0.9994]      [     0.9992] 
         'std_7'             [ 6.8007e-04]    [     0.0047]    [     0.0032]    [ 4.0277e-04]         [ 5.7057e-04]          [     0.0011]     [ 9.1657e-04]      [        NaN]    [ 6.1041e-04]    [ 3.9595e-04]    [     0.0136]       [ 6.2208e-04]                  [     0.0018]               [        NaN]     [     0.0383]      [     0.0029]        [     0.0017]      [     0.0024] 
         'RS1'               [     0.9986]    [     0.9988]    [     0.9986]    [     0.9989]         [     0.9991]          [     0.9988]     [     0.9990]      [        NaN]    [     0.9988]    [     0.9989]    [     0.9996]       [     0.9987]                  [     0.9987]               [        NaN]     [     1.0040]      [     0.9986]        [     0.9991]      [     0.9985] 
         'std_8'             [ 3.7562e-04]    [     0.0078]    [     0.0032]    [ 2.9481e-04]         [ 4.1130e-04]          [ 6.9984e-04]     [ 7.2592e-04]      [        NaN]    [ 5.8707e-04]    [ 5.5676e-04]    [     0.0307]       [ 7.4831e-04]                  [     0.0013]               [        NaN]     [     0.0403]      [     0.0043]        [     0.0022]      [     0.0039] 
         'RS2'               [     0.9991]    [     0.9992]    [     0.9982]    [     0.9989]         [     0.9989]          [     0.9991]     [     0.9989]      [        NaN]    [     0.9988]    [     0.9988]    [     0.9997]       [     0.9987]                  [     0.9988]               [        NaN]     [     1.0039]      [     0.9987]        [     0.9992]      [     0.9988] 
         'std_9'             [ 6.6790e-04]    [     0.0107]    [     0.0050]    [ 5.8521e-04]         [ 3.4034e-04]          [ 9.9669e-04]     [ 8.0698e-04]      [        NaN]    [ 8.5545e-04]    [ 5.3150e-04]    [     0.0173]       [     0.0010]                  [     0.0025]               [        NaN]     [     0.0388]      [     0.0055]        [     0.0027]      [     0.0047] 
         'RS3'               [     0.9991]    [     0.9985]    [     0.9983]    [     0.9988]         [     0.9991]          [     0.9990]     [     0.9990]      [        NaN]    [     0.9989]    [     0.9990]    [     0.9989]       [     0.9987]                  [     0.9992]               [        NaN]     [     1.0226]      [     0.9989]        [     0.9992]      [     0.9986] 
         'std_10'            [ 6.7996e-04]    [     0.0129]    [     0.0048]    [ 2.0787e-04]         [ 2.1344e-04]          [ 5.9246e-04]     [ 7.6648e-04]      [        NaN]    [ 6.2677e-04]    [ 3.4999e-04]    [     0.0205]       [     0.0010]                  [     0.0025]               [        NaN]     [     0.1741]      [     0.0052]        [     0.0025]      [     0.0046] 
         'RS4'               [     0.9990]    [     0.9986]    [     0.9987]    [     0.9989]         [     0.9991]          [     0.9992]     [     0.9991]      [        NaN]    [     0.9990]    [     0.9990]    [     0.9993]       [     0.9987]                  [     0.9991]               [        NaN]     [     1.0039]      [     0.9991]        [     0.9992]      [     0.9989] 
         'std_11'            [ 5.4715e-04]    [     0.0060]    [     0.0043]    [ 3.1895e-04]         [ 5.1235e-04]          [ 4.7282e-04]     [ 7.0796e-04]      [        NaN]    [ 7.7556e-04]    [ 3.8439e-04]    [     0.0092]       [     0.0014]                  [     0.0016]               [        NaN]     [     0.0372]      [     0.0048]        [     0.0021]      [     0.0039] 
         'RS5'               [     0.9992]    [     0.9994]    [     0.9988]    [     0.9989]         [     0.9990]          [     0.9992]     [     0.9992]      [        NaN]    [     0.9990]    [     0.9991]    [     0.9999]       [     0.9992]                  [     0.9988]               [        NaN]     [     1.0063]      [     0.9988]        [     0.9993]      [     0.9990] 
         'std_12'            [ 4.1060e-04]    [     0.0080]    [     0.0026]    [ 2.7126e-04]         [ 4.0825e-04]          [ 5.4676e-04]     [ 6.0660e-04]      [        NaN]    [ 9.9957e-04]    [ 3.5360e-04]    [     0.0306]       [     0.0011]                  [     0.0016]               [        NaN]     [     0.0544]      [     0.0038]        [     0.0018]      [     0.0034] 
         'RS6'               [     0.9999]    [     0.9992]    [     0.9993]    [     0.9996]         [     0.9998]          [     0.9996]     [     0.9997]      [        NaN]    [     0.9997]    [     0.9998]    [     0.9990]       [     0.9994]                  [     0.9993]               [        NaN]     [     1.0040]      [     0.9995]        [     0.9998]      [     0.9996] 
         'std_13'            [ 6.8191e-04]    [     0.0056]    [     0.0031]    [ 3.3811e-04]         [ 1.8930e-04]          [ 7.1910e-04]     [ 4.8069e-04]      [        NaN]    [ 4.7255e-04]    [ 4.1475e-04]    [     0.0142]       [     0.0010]                  [     0.0022]               [        NaN]     [     0.0356]      [     0.0032]        [     0.0016]      [     0.0023] 
         'N_3'               [          8]    [        108]    [        137]    [          9]         [          6]          [        111]     [        126]      [          0]    [         65]    [         21]    [        230]       [         64]                  [         16]               [          0]     [         54]      [        187]        [        166]      [        120] 

\begin{table}                                                                                                                                                                                                                                                                                                                       
\centering                                                                                                                                                                                                                                                                                                                          
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}                                                                                                                                                                                                                                                                            
\hline                                                                                                                                                                                                                                                                                                                              
 &amp; x_SLReplc__ &amp; x_IOS15_ &amp; x_Lab1000W_ &amp; x_Storm_ &amp; x_Kipp_ZonenMaintenance_ &amp; x_Lab1000W__1 &amp; x_SLReplacement_ &amp; x_BadWeather_ &amp; x_183Roof_ &amp; x_183Roof__1 &amp; x_Kipp_Zonen_ &amp; x_HVJump1545___1533_ &amp; x_BadWeather_HVBackOriginalValue_ &amp; x_BadWeather__1 &amp; x_183Roof__2 &amp; x_SLReplacement__1 &amp; x_SofBackTo3_77_ &amp; x_Maintenance_ \\
\hline                                                                                                                                                                                                                                                                                                                              
fecha &amp; 736064.0000 &amp; 736124.0000 &amp; 736234.0000 &amp; 736377.0000 &amp; 736400.0000 &amp; 736407.0000 &amp; 736524.0000 &amp; 736665.0000 &amp; 736669.0000 &amp; 736739.0000 &amp; 736760.0000 &amp; 737005.0000 &amp; 737074.0000 &amp; 737118.0000 &amp; 737120.0000 &amp; 737175.0000 &amp; 737362.0000 &amp; 737535.0000 \\                                                                
\hline                                                                                                                                                                                                                                                                                                                              
R6 &amp; 394.7143 &amp; 386.0430 &amp; 384.6439 &amp; 385.5556 &amp; 385.8333 &amp; 385.6606 &amp; 389.2066 &amp; 387.0000 &amp; 389.1692 &amp; 387.3000 &amp; 380.7479 &amp; 379.9524 &amp; 338.6875 &amp; 307.0000 &amp; 305.6596 &amp; 303.3696 &amp; 302.8160 &amp; 299.9316 \\                                                                                                                         
\hline                                                                                                                                                                                                                                                                                                                              
std &amp; 1.1606 &amp; 1.0966 &amp; 1.0085 &amp; 0.6849 &amp; 0.8975 &amp; 0.7322 &amp; 0.8900 &amp; 0.0000 &amp; 1.1445 &amp; 1.0050 &amp; 0.9095 &amp; 1.1329 &amp; 36.8166 &amp; 0.0000 &amp; 2.6680 &amp; 1.4797 &amp; 1.3441 &amp; 1.0600 \\                                                                                                                                                           
\hline                                                                                                                                                                                                                                                                                                                              
R5 &amp; 681.8571 &amp; 666.5484 &amp; 665.1742 &amp; 668.6667 &amp; 669.5000 &amp; 668.3303 &amp; 675.9752 &amp; 670.0000 &amp; 677.2923 &amp; 672.7500 &amp; 664.3824 &amp; 663.0317 &amp; 584.8750 &amp; 524.0000 &amp; 519.0600 &amp; 518.7826 &amp; 519.9448 &amp; 513.5385 \\                                                                                                                         
\hline                                                                                                                                                                                                                                                                                                                              
std_1 &amp; 1.9588 &amp; 1.7071 &amp; 1.9482 &amp; 1.2472 &amp; 1.1180 &amp; 1.6703 &amp; 1.8020 &amp; 0.0000 &amp; 2.8215 &amp; 1.7571 &amp; 1.7201 &amp; 2.0700 &amp; 70.1827 &amp; 0.0000 &amp; 8.2107 &amp; 2.3560 &amp; 3.6975 &amp; 1.7761 \\                                                                                                                                                         
\hline                                                                                                                                                                                                                                                                                                                              
N &amp; 7.0000 &amp; 93.0000 &amp; 132.0000 &amp; 9.0000 &amp; 6.0000 &amp; 109.0000 &amp; 121.0000 &amp; 1.0000 &amp; 65.0000 &amp; 20.0000 &amp; 238.0000 &amp; 63.0000 &amp; 16.0000 &amp; 1.0000 &amp; 47.0000 &amp; 184.0000 &amp; 163.0000 &amp; 117.0000 \\                                                                                                                                          
\hline                                                                                                                                                                                                                                                                                                                              
DTHigh &amp; 21.1374 &amp; 21.9316 &amp; 22.5463 &amp; 22.5356 &amp; 22.8732 &amp; 23.0015 &amp; 23.2319 &amp; - &amp; 22.9396 &amp; 23.0526 &amp; 23.8748 &amp; 23.5810 &amp; 23.0125 &amp; - &amp; 23.5436 &amp; 22.8447 &amp; 22.3068 &amp; 22.3096 \\                                                                                                                                                   
\hline                                                                                                                                                                                                                                                                                                                              
std_2 &amp; 0.1529 &amp; 0.4498 &amp; 0.2981 &amp; 0.1950 &amp; 0.0872 &amp; 0.2520 &amp; 0.2754 &amp; - &amp; 0.4715 &amp; 0.2499 &amp; 4.2379 &amp; 0.3528 &amp; 0.3962 &amp; - &amp; 3.4409 &amp; 0.5399 &amp; 0.5038 &amp; 0.5214 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
DTLow &amp; 21.2181 &amp; 22.0521 &amp; 21.8933 &amp; 22.2430 &amp; 22.5777 &amp; 22.7714 &amp; 23.2447 &amp; - &amp; 22.5189 &amp; 22.5565 &amp; 23.5944 &amp; 23.9723 &amp; 23.7229 &amp; - &amp; 24.1987 &amp; 24.8783 &amp; 25.0404 &amp; 25.6191 \\                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
std_3 &amp; 0.2863 &amp; 0.9740 &amp; 0.8745 &amp; 0.5692 &amp; 0.4759 &amp; 1.1227 &amp; 0.7346 &amp; - &amp; 0.7621 &amp; 0.4300 &amp; 1.3072 &amp; 0.7523 &amp; 0.7433 &amp; - &amp; 5.1062 &amp; 1.2130 &amp; 1.0084 &amp; 1.3565 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
N_1 &amp; 8.0000 &amp; 108.0000 &amp; 137.0000 &amp; 9.0000 &amp; 6.0000 &amp; 111.0000 &amp; 126.0000 &amp; 0.0000 &amp; 65.0000 &amp; 21.0000 &amp; 231.0000 &amp; 64.0000 &amp; 16.0000 &amp; 0.0000 &amp; 54.0000 &amp; 187.0000 &amp; 166.0000 &amp; 120.0000 \\                                                                                                                                       
\hline                                                                                                                                                                                                                                                                                                                              
HT &amp; 1542.8925 &amp; 1540.6613 &amp; 1541.3982 &amp; 1542.8925 &amp; 1541.2600 &amp; 1541.2368 &amp; 1541.2188 &amp; - &amp; 1541.8226 &amp; 1541.6331 &amp; 1541.1142 &amp; 1531.9640 &amp; 1542.1579 &amp; - &amp; 1541.3206 &amp; 1541.6300 &amp; 1541.4466 &amp; 1541.0151 \\                                                                                                                       
\hline                                                                                                                                                                                                                                                                                                                              
std_4 &amp; 0.9795 &amp; 1.6098 &amp; 2.3704 &amp; 0.9795 &amp; 0.9235 &amp; 1.6229 &amp; 1.3584 &amp; - &amp; 1.0553 &amp; 0.9140 &amp; 1.3477 &amp; 1.7074 &amp; 0.9484 &amp; - &amp; 1.5653 &amp; 1.2579 &amp; 1.0949 &amp; 1.4059 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
x_5V &amp; 5.0609 &amp; 5.0622 &amp; 5.0616 &amp; 5.0606 &amp; 5.0623 &amp; 5.0627 &amp; 5.0603 &amp; - &amp; 5.0597 &amp; 5.0606 &amp; 5.0619 &amp; 5.0387 &amp; 5.0643 &amp; - &amp; 5.0620 &amp; 5.0634 &amp; 5.0635 &amp; 5.0628 \\                                                                                                                                                                     
\hline                                                                                                                                                                                                                                                                                                                              
std_5 &amp; 0.0045 &amp; 0.0044 &amp; 0.0070 &amp; 0.0040 &amp; 0.0051 &amp; 0.0047 &amp; 0.0041 &amp; - &amp; 0.0033 &amp; 0.0032 &amp; 0.0047 &amp; 0.0046 &amp; 0.0018 &amp; - &amp; 0.0047 &amp; 0.0033 &amp; 0.0032 &amp; 0.0036 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
SLCurrent &amp; 1.8894 &amp; 1.8762 &amp; 1.9018 &amp; 1.8628 &amp; 1.8664 &amp; 1.8666 &amp; 1.8992 &amp; - &amp; 1.8903 &amp; 1.8888 &amp; 1.8724 &amp; 2.3685 &amp; 1.8620 &amp; - &amp; 2.0262 &amp; 1.8238 &amp; 1.7925 &amp; 1.7603 \\                                                                                                                                                                
\hline                                                                                                                                                                                                                                                                                                                              
std_6 &amp; 0.0022 &amp; 0.0527 &amp; 0.1574 &amp; 0.0031 &amp; 0.0016 &amp; 0.1881 &amp; 0.0563 &amp; - &amp; 0.0101 &amp; 0.0112 &amp; 0.0433 &amp; 0.0069 &amp; 0.0454 &amp; - &amp; 0.1823 &amp; 0.0589 &amp; 0.0135 &amp; 0.0191 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
N_2 &amp; 8.0000 &amp; 108.0000 &amp; 137.0000 &amp; 10.0000 &amp; 6.0000 &amp; 113.0000 &amp; 127.0000 &amp; 0.0000 &amp; 65.0000 &amp; 21.0000 &amp; 233.0000 &amp; 64.0000 &amp; 16.0000 &amp; 0.0000 &amp; 54.0000 &amp; 187.0000 &amp; 168.0000 &amp; 120.0000 \\                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
RS0 &amp; 0.9996 &amp; 0.9993 &amp; 0.9991 &amp; 0.9992 &amp; 0.9996 &amp; 0.9992 &amp; 0.9994 &amp; - &amp; 0.9996 &amp; 0.9996 &amp; 0.9987 &amp; 0.9993 &amp; 0.9998 &amp; - &amp; 1.0043 &amp; 0.9991 &amp; 0.9994 &amp; 0.9992 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_7 &amp; 0.0007 &amp; 0.0047 &amp; 0.0032 &amp; 0.0004 &amp; 0.0006 &amp; 0.0011 &amp; 0.0009 &amp; - &amp; 0.0006 &amp; 0.0004 &amp; 0.0136 &amp; 0.0006 &amp; 0.0018 &amp; - &amp; 0.0383 &amp; 0.0029 &amp; 0.0017 &amp; 0.0024 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
RS1 &amp; 0.9986 &amp; 0.9988 &amp; 0.9986 &amp; 0.9989 &amp; 0.9991 &amp; 0.9988 &amp; 0.9990 &amp; - &amp; 0.9988 &amp; 0.9989 &amp; 0.9996 &amp; 0.9987 &amp; 0.9987 &amp; - &amp; 1.0040 &amp; 0.9986 &amp; 0.9991 &amp; 0.9985 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_8 &amp; 0.0004 &amp; 0.0078 &amp; 0.0032 &amp; 0.0003 &amp; 0.0004 &amp; 0.0007 &amp; 0.0007 &amp; - &amp; 0.0006 &amp; 0.0006 &amp; 0.0307 &amp; 0.0007 &amp; 0.0013 &amp; - &amp; 0.0403 &amp; 0.0043 &amp; 0.0022 &amp; 0.0039 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
RS2 &amp; 0.9991 &amp; 0.9992 &amp; 0.9982 &amp; 0.9989 &amp; 0.9989 &amp; 0.9991 &amp; 0.9989 &amp; - &amp; 0.9988 &amp; 0.9988 &amp; 0.9997 &amp; 0.9987 &amp; 0.9988 &amp; - &amp; 1.0039 &amp; 0.9987 &amp; 0.9992 &amp; 0.9988 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_9 &amp; 0.0007 &amp; 0.0107 &amp; 0.0050 &amp; 0.0006 &amp; 0.0003 &amp; 0.0010 &amp; 0.0008 &amp; - &amp; 0.0009 &amp; 0.0005 &amp; 0.0173 &amp; 0.0010 &amp; 0.0025 &amp; - &amp; 0.0388 &amp; 0.0055 &amp; 0.0027 &amp; 0.0047 \\                                                                                                                                                                    
\hline                                                                                                                                                                                                                                                                                                                              
RS3 &amp; 0.9991 &amp; 0.9985 &amp; 0.9983 &amp; 0.9988 &amp; 0.9991 &amp; 0.9990 &amp; 0.9990 &amp; - &amp; 0.9989 &amp; 0.9990 &amp; 0.9989 &amp; 0.9987 &amp; 0.9992 &amp; - &amp; 1.0226 &amp; 0.9989 &amp; 0.9992 &amp; 0.9986 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_10 &amp; 0.0007 &amp; 0.0129 &amp; 0.0048 &amp; 0.0002 &amp; 0.0002 &amp; 0.0006 &amp; 0.0008 &amp; - &amp; 0.0006 &amp; 0.0003 &amp; 0.0205 &amp; 0.0010 &amp; 0.0025 &amp; - &amp; 0.1741 &amp; 0.0052 &amp; 0.0025 &amp; 0.0046 \\                                                                                                                                                                   
\hline                                                                                                                                                                                                                                                                                                                              
RS4 &amp; 0.9990 &amp; 0.9986 &amp; 0.9987 &amp; 0.9989 &amp; 0.9991 &amp; 0.9992 &amp; 0.9991 &amp; - &amp; 0.9990 &amp; 0.9990 &amp; 0.9993 &amp; 0.9987 &amp; 0.9991 &amp; - &amp; 1.0039 &amp; 0.9991 &amp; 0.9992 &amp; 0.9989 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_11 &amp; 0.0005 &amp; 0.0060 &amp; 0.0043 &amp; 0.0003 &amp; 0.0005 &amp; 0.0005 &amp; 0.0007 &amp; - &amp; 0.0008 &amp; 0.0004 &amp; 0.0092 &amp; 0.0014 &amp; 0.0016 &amp; - &amp; 0.0372 &amp; 0.0048 &amp; 0.0021 &amp; 0.0039 \\                                                                                                                                                                   
\hline                                                                                                                                                                                                                                                                                                                              
RS5 &amp; 0.9992 &amp; 0.9994 &amp; 0.9988 &amp; 0.9989 &amp; 0.9990 &amp; 0.9992 &amp; 0.9992 &amp; - &amp; 0.9990 &amp; 0.9991 &amp; 0.9999 &amp; 0.9992 &amp; 0.9988 &amp; - &amp; 1.0063 &amp; 0.9988 &amp; 0.9993 &amp; 0.9990 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_12 &amp; 0.0004 &amp; 0.0080 &amp; 0.0026 &amp; 0.0003 &amp; 0.0004 &amp; 0.0005 &amp; 0.0006 &amp; - &amp; 0.0010 &amp; 0.0004 &amp; 0.0306 &amp; 0.0011 &amp; 0.0016 &amp; - &amp; 0.0544 &amp; 0.0038 &amp; 0.0018 &amp; 0.0034 \\                                                                                                                                                                   
\hline                                                                                                                                                                                                                                                                                                                              
RS6 &amp; 0.9999 &amp; 0.9992 &amp; 0.9993 &amp; 0.9996 &amp; 0.9998 &amp; 0.9996 &amp; 0.9997 &amp; - &amp; 0.9997 &amp; 0.9998 &amp; 0.9990 &amp; 0.9994 &amp; 0.9993 &amp; - &amp; 1.0040 &amp; 0.9995 &amp; 0.9998 &amp; 0.9996 \\                                                                                                                                                                      
\hline                                                                                                                                                                                                                                                                                                                              
std_13 &amp; 0.0007 &amp; 0.0056 &amp; 0.0031 &amp; 0.0003 &amp; 0.0002 &amp; 0.0007 &amp; 0.0005 &amp; - &amp; 0.0005 &amp; 0.0004 &amp; 0.0142 &amp; 0.0010 &amp; 0.0022 &amp; - &amp; 0.0356 &amp; 0.0032 &amp; 0.0016 &amp; 0.0023 \\                                                                                                                                                                   
\hline                                                                                                                                                                                                                                                                                                                              
N_3 &amp; 8.0000 &amp; 108.0000 &amp; 137.0000 &amp; 9.0000 &amp; 6.0000 &amp; 111.0000 &amp; 126.0000 &amp; 0.0000 &amp; 65.0000 &amp; 21.0000 &amp; 230.0000 &amp; 64.0000 &amp; 16.0000 &amp; 0.0000 &amp; 54.0000 &amp; 187.0000 &amp; 166.0000 &amp; 120.0000 \\                                                                                                                                       
\hline                                                                                                                                                                                                                                                                                                                              
\end{tabular}                                                                                                                                                                                                                                                                                                                       
\caption{Brewer #156 average table}                                                                                                                                                                                                                                                                                                 
\label{table:MyTableLabel}                                                                                                                                                                                                                                                                                                          
\end{table}                                                                                                                                                                                                                                                                                                                         
</pre><pre class="codeinput"> figure(findobj(<span class="string">'Tag'</span>,<span class="string">'SLAVG_F5'</span>));
 vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_11.png" alt=""> <pre class="codeinput">figure(findobj(<span class="string">'-regexp'</span>,<span class="string">'Tag'</span>,R6tag));
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)

<span class="keyword">try</span>
 [a,b]=findchangepts(rmmissing(sl_data(:,12)),<span class="string">'MinThreshold'</span>, 50,<span class="string">'MinDistance'</span>,7,<span class="string">'Statistic'</span>,<span class="string">'mean'</span>)
 vline_v(datenum(sl_data(a,1)),<span class="string">'r'</span>,cellstr(datestr(sl_data(a,1))))
<span class="keyword">catch</span>
    disp(<span class="string">'need signal'</span>);
<span class="keyword">end</span>
</pre><pre class="codeoutput">
a =

           8
         118
         230
         357
         543
         564
         872
         920
         929
        1005
        1256
        1303


b =

   1.5088e+03

</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_12.png" alt=""> <pre class="codeinput">  figure
  plot(ap_data(:,1),ap_data(:,6),<span class="string">'x'</span>)
  vline_v(event_info.dates,<span class="string">'r'</span>,event_info.labels)
  datetick(<span class="string">'x'</span>,<span class="string">'yy/mmm'</span>)
  ylabel(<span class="string">'Amps'</span>);
  title(<span class="string">'SL lamp Intesity'</span>);
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_13.png" alt=""> <h2 id="12">DT</h2><pre class="codeinput">figure
mdt=meanmonth(dt_data,12);
hold <span class="string">on</span>
shadedErrorBar(mdt.media(:,1),mdt.media(:,8),mdt.sigma(:,8),<span class="string">'r'</span>,1)
shadedErrorBar(mdt.media(:,1),mdt.media(:,7),mdt.sigma(:,7),<span class="string">'b'</span>,1)
datetick(<span class="string">'x'</span>,12,<span class="string">'Keeplimits'</span>,<span class="string">'Keepticks'</span>);
gx=get(gca,<span class="string">'XLim'</span>);
hold <span class="string">all</span>;

<span class="comment">%DT table</span>

  dt_op=[[events_cfg_op.data(1,:) dt_data(end,1)];1E9*[events_cfg_op.data(9,:) events_cfg_op.data(9,end)]]';
  dt_alt=[[events_cfg_chk.data(1,:) dt_data(end,1)];1E9*[events_cfg_chk.data(9,:) events_cfg_chk.data(9,end)]]';


s(1)=stairs([events_cfg_op.data(1,:) dt_data(end,1)],1E9*[events_cfg_op.data(9,:) events_cfg_op.data(9,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>
s(2)=stairs([events_cfg_chk.data(1,:) dt_data(end,1)],1E9*[events_cfg_chk.data(9,:) events_cfg_chk.data(9,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,2);
legend(s,{<span class="string">'DT ref (Op)'</span>,<span class="string">'DT ref (Chk)'</span>},<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);

set(gcf,<span class="string">'Tag'</span>,<span class="string">'DT_AVG'</span>);
title([<span class="string">'DT  Brewer#'</span>, Cal.brw_str{Cal.n_inst}]);
legend(s,{<span class="string">'DT ref (Op)'</span>,<span class="string">'DT ref (Chk)'</span>},<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);
box <span class="string">on</span>
ylabel(<span class="string">'DT ns'</span>);
set(gca,<span class="string">'Xlim'</span>,gx)
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_14.png" alt=""> <pre class="codeinput">figure(maxf(findobj(<span class="string">'Tag'</span>,<span class="string">'DTAVG'</span>)));
hold <span class="string">all</span>;
s=[];
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)
s(1)=stairs(tabla_avg.data(:,1),tabla_avg.data(:,7),<span class="string">'linewidth'</span>,4);
s(2)=stairs(tabla_avg.data(:,1),tabla_avg.data(:,9),<span class="string">'linewidth'</span>,4);
s(3)=stairs([events_cfg_op.data(1,:) sl_data(end,1)],1E9*[events_cfg_op.data(9,:) events_cfg_op.data(9,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
s(4)=stairs([events_cfg_chk.data(1,:) sl_data(end,1)],1E9*([events_cfg_chk.data(9,:) events_cfg_chk.data(9,end)]),<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,2);
legend(s,{<span class="string">'DT high'</span>,<span class="string">'Dt low'</span>,<span class="string">'DT ref (Op)'</span>,<span class="string">'DT ref (Chk)'</span>},<span class="string">'Location'</span>,<span class="string">'NorthEast'</span>);
<span class="comment">%set(gca,'Ylim',[25,35])</span>
f=figure(maxf(findobj(<span class="string">'tag'</span>,<span class="string">'DTAVG'</span>)));
Width=15; Height=20;
set(f,<span class="string">'tag'</span>,[Cal.brw_str{Cal.n_inst},<span class="string">'_'</span>,get(f,<span class="string">'tag'</span>)])
printfiles_report(f,Cal.dir_figs,<span class="string">'Width'</span>,Width,<span class="string">'Height'</span>,Height);
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_15.png" alt=""> <h2 id="15">Command-Print</h2><pre class="codeinput">fprintf(<span class="string">'\r\nAVG data\r\n'</span>);
<span class="comment">% if size(tabla_avg.data,1)&lt;15</span>
<span class="comment">%    displaytable(tabla_avg.data(:,2:end)',tabla_avg.events,15,'.4f',tabla_avg.data_lbl);</span>
<span class="comment">% else</span>
<span class="comment">%    displaytable(tabla_avg.data(:,2:end),tabla_avg.data_lbl,7,'.4f',tabla_avg.events);</span>
<span class="comment">% end</span>
avg_t=display_table(tabla_avg.data(:,2:end)',tabla_avg.events,15,<span class="string">'.4f'</span>,tabla_avg.data_lbl);
writetable(avg_t,<span class="string">'avg_ev_2019_183.txt'</span>);
matrix2latex_ctable(tabla_avg.data(:,2:end)',fullfile(Cal.file_latex,[<span class="string">'table_avg_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                   <span class="string">'rowlabels'</span>,tabla_avg.data_lbl,<span class="string">'columnlabels'</span>,tabla_avg.events,<span class="keyword">...</span>
                                   <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);


 avg_t=array2table(tabla_avg.data(:,1:end)',<span class="string">'RowNames'</span>,[<span class="string">'Date'</span>,str2name(tabla_avg.data_lbl)],<span class="string">'VariableNames'</span>,varname(cellstr(datestr(tabla_avg.data(:,1)))))  ;
 <span class="comment">%avg_t.Fecha=datetime(datestr(avg_t.Date));</span>
 <span class="comment">%avg_t=[avg_t,tabla_avg.events];</span>

<span class="comment">%input.data =avg_t(:,2:11);</span>
<span class="comment">% lx=latexTable(input);</span>
<span class="comment">% lx=strrep(lx,'_',' ');</span>
<span class="comment">% lx=strrep(lx,'x ',' ');</span>
<span class="comment">% fid=fopen('sl_avg_183.tex','w');</span>
<span class="comment">% [nrows,ncols] = size(lx);</span>
<span class="comment">% for row = 1:nrows</span>
<span class="comment">%     fprintf(fid,'%s\n',lx{row,:});</span>
<span class="comment">% end</span>
<span class="comment">% fclose(fid);</span>

<span class="comment">%avg_t.Date=datetime(datestr(tabla_avg.data(:,1)))</span>
</pre><pre class="codeoutput">
AVG data
</pre><h2 id="16">Temperature dependence</h2><pre class="codeinput">close <span class="string">all</span>;

t.dates=[datenum(2015,6,1),datenum(2017,12,10),datenum(2018,05,12)];
t.labels=[{<span class="string">'start'</span>,<span class="string">'hv'</span>,<span class="string">'SL chg'</span>}];
<span class="comment">%t.dates=[datenum(2019,1,1)];</span>
<span class="comment">%t.labels=[{'2019'}];</span>
<span class="comment">%  Hay que mirar si hay cambios en la intensidad de la lampara -&gt;</span>
<span class="comment">%</span>

[tabla_tc,sl_raw_183]=report_temperature(Cal,OP_config,OP_config,<span class="string">'grp_custom'</span>,t,<span class="string">'reprocess'</span>,0);
<span class="comment">%[tabla_tc,sl_raw_183]=report_temperature(Cal,OP_config,ALT_config,'grp','events','reprocess',0)</span>
</pre><pre class="codeoutput">--------- Validation OK --------------
List of arguments given default values:
   'plot_flag'    defaults to 0
   'intensity_flag'    defaults to 0
   'TCB'    defaults to []
--------------------------------------
--------- Validation OK --------------
List of arguments given default values:
   'plot_flag'    defaults to 0
   'intensity_flag'    defaults to 0
   'TCB'    defaults to []
   'N_TC'    defaults to []
--------------------------------------
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_16.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_17.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_18.png" alt=""> <pre class="codeoutput">--------- Validation OK --------------
List of arguments given default values:
   'plot_flag'    defaults to 0
   'intensity_flag'    defaults to 0
   'TCB'    defaults to []
--------------------------------------
--------- Validation OK --------------
List of arguments given default values:
   'plot_flag'    defaults to 0
   'intensity_flag'    defaults to 0
   'TCB'    defaults to []
   'N_TC'    defaults to []
--------------------------------------
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_19.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_20.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_21.png" alt=""> <pre class="codeoutput">--------- Validation OK --------------
List of arguments given default values:
   'plot_flag'    defaults to 0
   'intensity_flag'    defaults to 0
   'TCB'    defaults to []
--------------------------------------
--------- Validation OK --------------
List of arguments given default values:
   'plot_flag'    defaults to 0
   'intensity_flag'    defaults to 0
   'TCB'    defaults to []
   'N_TC'    defaults to []
--------------------------------------
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_22.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_23.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_24.png" alt=""> <h2 id="17">Global temperature</h2><pre class="codeinput">sl=cat(1,tabla_tc.sl{:});
sl_m=grpstats(sl(:,[1,end]),{year(sl(:,1)),month(sl(:,1))});


f=figure;
set(f,<span class="string">'Tag'</span>,<span class="string">'SL_R6'</span>);
plot(sl(:,1),sl(:,end),<span class="string">'.'</span>);hold <span class="string">all</span>
plot(sl_m(:,1), sl_m(:,2),<span class="string">'lineWidth'</span>,4)


datetick(<span class="string">'keeplimits'</span>);
sx=get(gca,<span class="string">'XLim'</span>);
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)
<span class="comment">% set(gca,'YLim',median(events_cfg_op.data(17,:))+[-30,30])</span>
s(1)=stairs([events_cfg_op.data(1,:) sl_data(end,1)],[events_cfg_op.data(17,:) events_cfg_op.data(17,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
hold <span class="string">on</span>
s(2)=stairs([events_cfg_chk.data(1,:) sl_data(end,1)],[events_cfg_chk.data(17,:) events_cfg_chk.data(17,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>,2);
set(gca,<span class="string">'XLim'</span>,sx);
legend(s,{<span class="string">'obs'</span>,<span class="string">'mean'</span>,<span class="string">'R6 ref (Op)'</span>,<span class="string">'R6 ref (Chk)'</span>});
Width=24; Height=12;
set(f,<span class="string">'tag'</span>,[Cal.brw_str{Cal.n_inst},<span class="string">'_'</span>,get(f,<span class="string">'tag'</span>)])
set(gca,<span class="string">'XLim'</span>,sx);
printfiles_report(f,Cal.dir_figs,<span class="string">'Width'</span>,Width,<span class="string">'Height'</span>,Height,<span class="string">'no_export'</span>);
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_25.png" alt=""> <pre class="codeinput"><span class="comment">%tabla_tc_183=display_table(tabla_tc.data(:,2:end)',tabla_tc.events,12,'.2f',tabla_tc.data_lbl)</span>

<span class="comment">%[tabla_tc,sl_raw_183]=report_temperature(Cal,OP_config,ALT_config,'grp','events');</span>
<span class="comment">% Command-Print</span>
<span class="comment">%  fprintf('\r\nTemp. Dependence\r\n');</span>
<span class="comment">%  if size(tabla_tc.data,1)&lt;9</span>
<span class="comment">%     displaytable(tabla_tc.data(:,2:end)',tabla_tc.events,12,'.2f',tabla_tc.data_lbl);</span>
<span class="comment">%  else</span>
<span class="comment">%     displaytable(tabla_tc.data(:,2:end),tabla_tc.data_lbl,8,'.2f',tabla_tc.events);</span>
<span class="comment">%  end</span>
 matrix2latex_ctable(tabla_tc.data(:,2:end)',fullfile(Cal.file_latex,[<span class="string">'table_tc_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                    <span class="string">'rowlabels'</span>,tabla_tc.data_lbl,<span class="string">'columnlabels'</span>,tabla_tc.events,<span class="keyword">...</span>
                                    <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);

ix=sort(findobj(<span class="string">'-regexp'</span>,<span class="string">'Tag'</span>,<span class="string">'TEMP_COMP\w+'</span>));
arrayfun( @(x) set(x,<span class="string">'tag'</span>,[Cal.brw_str{Cal.n_inst},<span class="string">'_'</span>,get(x,<span class="string">'tag'</span>)]),ix)

printfiles_report(ix',Cal.dir_figs,<span class="string">'Width'</span>,Width,<span class="string">'Height'</span>,Height);
close <span class="string">all</span>

nanmean(tabla_tc.sl{1})
nanmean(tabla_tc.sl_r{1})

<span class="comment">% SL reference 371</span>
</pre><pre class="codeoutput">
ans =

   1.0e+05 *

  Columns 1 through 7

    7.3669    0.0002    0.6037    0.6117    0.6218    0.6275    0.6328

  Columns 8 through 9

    0.0067    0.0039


ans =

   1.0e+05 *

  Columns 1 through 7

    7.3669    0.0002    0.6037    0.6117    0.6218    0.6275    0.6328

  Columns 8 through 9

    0.0068    0.0039

</pre><h2 id="19">dark evaluation</h2><pre class="codeinput">figure
ploty(sl_raw_183(:,[4,12]),<span class="string">'+'</span>)
title(<span class="string">'Dark Count (SL) 183'</span>)
xlabel(<span class="string">'Temperature'</span>)
grid
</pre><pre class="codeoutput">
ans = 

  Line with properties:

              Color: [0 0.4470 0.7410]
          LineStyle: 'none'
          LineWidth: 0.5000
             Marker: '+'
         MarkerSize: 6
    MarkerFaceColor: 'none'
              XData: [1&times;61206 double]
              YData: [1&times;61206 double]
              ZData: [1&times;0 double]

  Use GET to show all properties

</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_26.png" alt=""> <h2 id="20">DARK</h2><pre class="codeinput">figure
gscatter(sl_raw_183(:,1),sl_raw_183(:,12),fix(sl_raw_183(:,4)/2.5)*2.5)
datetick
set(gca,<span class="string">'Ylim'</span>,[0,60])
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels)
title(<span class="string">'Dark Count (SL) 183'</span>)
grid
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_27.png" alt=""> <pre class="codeinput">figure
hx=gscatter(sl_raw_183(:,4),sl_raw_183(:,12),datestr(fix(sl_raw_183(:,1)/30)*30,<span class="string">'yymm'</span>))
set(gca,<span class="string">'Ylim'</span>,[000,60])
title(<span class="string">'Dark Count (SL) #183'</span>)
grid
xlabel(<span class="string">'Temperature'</span>)
<span class="comment">% set(findobj(hx,'DisplayName','1701'),'Marker','x')</span>
<span class="comment">% set(findobj(hx,'DisplayName','1601'),'Marker','x')</span>
</pre><pre class="codeoutput">
hx = 

  45&times;1 Line array:

  Line    (1512)
  Line    (1601)
  Line    (1602)
  Line    (1603)
  Line    (1604)
  Line    (1605)
  Line    (1606)
  Line    (1607)
  Line    (1608)
  Line    (1609)
  Line    (1610)
  Line    (1611)
  Line    (1612)
  Line    (1701)
  Line    (1702)
  Line    (1703)
  Line    (1704)
  Line    (1705)
  Line    (1706)
  Line    (1707)
  Line    (1708)
  Line    (1709)
  Line    (1710)
  Line    (1711)
  Line    (1712)
  Line    (1801)
  Line    (1802)
  Line    (1803)
  Line    (1804)
  Line    (1805)
  Line    (1806)
  Line    (1807)
  Line    (1808)
  Line    (1809)
  Line    (1810)
  Line    (1811)
  Line    (1812)
  Line    (1901)
  Line    (1902)
  Line    (1903)
  Line    (1904)
  Line    (1905)
  Line    (1906)
  Line    (1907)
  Line    (1908)

</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_28.png" alt=""> <h2 id="22">Filter attenuation</h2><pre class="codeinput"><span class="comment">% para evauar por periodos, por ejemplos cuando se cambia un filtro</span>
close <span class="string">all</span>;

t.dates=[datenum(2010,6,1),datenum(2018,6,1),datenum(2019,4,12)];
t.labels=[{<span class="string">'historic'</span>,<span class="string">'last year'</span>,<span class="string">'now'</span>}];

tabla_fi=report_filter(Cal,<span class="string">'grp_custom'</span>,t,<span class="string">'date_range'</span>,t.dates);


<span class="comment">% Command-Print</span>
<span class="comment">% fprintf('\r\nFI Analysis\r\n');</span>
<span class="comment">%  if size(tabla_fi.data,1)&lt;11</span>
<span class="comment">%     displaytable(tabla_fi.data(:,2:end)',tabla_fi.events,12,'.2f',tabla_fi.data_lbl);</span>
<span class="comment">%  else</span>
<span class="comment">%     displaytable(tabla_fi.data(:,2:end),tabla_fi.data_lbl,10,'.2f',tabla_fi.events);</span>
<span class="comment">%  end</span>
 displaytable(tabla_fi.data(:,2:end),tabla_fi.data_lbl,10,<span class="string">'.2f'</span>,tabla_fi.events);
 matrix2latex_ctable(tabla_fi.data(:,2:end)',fullfile(Cal.file_latex,[<span class="string">'table_fi_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                     <span class="string">'rowlabels'</span>,str2latex(tabla_fi.data_lbl),<span class="string">'columnlabels'</span>,str2latex(tabla_fi.events),<span class="keyword">...</span>
                                     <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);
</pre><pre class="codeoutput">--------- Validation OK --------------
List of arguments given default values:
               None                   
--------------------------------------
          |   F#1 corr |         se |   F#2 corr |         se |   F#3 corr |         se |   F#4 corr |         se |   F#5 corr |         se |          N
 historic |      -0.95 |       0.36 |      -5.42 |       0.38 |      -5.20 |       0.37 |      -3.43 |       0.52 |      -8.07 |       0.86 |    1620.00
last year |      -1.94 |       1.28 |      -5.62 |       1.30 |      -4.73 |       1.20 |      -2.28 |       1.48 |      -8.22 |       3.40 |     156.00
      now |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_29.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_30.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_31.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_32.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_33.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_34.png" alt=""> <h2 id="23">SC's</h2><pre class="codeinput">close <span class="string">all</span>;

Cal.Date.CALC_DAYS=datenum(2015,6,1):now;
tabla_sc=report_sc(Cal,OP_config,<span class="string">'grp'</span>,<span class="string">'events'</span>);
tabla_sc_183=display_table(tabla_sc.data(:,2:end),tabla_sc.data_lbl,15,<span class="string">'.0f'</span>,tabla_sc.events)
writetable(tabla_sc_183,<span class="string">'SC_summary_2019_183.txt'</span>)
writetable(tabla_sc_183,<span class="string">'SC_summary_2019_183.xls'</span>)

<span class="comment">% Command-Print</span>
<span class="comment">% fprintf('\r\nSC Analysis\r\n');</span>
<span class="comment">% if size(tabla_sc.data,1)&lt;10</span>
<span class="comment">%    displaytable(tabla_sc.data(:,2:end)',tabla_sc.events,15,'.0f',tabla_sc.data_lbl);</span>
<span class="comment">% else</span>
<span class="comment">%    displaytable(tabla_sc.data(:,2:end),tabla_sc.data_lbl,15,'.0f',tabla_sc.events);</span>
<span class="comment">% end</span>
 matrix2latex_ctable(tabla_sc.data(:,2:end)',fullfile(Cal.file_latex,[<span class="string">'table_sc_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                     <span class="string">'rowlabels'</span>,str2latex(tabla_sc.data_lbl),<span class="string">'columnlabels'</span>,str2latex(tabla_sc.events),<span class="keyword">...</span>
                                     <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);


figure; set(gcf,<span class="string">'Tag'</span>,strcat(<span class="string">'SC_CSN_hist'</span>,Cal.brw_str{Cal.n_inst}));
patch([min(tabla_sc.data(:,1))-10 max(tabla_sc.data(:,1))+10 max(tabla_sc.data(:,1))+10 min(tabla_sc.data(:,1))-10],<span class="keyword">...</span>
      [repmat(1025,1,2) repmat(1027,1,2)], <span class="keyword">...</span>
      [.953,.953,.953],<span class="string">'LineStyle'</span>,<span class="string">':'</span>); hold <span class="string">on</span>;
errorbar(tabla_sc.data(:,1),tabla_sc.data(:,2),matadd(tabla_sc.data(:,2),-tabla_sc.data(:,3)),matadd(tabla_sc.data(:,4),-tabla_sc.data(:,2)),<span class="string">'*'</span>);
set(gca,<span class="string">'Layer'</span>,<span class="string">'Top'</span>);
grid; datetick(<span class="string">'x'</span>,12,<span class="string">'keepLimits'</span>,<span class="string">'keepTicks'</span>);
title(sprintf(<span class="string">'Brewer %s '</span> ,Cal.brw_name{Cal.n_inst}));
ylabel(<span class="string">'Cal Step Number'</span>); box <span class="string">on</span>; axis(<span class="string">'tight'</span>);
hold <span class="string">on</span>; s=stairs(tabla_sc.data(:,1),tabla_sc.data(:,end-1),<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
vl=vline_v(events_cfg_op.data(1,:),<span class="string">'-r'</span>,Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))&gt;=events_cfg_op.data(1,1),3));
set(vl,<span class="string">'LineStyle'</span>,<span class="string">'None'</span>); set(findobj(gcf,<span class="string">'Type'</span>,<span class="string">'Text'</span>),<span class="string">'FontSize'</span>,7);

ix=sort(findobj(<span class="string">'-regexp'</span>,<span class="string">'Tag'</span>,<span class="string">'SC\w+'</span>));
arrayfun( @(x) set(x,<span class="string">'tag'</span>,[Cal.brw_str{Cal.n_inst},<span class="string">'_'</span>,get(x,<span class="string">'tag'</span>)]),ix)

printfiles_report(ix',Cal.dir_figs,<span class="string">'Width'</span>,Width,<span class="string">'Height'</span>,Height);
close <span class="string">all</span>
writetable(tabla_sc_183,<span class="string">'SC_summary_183.txt'</span>)
writetable(tabla_sc_183,<span class="string">'SC_summary_183.xls'</span>)

<span class="comment">%nanmean(tabla_tc.sl{1})</span>
<span class="comment">%nanmean(tabla_tc.sl_r{1})</span>
</pre><pre class="codeoutput">183
Error: Index in position 2 exceeds array bounds.

figs2keep = 

  0&times;0 empty GraphicsPlaceholder array.

183
Error: Index in position 2 exceeds array bounds.

figs2keep = 

  0&times;0 empty GraphicsPlaceholder array.

183
Error: Index in position 2 exceeds array bounds.

figs2keep = 

  0&times;0 empty GraphicsPlaceholder array.

183

figs2keep = 

  0&times;0 empty GraphicsPlaceholder array.

183

figs2keep = 

  0&times;0 empty GraphicsPlaceholder array.

183
OK-&gt;B08816.183
OK-&gt;B10316.183
OK-&gt;B13416.183
OK-&gt;B16616.183

figs2keep = 

  Figure (Final_SC_Calculation) with properties:

      Number: 6
        Name: ''
       Color: [0.9400 0.9400 0.9400]
    Position: [1000 918 560 420]
       Units: 'pixels'

  Use GET to show all properties

183
OK-&gt;B21116.183
OK-&gt;B24316.183
OK-&gt;B30316.183
OK-&gt;B32116.183

figs2keep = 

  2&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_6)

183

figs2keep = 

  2&times;1 Figure array:

  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B34816.183

figs2keep = 

  3&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B04917.183

figs2keep = 

  4&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B09017.183
OK-&gt;B12317.183
OK-&gt;B16617.183
OK-&gt;B20617.183
OK-&gt;B24917.183
OK-&gt;B27117.183

figs2keep = 

  5&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B35717.183

figs2keep = 

  6&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B04818.183

figs2keep = 

  7&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_12)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183

figs2keep = 

  7&times;1 Figure array:

  Figure    (Final_SC_Calculation_13)
  Figure    (Final_SC_Calculation_12)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B06618.183
OK-&gt;B06718.183
OK-&gt;B06818.183
OK-&gt;B06918.183
OK-&gt;B07018.183
OK-&gt;B11418.183

figs2keep = 

  8&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_13)
  Figure    (Final_SC_Calculation_12)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B14418.183
OK-&gt;B15818.183
OK-&gt;B15918.183
OK-&gt;B16018.183
OK-&gt;B16118.183
OK-&gt;B25118.183

figs2keep = 

  9&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_15)
  Figure    (Final_SC_Calculation_13)
  Figure    (Final_SC_Calculation_12)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B30518.183
OK-&gt;B30918.183
OK-&gt;B36018.183

figs2keep = 

  10&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_16)
  Figure    (Final_SC_Calculation_15)
  Figure    (Final_SC_Calculation_13)
  Figure    (Final_SC_Calculation_12)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)

183
OK-&gt;B11419.183
OK-&gt;B14219.183
OK-&gt;B21119.183
OK-&gt;B21319.183

figs2keep = 

  11&times;1 Figure array:

  Figure    (Final_SC_Calculation)
  Figure    (Final_SC_Calculation_17)
  Figure    (Final_SC_Calculation_16)
  Figure    (Final_SC_Calculation_15)
  Figure    (Final_SC_Calculation_13)
  Figure    (Final_SC_Calculation_12)
  Figure    (Final_SC_Calculation_11)
  Figure    (Final_SC_Calculation_10)
  Figure    (Final_SC_Calculation_9)
  Figure    (Final_SC_Calculation_7)
  Figure    (Final_SC_Calculation_6)


tabla_sc_183 =

  18&times;5 table

                                          CSN      x_CI__    x_CI___1    Op_CSN    N
                                         ______    ______    ________    ______    _

    x_SLReplc__                             NaN       NaN        NaN       NaN     0
    x_IOS15_                                NaN       NaN        NaN       NaN     0
    x_Lab1000W_                             NaN       NaN        NaN       NaN     0
    x_Storm_                                NaN       NaN        NaN       NaN     0
    x_Kipp_ZonenMaintenance_                NaN       NaN        NaN       NaN     0
    x_Lab1000W__1                        1020.4    1018.7     1022.2      1020     1
    x_SLReplacement_                     1019.8    1018.1     1021.4      1020     1
    x_BadWeather_                           NaN       NaN        NaN       NaN     0
    x_183Roof_                           1020.3    1018.9     1021.7      1020     1
    x_183Roof__1                         1020.2    1018.3     1022.1      1020     1
    x_Kipp_Zonen_                        1020.4      1019     1021.8      1020     1
    x_HVJump1545___1533_                 1020.6    1018.1     1023.1      1020     1
    x_BadWeather_HVBackOriginalValue_    1019.7    1018.7     1020.7      1020     1
    x_BadWeather__1                         NaN       NaN        NaN       NaN     0
    x_183Roof__2                         1020.3    1018.5       1022      1020     1
    x_SLReplacement__1                     1020    1017.9       1022      1020     1
    x_SofBackTo3_77_                     1020.1    1018.8     1021.4      1020     1
    x_Maintenance_                       1020.3    1018.2     1022.3      1020     1

</pre><h2 id="24">CZ Report</h2><pre class="codeinput">close <span class="string">all</span>; [tabla_HS tabla_HL]=report_wavelength(Cal,<span class="string">'grp'</span>,<span class="string">'events'</span>);
tabla_hl_183=display_table(tabla_HS.data(:,2:end)',tabla_HS.events,12,<span class="string">'.4f'</span>,tabla_HS.data_lbl)
tabla_hs_183=display_table(tabla_HL.data(:,2:end)',tabla_HL.events,12,<span class="string">'.4f'</span>,tabla_HL.data_lbl)

<span class="comment">% Command-Print</span>
<span class="comment">%  fprintf('\r\nHS Scans\r\n');</span>
<span class="comment">%  if size(tabla_HS.data,1)&lt;11</span>
<span class="comment">%    displaytable(tabla_HS.data(:,2:end)',tabla_HS.events,12,'.4f',tabla_HS.data_lbl);</span>
<span class="comment">%  else</span>
<span class="comment">%    displaytable(tabla_HS.data(:,2:end),tabla_HS.data_lbl,11,'.4f',tabla_HS.events);</span>
<span class="comment">%  end</span>
  matrix2latex_ctable(tabla_HS.data(:,2:end)',fullfile(Cal.file_latex,[<span class="string">'table_hs_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                     <span class="string">'rowlabels'</span>,tabla_HS.data_lbl,<span class="string">'columnlabels'</span>,tabla_HS.events,<span class="keyword">...</span>
                                     <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);

<span class="comment">%  fprintf('\r\nHL Scans\r\n');</span>
<span class="comment">%  if size(tabla_HL.data,1)&lt;11</span>
<span class="comment">%    displaytable(tabla_HL.data(:,2:end)',tabla_HL.events,12,'.4f',tabla_HL.data_lbl);</span>
<span class="comment">%  else</span>
<span class="comment">%    displaytable(tabla_HL.data(:,2:end),tabla_HL.data_lbl,11,'.4f',tabla_HL.events);</span>
<span class="comment">%  end</span>
 matrix2latex_ctable(tabla_HL.data(:,2:end)',fullfile(Cal.file_latex,[<span class="string">'table_hl_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                    <span class="string">'rowlabels'</span>,tabla_HL.data_lbl,<span class="string">'columnlabels'</span>,tabla_HL.events,<span class="keyword">...</span>
                                    <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);
</pre><pre class="codeoutput">--------- Validation OK --------------
List of arguments given default values:
               None                   
--------------------------------------
--------- Validation OK --------------
List of arguments given default values:
               None                   
--------------------------------------

tabla_hl_183 =

  10&times;18 table

                    x_SLReplc__    x_IOS15_    x_Lab1000W_    x_Storm_    x_Kipp_ZonenMaintenance_    x_Lab1000W__1    x_SLReplacement_    x_BadWeather_    x_183Roof_    x_183Roof__1    x_Kipp_Zonen_    x_HVJump1545___1533_    x_BadWeather_HVBackOriginalValue_    x_BadWeather__1    x_183Roof__2    x_SLReplacement__1    x_SofBackTo3_77_    x_Maintenance_
                    ___________    ________    ___________    ________    ________________________    _____________    ________________    _____________    __________    ____________    _____________    ____________________    _________________________________    _______________    ____________    __________________    ________________    ______________

    wlReal              NaN          NaN          2967.3        2967.3              2967.3                2967.3             2967.3            2967.3          2967.3         2967.3          2967.3               2967.3                        2967.3                      2967.3            2967.3             2967.3               2967.3             2967.3   
    wl_Slopes           NaN          NaN          2967.2        2967.2              2967.1                2967.2             2967.2            2967.2          2967.2         2967.2          2967.1               2967.2                        2967.2                      2967.2            2967.2             2967.1               2967.2             2967.1   
    std                 NaN          NaN        0.040341      0.046638             0.04787              0.058336            0.04853                 0        0.044418       0.045827          0.2729             0.034604                      0.036427                           0          0.045172            0.05278             0.038951           0.053117   
    Diferencia          NaN          NaN        0.084371      0.088229             0.14529               0.11721           0.098323           0.06594        0.086735        0.10711          0.1696              0.13274                      0.095491                     0.11793          0.095722            0.13871              0.13202            0.16538   
    wl_C_M_             NaN          NaN          2967.1        2967.1              2967.1                2967.1             2967.1            2967.1          2967.1           2967            2967               2967.1                        2967.1                        2967            2967.1             2967.1               2967.1             2967.1   
    std_1               NaN          NaN        0.037795      0.030272            0.016078              0.038376           0.030543                 0        0.031797       0.024743         0.25037             0.027216                      0.032374                           0          0.031501           0.043241              0.02936           0.077228   
    Diferencia_1        NaN          NaN           0.197       0.20703             0.20779               0.22092            0.20786           0.13885         0.21185        0.23314         0.24001              0.20285                       0.18886                     0.24444            0.1967            0.22827              0.20813            0.23177   
    fwhm                NaN          NaN          5.6713        5.6629              5.6303                5.6415             5.6407            5.6598          5.6465         5.6546          5.6103                  5.6                         5.595                      5.5729            5.5965             5.5642               5.5432             5.5547   
    std_2               NaN          NaN        0.028487      0.010843           0.0064939              0.021077            0.03889                 0        0.043957         0.0135        0.095437             0.035208                      0.021157                           0          0.032093           0.059682              0.06161            0.14917   
    N                   NaN          NaN              50            11                   6                   143                155                 1              71             23             271                   72                            18                           1               100                388                  334                257   


tabla_hs_183 =

  10&times;18 table

                    x_SLReplc__    x_IOS15_    x_Lab1000W_    x_Storm_     x_Kipp_ZonenMaintenance_    x_Lab1000W__1    x_SLReplacement_    x_BadWeather_    x_183Roof_    x_183Roof__1    x_Kipp_Zonen_    x_HVJump1545___1533_    x_BadWeather_HVBackOriginalValue_    x_BadWeather__1    x_183Roof__2    x_SLReplacement__1    x_SofBackTo3_77_    x_Maintenance_
                    ___________    ________    ___________    _________    ________________________    _____________    ________________    _____________    __________    ____________    _____________    ____________________    _________________________________    _______________    ____________    __________________    ________________    ______________

    wlReal              NaN          NaN           3341.5        3341.5              3341.5                3341.5             3341.5             3341.5         3341.5         3341.5           3341.5               3341.5                        3341.5                      3341.5           3341.5             3341.5               3341.5             3341.5   
    wl_Slopes           NaN          NaN           3341.6        3341.6              3341.6                3341.6             3341.6             3341.6         3341.6         3341.6           3341.5               3341.5                        3341.5                      3341.6           3341.5             3341.6               3341.6             3341.6   
    std                 NaN          NaN         0.026421      0.016121            0.043377              0.040183           0.040026                  0       0.035306       0.032656         0.043666             0.037628                      0.046742                           0         0.038555           0.050542             0.038922           0.037289   
    Diferencia          NaN          NaN         -0.13928      -0.12838           -0.073389              -0.12111           -0.12184           -0.12805      -0.092653       -0.11049        -0.048347            -0.022127                      -0.03237                   -0.084912        -0.038247          -0.077878             -0.10751           -0.12932   
    wl_C_M_             NaN          NaN           3341.5        3341.5              3341.5                3341.5             3341.6             3341.6         3341.5         3341.5           3341.5               3341.5                        3341.5                      3341.5           3341.5             3341.5               3341.5             3341.5   
    std_1               NaN          NaN         0.030925      0.028079            0.011765              0.031987           0.031302                  0       0.027141       0.021586          0.03586              0.02057                       0.03271                           0         0.068895           0.038797             0.023616           0.036996   
    Diferencia_1        NaN          NaN        -0.064293     -0.055534           -0.044328               -0.0657          -0.067501          -0.095149      -0.054015      -0.055062        -0.017679           0.00080739                    -0.0056997                   -0.026828        -0.016637          -0.036167            -0.051583          -0.061547   
    fwhm                NaN          NaN           5.1331        5.1069              5.1535                  5.12             5.1148             5.1104         5.1092         5.1197           5.1366               5.1341                        5.1183                       5.128           5.1025             5.0965               5.0981             5.0914   
    std_2               NaN          NaN         0.042084      0.064575            0.023494              0.039112           0.046895                  0       0.058957       0.054898         0.041884              0.03897                      0.048019                           0         0.095518             0.0552             0.032047           0.059963   
    N                   NaN          NaN               51            10                   6                   143                155                  1             72             23              269                   73                            19                           1               99                388                  335                258   

</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_35.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_36.png" alt=""> <h2 id="25">DSP's</h2><pre class="codeinput">close <span class="string">all</span>;
Cal.Date.CALC_DAYS=datenum(2015,6,1):now;
tabla_dsp=report_dispersion_new(Cal,<span class="string">'grp'</span>,<span class="string">'events'</span>,<span class="string">'fpath'</span>,fullfile(Cal.path_root,<span class="string">'..'</span>,<span class="string">'DSP'</span>),<span class="string">'process'</span>,0,<span class="keyword">...</span>
                                           <span class="string">'date_range'</span>,Cal.Date.CALC_DAYS);

Cal.Date.CALC_DAYS=datenum(2015,6,1):now;
[tabla_dsp_week,dsp_quad,dsp_cubic]=report_dispersion_new(Cal,<span class="string">'grp'</span>,<span class="string">'week'</span>,<span class="string">'fpath'</span>,fullfile(Cal.path_root,<span class="string">'..'</span>,<span class="string">'DSP'</span>),<span class="string">'process'</span>,0,<span class="keyword">...</span>
                                           <span class="string">'date_range'</span>,Cal.Date.CALC_DAYS);

fprintf(<span class="string">'\r\nDSP  week Analysis\r\n'</span>);
jn=~isnan(tabla_dsp_week.data(:,2));
dsp_week=array2table(tabla_dsp_week.data(jn,1:end),<span class="string">'VariableNames'</span>,varname(tabla_dsp_week.data_lbl),<span class="string">'Rownames'</span>,varname(tabla_dsp_week.events(jn)));
dsp_week.Date=datetime(datestr(tabla_dsp_week.data(jn,1)));

writetable(dsp_week,<span class="string">'dsp_2019_183.txt'</span>)


t_dsp_183=display_table(tabla_dsp_week.data(jn,[1,2 15,17]),tabla_dsp_week.data_lbl([1,2 15,17]),10,<span class="string">'.4f'</span>,tabla_dsp_week.events(jn));
matrix2latex_ctable(tabla_dsp_week.data(jn,15:end),fullfile(Cal.file_latex,[<span class="string">'table_dsp_week'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                    <span class="string">'rowlabels'</span>,tabla_dsp_week.events,<span class="string">'columnlabels'</span>,tabla_dsp_week.data_lbl(14:end),<span class="keyword">...</span>
                                    <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);




events_cfg_op =getcfgs(tabla_dsp.data(:,1)',OP_config);
events_cfg_chk=getcfgs(tabla_dsp.data(:,1)',ALT_config);
jn=~isnan(tabla_dsp.data(:,2));
<span class="comment">%tabla_dsp_183=display_table(tabla_dsp.data(jn,[2:7 14:end]),tabla_dsp.data_lbl([2:7 14:end]),10,'.4f',tabla_dsp.events(jn))</span>

dsp_ev=array2table(tabla_dsp.data(jn,1:end),<span class="string">'VariableNames'</span>,varname(tabla_dsp.data_lbl),<span class="string">'Rownames'</span>,varname(tabla_dsp.events(jn)));
dsp_ev.Date=datetime(datestr(tabla_dsp.data(jn,1)));

writetable(dsp_ev,<span class="string">'dsp_avg_2019_183.txt'</span>)


<span class="comment">% Command-Print</span>
fprintf(<span class="string">'\r\nDSP Analysis\r\n'</span>);
jn=~isnan(tabla_dsp.data(:,2));
<span class="keyword">if</span> size(tabla_dsp.data,1)&lt;13
    displaytable(tabla_dsp.data(jn,[2:8 15:end])',tabla_dsp.events(jn),12,<span class="string">'.4f'</span>,tabla_dsp.data_lbl([2:7 14:end]));
 <span class="keyword">else</span>
    displaytable(tabla_dsp.data(:,[2:8 15:end]),tabla_dsp.data_lbl([2:7 14:end]),10,<span class="string">'.4f'</span>,tabla_dsp.events);
 <span class="keyword">end</span>
 matrix2latex_ctable(tabla_dsp.data(jn,15:end),fullfile(Cal.file_latex,[<span class="string">'table_dsp_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                    <span class="string">'rowlabels'</span>,str2latex(tabla_dsp.events(jn)),<span class="string">'columnlabels'</span>,str2latex(tabla_dsp.data_lbl(14:end)),<span class="keyword">...</span>
                                    <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);
</pre><pre class="codeoutput">
dsp_sum = 

  struct with fields:

       day: 177
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 203
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 219
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 252
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 331
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 8
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 44
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 64
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 105
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 133
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 159
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 168
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 210
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 237
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 250
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 293
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 323
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 364
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 12
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 40
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 62
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 95
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 120
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 137
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 167
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 187
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 235
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 270
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 290
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 354
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 25
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 31
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 68
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 106
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 143
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 178
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 200
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 254
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 306
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 331
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 354
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 24
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 41
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 57
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 75
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 108
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 141
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]

Unable to read file '/Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/183_19_193.mat'. No such file or directory.

datefile =

      737618

now:W1019319.183
now:W3019319.183
now:W7019219.183
now:W8019219.183
now:W9019219.183
now:W11019319.183
now:W12019219.183
now:W1119319.183
now:W3119319.183
now:W7119219.183
now:W8119219.183
now:W9119219.183
now:W11119319.183
now:W12119219.183
now:W13119219.183
now:W3219319.183
now:W7219219.183
now:W8219219.183
now:W9219219.183
now:W11219319.183
now:W12219219.183
now:W13219219.183
now:W3319319.183
now:W7319219.183
now:W8319219.183
now:W9319219.183
now:W11319319.183
now:W12319219.183
now:W13319219.183
now:W7419219.183
now:W8419219.183
now:W9419219.183
now:W11419319.183
now:W12419219.183
now:W13419219.183
now:W7519219.183
now:W8519219.183
now:W9519219.183
now:W11519319.183
now:W12519219.183
now:W13519219.183
now:W14519219.183
lines_dsp_19219__183
saving alldsp to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/alldsp_19219_183.183
eliminamos la linea slit 2 3499.952000 -0.325860
eliminamos la linea slit 6 3403.652000 0.148628
eliminamos la linea slit 4 3499.952000 -0.181400
eliminamos la linea slit 3 3499.952000 -0.194371
eliminamos la linea slit 2 3403.652000 -0.129778
eliminamos la linea slit 1 3261.055000 0.198473
eliminamos la linea slit 3 3261.055000 0.125113
eliminamos la linea slit 2 3261.055000 0.141015
eliminamos la linea slit 1 2967.280000 -0.130500
eliminamos la linea slit 3 3341.480000 0.120429
eliminamos la linea slit 2 2967.280000 -0.151472
saving normaldsp to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/dspnorm_19219_183.183 as brewer compatible file
Use polyval(pwl(2,:),wl) for calculating normal wavelengths
Saving ozonecoeffs to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/opos19219_183.183
 1015 WL(A)         3031.29  3062.38  3100.00  3134.46  3167.47  3199.59
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6216   1.7932   1.0069   0.6785   0.3748   0.2965 O3:  0.3472
Daumt O3abs(1/cm)    2.6285   1.7870   0.9988   0.6716   0.3681   0.2965 O3:  0.3573
     So2abs(1/cm)    3.5923   5.4399   2.3555   1.9902   1.0455   0.6240
Bremen O3abs(1/cm)    2.6314   1.7906   1.0044   0.6813   0.3732   0.2977 O3:  0.3489
 Nicolet 1e4*Rayabs(1/cm)   5055.1   4836.5   4587.9   4374.4   4181.6   4004.2 R:  8.5010
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5051.6   4834.5   4587.4   4375.0   4183.1   4006.5 R:  8.1351
 I0(mW m^-2nm^-1)  11732.59  9434.42  7373.21  4925.28  4083.09  3241.17 ETC:    1438 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.4 DU
Ozone offset due to Rayleigh (Bodhaine): -2.6 DU
Ratio Ozone for So2(A3)=  1.1679, So2/O3(A2)=  2.6080
O3 factor from Bass &amp; Paur to Daumont  =  0.9718 
O3 factor from Bass &amp; Paur to Bremen  =  0.9953 
 1016 WL(A)         3031.36  3062.45  3100.07  3134.53  3167.54  3199.66
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6189   1.7918   1.0067   0.6783   0.3748   0.2961 O3:  0.3464
Daumt O3abs(1/cm)    2.6257   1.7857   0.9985   0.6715   0.3680   0.2962 O3:  0.3566
     So2abs(1/cm)    3.5708   5.4686   2.3623   1.9790   1.0467   0.6220
Bremen O3abs(1/cm)    2.6287   1.7893   1.0041   0.6812   0.3732   0.2974 O3:  0.3481
 Nicolet 1e4*Rayabs(1/cm)   5054.6   4836.0   4587.5   4374.0   4181.2   4003.9 R:  8.4975
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5051.1   4834.0   4587.0   4374.6   4182.7   4006.1 R:  8.1276
 I0(mW m^-2nm^-1)  11726.30  9427.90  7347.78  4921.84  4073.03  3234.20 ETC:    1424 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.6 DU
Ratio Ozone for So2(A3)=  1.1653, So2/O3(A2)=  2.6283
O3 factor from Bass &amp; Paur to Daumont  =  0.9714 
O3 factor from Bass &amp; Paur to Bremen  =  0.9951 
 1017 WL(A)         3031.44  3062.53  3100.14  3134.60  3167.61  3199.73
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6161   1.7905   1.0064   0.6781   0.3748   0.2957 O3:  0.3454
Daumt O3abs(1/cm)    2.6230   1.7844   0.9981   0.6715   0.3680   0.2959 O3:  0.3558
     So2abs(1/cm)    3.5508   5.4954   2.3691   1.9677   1.0480   0.6199
Bremen O3abs(1/cm)    2.6261   1.7879   1.0037   0.6811   0.3732   0.2971 O3:  0.3473
 Nicolet 1e4*Rayabs(1/cm)   5054.1   4835.5   4587.0   4373.5   4180.8   4003.5 R:  8.4940
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.6   4833.5   4586.5   4374.2   4182.3   4005.8 R:  8.1282
 I0(mW m^-2nm^-1)  11720.02  9421.40  7322.48  4917.87  4062.98  3224.36 ETC:    1406 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.6 DU
Ratio Ozone for So2(A3)=  1.1625, So2/O3(A2)=  2.6473
O3 factor from Bass &amp; Paur to Daumont  =  0.9708 
O3 factor from Bass &amp; Paur to Bremen  =  0.9947 
 1018 WL(A)         3031.51  3062.60  3100.22  3134.67  3167.68  3199.80
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6133   1.7890   1.0061   0.6779   0.3748   0.2952 O3:  0.3444
Daumt O3abs(1/cm)    2.6202   1.7831   0.9978   0.6715   0.3680   0.2956 O3:  0.3550
     So2abs(1/cm)    3.5317   5.5219   2.3759   1.9562   1.0492   0.6178
Bremen O3abs(1/cm)    2.6234   1.7865   1.0034   0.6810   0.3732   0.2968 O3:  0.3464
 Nicolet 1e4*Rayabs(1/cm)   5053.5   4835.0   4586.6   4373.1   4180.4   4003.1 R:  8.4905
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.0   4833.0   4586.1   4373.8   4181.9   4005.4 R:  8.1251
 I0(mW m^-2nm^-1)  11713.74  9414.91  7297.34  4913.91  4052.96  3214.53 ETC:    1389 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.6 DU
Ratio Ozone for So2(A3)=  1.1595, So2/O3(A2)=  2.6665
O3 factor from Bass &amp; Paur to Daumont  =  0.9702 
O3 factor from Bass &amp; Paur to Bremen  =  0.9942 
 1019 WL(A)         3031.58  3062.67  3100.29  3134.74  3167.75  3199.87
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6104   1.7875   1.0058   0.6777   0.3748   0.2947 O3:  0.3434
Daumt O3abs(1/cm)    2.6175   1.7818   0.9975   0.6714   0.3680   0.2953 O3:  0.3542
     So2abs(1/cm)    3.5126   5.5478   2.3834   1.9447   1.0505   0.6156
Bremen O3abs(1/cm)    2.6208   1.7851   1.0031   0.6809   0.3732   0.2964 O3:  0.3455
 Nicolet 1e4*Rayabs(1/cm)   5053.0   4834.5   4586.1   4372.7   4180.0   4002.7 R:  8.4871
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.5   4832.5   4585.6   4373.3   4181.5   4005.0 R:  8.1184
 I0(mW m^-2nm^-1)  11707.48  9408.43  7272.33  4909.94  4042.97  3204.73 ETC:    1371 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1564, So2/O3(A2)=  2.6856
O3 factor from Bass &amp; Paur to Daumont  =  0.9695 
O3 factor from Bass &amp; Paur to Bremen  =  0.9937 
 1020 WL(A)         3031.66  3062.74  3100.36  3134.81  3167.82  3199.94
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6078   1.7861   1.0055   0.6774   0.3749   0.2943 O3:  0.3423
Daumt O3abs(1/cm)    2.6148   1.7805   0.9971   0.6713   0.3680   0.2949 O3:  0.3533
     So2abs(1/cm)    3.4937   5.5735   2.3909   1.9331   1.0517   0.6134
Bremen O3abs(1/cm)    2.6182   1.7836   1.0027   0.6807   0.3732   0.2960 O3:  0.3446
 Nicolet 1e4*Rayabs(1/cm)   5052.5   4834.1   4585.6   4372.3   4179.6   4002.4 R:  8.4836
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.0   4832.1   4585.2   4372.9   4181.1   4004.7 R:  8.1178
 I0(mW m^-2nm^-1)  11701.22  9401.95  7247.47  4905.98  4032.99  3194.94 ETC:    1353 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1533, So2/O3(A2)=  2.7044
O3 factor from Bass &amp; Paur to Daumont  =  0.9690 
O3 factor from Bass &amp; Paur to Bremen  =  0.9934 
 1021 WL(A)         3031.73  3062.82  3100.43  3134.88  3167.89  3200.01
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6052   1.7845   1.0052   0.6772   0.3749   0.2938 O3:  0.3413
Daumt O3abs(1/cm)    2.6122   1.7791   0.9968   0.6711   0.3680   0.2945 O3:  0.3523
     So2abs(1/cm)    3.4760   5.5975   2.3985   1.9218   1.0530   0.6112
Bremen O3abs(1/cm)    2.6156   1.7822   1.0024   0.6806   0.3732   0.2956 O3:  0.3436
 Nicolet 1e4*Rayabs(1/cm)   5051.9   4833.6   4585.2   4371.8   4179.2   4002.0 R:  8.4801
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.5   4831.6   4584.7   4372.5   4180.7   4004.3 R:  8.1145
 I0(mW m^-2nm^-1)  11694.97  9395.49  7227.54  4902.03  4023.04  3185.18 ETC:    1341 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1502, So2/O3(A2)=  2.7219
O3 factor from Bass &amp; Paur to Daumont  =  0.9688 
O3 factor from Bass &amp; Paur to Bremen  =  0.9933 
 1022 WL(A)         3031.80  3062.89  3100.50  3134.95  3167.96  3200.08
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6027   1.7830   1.0049   0.6769   0.3749   0.2933 O3:  0.3403
Daumt O3abs(1/cm)    2.6095   1.7777   0.9965   0.6710   0.3680   0.2941 O3:  0.3513
     So2abs(1/cm)    3.4593   5.6209   2.4061   1.9100   1.0542   0.6090
Bremen O3abs(1/cm)    2.6131   1.7807   1.0020   0.6804   0.3732   0.2952 O3:  0.3426
 Nicolet 1e4*Rayabs(1/cm)   5051.4   4833.1   4584.7   4371.4   4178.8   4001.6 R:  8.4766
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.0   4831.1   4584.2   4372.1   4180.4   4003.9 R:  8.1110
 I0(mW m^-2nm^-1)  11688.73  9389.03  7212.46  4898.07  4013.11  3175.44 ETC:    1333 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1470, So2/O3(A2)=  2.7391
O3 factor from Bass &amp; Paur to Daumont  =  0.9687 
O3 factor from Bass &amp; Paur to Bremen  =  0.9934 
 1023 WL(A)         3031.88  3062.96  3100.57  3135.02  3168.03  3200.15
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.6002   1.7815   1.0047   0.6766   0.3750   0.2929 O3:  0.3393
Daumt O3abs(1/cm)    2.6069   1.7763   0.9961   0.6708   0.3681   0.2937 O3:  0.3503
     So2abs(1/cm)    3.4427   5.6437   2.4142   1.8983   1.0554   0.6067
Bremen O3abs(1/cm)    2.6106   1.7792   1.0017   0.6801   0.3733   0.2948 O3:  0.3415
 Nicolet 1e4*Rayabs(1/cm)   5050.9   4832.6   4584.3   4371.0   4178.4   4001.3 R:  8.4732
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.4   4830.6   4583.8   4371.7   4180.0   4003.6 R:  8.1066
 I0(mW m^-2nm^-1)  11682.50  9382.59  7197.81  4894.12  4003.20  3165.72 ETC:    1325 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1437, So2/O3(A2)=  2.7562
O3 factor from Bass &amp; Paur to Daumont  =  0.9686 
O3 factor from Bass &amp; Paur to Bremen  =  0.9934 
 1024 WL(A)         3031.95  3063.03  3100.64  3135.09  3168.10  3200.21
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.5976   1.7801   1.0044   0.6762   0.3751   0.2923 O3:  0.3381
Daumt O3abs(1/cm)    2.6044   1.7749   0.9958   0.6706   0.3681   0.2933 O3:  0.3492
     So2abs(1/cm)    3.4263   5.6661   2.4226   1.8866   1.0566   0.6043
Bremen O3abs(1/cm)    2.6081   1.7777   1.0014   0.6799   0.3734   0.2944 O3:  0.3404
 Nicolet 1e4*Rayabs(1/cm)   5050.4   4832.1   4583.8   4370.6   4178.0   4000.9 R:  8.4697
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.9   4830.1   4583.3   4371.2   4179.6   4003.2 R:  8.1043
 I0(mW m^-2nm^-1)  11676.28  9376.15  7183.57  4890.18  3993.31  3156.02 ETC:    1318 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1401, So2/O3(A2)=  2.7733
O3 factor from Bass &amp; Paur to Daumont  =  0.9681 
O3 factor from Bass &amp; Paur to Bremen  =  0.9931 
 1025 WL(A)         3032.02  3063.11  3100.72  3135.16  3168.17  3200.28
      Res(A)          11.19    10.92    10.79    11.04    10.92    10.73
      O3abs(1/cm)    2.5949   1.7784   1.0041   0.6758   0.3751   0.2917 O3:  0.3368
Daumt O3abs(1/cm)    2.6018   1.7735   0.9955   0.6704   0.3682   0.2929 O3:  0.3481
     So2abs(1/cm)    3.4110   5.6870   2.4309   1.8751   1.0578   0.6019
Bremen O3abs(1/cm)    2.6056   1.7762   1.0011   0.6796   0.3734   0.2939 O3:  0.3393
 Nicolet 1e4*Rayabs(1/cm)   5049.8   4831.6   4583.4   4370.1   4177.6   4000.5 R:  8.4662
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.4   4829.6   4582.9   4370.8   4179.2   4002.8 R:  8.1012
 I0(mW m^-2nm^-1)  11670.07  9369.72  7169.05  4886.23  3983.45  3146.35 ETC:    1311 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.5 DU
Ozone offset due to Rayleigh (Bodhaine): -2.7 DU
Ratio Ozone for So2(A3)=  1.1363, So2/O3(A2)=  2.7900
O3 factor from Bass &amp; Paur to Daumont  =  0.9675 
O3 factor from Bass &amp; Paur to Bremen  =  0.9926 
saving powfiu7 to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/dsp_19219_183.183

freecoef =

     4


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9

saving data to file:/Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/dsp_19219_183.183
Use brstps2 to calculate steps and wavelengths
Saving ozonecoeffs to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_193/opos_pow7_19219_183.183
 1015 WL(A)         3031.45  3062.50  3100.02  3134.56  3167.61  3199.69
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.6158   1.7910   1.0068   0.6783   0.3748   0.2960 O3:  0.3463
Daumt O3abs(1/cm)    2.6226   1.7849   0.9987   0.6716   0.3680   0.2961 O3:  0.3567
     So2abs(1/cm)    3.5482   5.4869   2.3575   1.9737   1.0479   0.6212
Bremen O3abs(1/cm)    2.6257   1.7884   1.0043   0.6812   0.3732   0.2973 O3:  0.3482
 Nicolet 1e4*Rayabs(1/cm)   5054.0   4835.7   4587.8   4373.8   4180.8   4003.7 R:  9.4923
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.5   4833.7   4587.3   4374.4   4182.3   4006.0 R:  9.1201
 I0(mW m^-2nm^-1)  11719.52  9423.73  7365.77  4919.91  4063.53  3230.47 ETC:    1458 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1639, So2/O3(A2)=  2.6406
O3 factor from Bass &amp; Paur to Daumont  =  0.9709 
O3 factor from Bass &amp; Paur to Bremen  =  0.9947 
 1016 WL(A)         3031.52  3062.57  3100.10  3134.63  3167.68  3199.76
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.6129   1.7896   1.0066   0.6781   0.3748   0.2955 O3:  0.3454
Daumt O3abs(1/cm)    2.6199   1.7836   0.9984   0.6715   0.3680   0.2958 O3:  0.3559
     So2abs(1/cm)    3.5291   5.5135   2.3642   1.9623   1.0492   0.6191
Bremen O3abs(1/cm)    2.6231   1.7870   1.0040   0.6811   0.3732   0.2970 O3:  0.3473
 Nicolet 1e4*Rayabs(1/cm)   5053.5   4835.2   4587.3   4373.3   4180.4   4003.3 R:  9.4899
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.0   4833.2   4586.8   4374.0   4181.9   4005.6 R:  9.1185
 I0(mW m^-2nm^-1)  11713.24  9417.23  7340.31  4915.94  4053.51  3220.62 ETC:    1440 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1611, So2/O3(A2)=  2.6597
O3 factor from Bass &amp; Paur to Daumont  =  0.9705 
O3 factor from Bass &amp; Paur to Bremen  =  0.9944 
 1017 WL(A)         3031.59  3062.65  3100.17  3134.70  3167.75  3199.83
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.6100   1.7881   1.0063   0.6779   0.3748   0.2950 O3:  0.3443
Daumt O3abs(1/cm)    2.6172   1.7823   0.9980   0.6715   0.3680   0.2955 O3:  0.3550
     So2abs(1/cm)    3.5100   5.5397   2.3710   1.9507   1.0504   0.6170
Bremen O3abs(1/cm)    2.6205   1.7856   1.0036   0.6810   0.3732   0.2966 O3:  0.3464
 Nicolet 1e4*Rayabs(1/cm)   5052.9   4834.7   4586.9   4372.9   4180.0   4003.0 R:  9.4876
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.5   4832.7   4586.4   4373.6   4181.6   4005.3 R:  9.1154
 I0(mW m^-2nm^-1)  11706.97  9410.73  7315.00  4911.96  4043.52  3210.80 ETC:    1422 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1580, So2/O3(A2)=  2.6790
O3 factor from Bass &amp; Paur to Daumont  =  0.9698 
O3 factor from Bass &amp; Paur to Bremen  =  0.9939 
 1018 WL(A)         3031.67  3062.72  3100.24  3134.77  3167.82  3199.90
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.6075   1.7867   1.0060   0.6776   0.3749   0.2946 O3:  0.3433
Daumt O3abs(1/cm)    2.6145   1.7810   0.9977   0.6714   0.3680   0.2951 O3:  0.3542
     So2abs(1/cm)    3.4910   5.5655   2.3780   1.9392   1.0517   0.6148
Bremen O3abs(1/cm)    2.6179   1.7842   1.0033   0.6809   0.3732   0.2963 O3:  0.3455
 Nicolet 1e4*Rayabs(1/cm)   5052.4   4834.2   4586.4   4372.5   4179.6   4002.6 R:  9.4852
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.9   4832.2   4585.9   4373.1   4181.2   4004.9 R:  9.1124
 I0(mW m^-2nm^-1)  11700.71  9404.25  7289.83  4907.99  4033.54  3200.99 ETC:    1404 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1549, So2/O3(A2)=  2.6980
O3 factor from Bass &amp; Paur to Daumont  =  0.9692 
O3 factor from Bass &amp; Paur to Bremen  =  0.9935 
 1019 WL(A)         3031.74  3062.79  3100.31  3134.84  3167.88  3199.96
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.6049   1.7851   1.0057   0.6774   0.3749   0.2941 O3:  0.3422
Daumt O3abs(1/cm)    2.6119   1.7796   0.9973   0.6712   0.3680   0.2948 O3:  0.3532
     So2abs(1/cm)    3.4737   5.5901   2.3855   1.9277   1.0529   0.6126
Bremen O3abs(1/cm)    2.6153   1.7828   1.0029   0.6807   0.3732   0.2959 O3:  0.3445
 Nicolet 1e4*Rayabs(1/cm)   5051.9   4833.7   4585.9   4372.1   4179.2   4002.2 R:  9.4829
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.4   4831.7   4585.5   4372.7   4180.8   4004.5 R:  9.1119
 I0(mW m^-2nm^-1)  11694.45  9397.77  7264.80  4904.03  4023.60  3191.21 ETC:    1386 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1517, So2/O3(A2)=  2.7160
O3 factor from Bass &amp; Paur to Daumont  =  0.9689 
O3 factor from Bass &amp; Paur to Bremen  =  0.9933 
 1020 WL(A)         3031.81  3062.86  3100.38  3134.91  3167.95  3200.03
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.6024   1.7836   1.0054   0.6771   0.3749   0.2936 O3:  0.3412
Daumt O3abs(1/cm)    2.6092   1.7783   0.9970   0.6711   0.3680   0.2944 O3:  0.3523
     So2abs(1/cm)    3.4570   5.6136   2.3931   1.9163   1.0541   0.6104
Bremen O3abs(1/cm)    2.6128   1.7813   1.0026   0.6805   0.3733   0.2955 O3:  0.3435
 Nicolet 1e4*Rayabs(1/cm)   5051.4   4833.2   4585.5   4371.6   4178.8   4001.9 R:  9.4806
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.9   4831.3   4585.0   4372.3   4180.4   4004.2 R:  9.1105
 I0(mW m^-2nm^-1)  11688.21  9391.30  7239.92  4900.06  4013.67  3181.44 ETC:    1368 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1486, So2/O3(A2)=  2.7333
O3 factor from Bass &amp; Paur to Daumont  =  0.9686 
O3 factor from Bass &amp; Paur to Bremen  =  0.9932 
 1021 WL(A)         3031.88  3062.93  3100.45  3134.98  3168.02  3200.10
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.5999   1.7821   1.0051   0.6768   0.3750   0.2932 O3:  0.3401
Daumt O3abs(1/cm)    2.6066   1.7769   0.9967   0.6710   0.3681   0.2940 O3:  0.3512
     So2abs(1/cm)    3.4404   5.6368   2.4007   1.9045   1.0554   0.6081
Bremen O3abs(1/cm)    2.6103   1.7798   1.0023   0.6803   0.3733   0.2951 O3:  0.3425
 Nicolet 1e4*Rayabs(1/cm)   5050.8   4832.7   4585.0   4371.2   4178.4   4001.5 R:  9.4782
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.4   4830.8   4584.6   4371.9   4180.0   4003.8 R:  9.1048
 I0(mW m^-2nm^-1)  11681.97  9384.84  7224.02  4896.10  4003.76  3171.70 ETC:    1360 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1453, So2/O3(A2)=  2.7506
O3 factor from Bass &amp; Paur to Daumont  =  0.9684 
O3 factor from Bass &amp; Paur to Bremen  =  0.9931 
 1022 WL(A)         3031.96  3063.01  3100.52  3135.05  3168.09  3200.17
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.5973   1.7806   1.0049   0.6764   0.3751   0.2927 O3:  0.3391
Daumt O3abs(1/cm)    2.6041   1.7755   0.9964   0.6708   0.3681   0.2936 O3:  0.3502
     So2abs(1/cm)    3.4239   5.6593   2.4083   1.8928   1.0566   0.6058
Bremen O3abs(1/cm)    2.6078   1.7783   1.0019   0.6801   0.3734   0.2947 O3:  0.3414
 Nicolet 1e4*Rayabs(1/cm)   5050.3   4832.3   4584.6   4370.8   4178.0   4001.1 R:  9.4759
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.8   4830.3   4584.1   4371.5   4179.6   4003.4 R:  9.1048
 I0(mW m^-2nm^-1)  11675.75  9378.40  7209.04  4892.15  3993.88  3161.98 ETC:    1352 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1419, So2/O3(A2)=  2.7676
O3 factor from Bass &amp; Paur to Daumont  =  0.9683 
O3 factor from Bass &amp; Paur to Bremen  =  0.9931 
 1023 WL(A)         3032.03  3063.08  3100.60  3135.12  3168.16  3200.24
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.5946   1.7791   1.0046   0.6760   0.3751   0.2921 O3:  0.3379
Daumt O3abs(1/cm)    2.6015   1.7740   0.9960   0.6706   0.3682   0.2932 O3:  0.3491
     So2abs(1/cm)    3.4090   5.6808   2.4166   1.8811   1.0578   0.6034
Bremen O3abs(1/cm)    2.6054   1.7768   1.0016   0.6798   0.3734   0.2942 O3:  0.3403
 Nicolet 1e4*Rayabs(1/cm)   5049.8   4831.8   4584.1   4370.4   4177.6   4000.8 R:  9.4736
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.3   4829.8   4583.6   4371.0   4179.2   4003.1 R:  9.1057
 I0(mW m^-2nm^-1)  11669.53  9371.96  7194.49  4888.20  3984.02  3152.28 ETC:    1344 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1382, So2/O3(A2)=  2.7844
O3 factor from Bass &amp; Paur to Daumont  =  0.9679 
O3 factor from Bass &amp; Paur to Bremen  =  0.9929 
 1024 WL(A)         3032.10  3063.15  3100.67  3135.20  3168.23  3200.31
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.5919   1.7775   1.0043   0.6756   0.3752   0.2915 O3:  0.3366
Daumt O3abs(1/cm)    2.5990   1.7726   0.9957   0.6703   0.3683   0.2927 O3:  0.3479
     So2abs(1/cm)    3.3948   5.7010   2.4250   1.8696   1.0589   0.6011
Bremen O3abs(1/cm)    2.6029   1.7752   1.0013   0.6795   0.3735   0.2937 O3:  0.3391
 Nicolet 1e4*Rayabs(1/cm)   5049.2   4831.3   4583.7   4369.9   4177.2   4000.4 R:  9.4712
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5045.8   4829.3   4583.2   4370.6   4178.8   4002.7 R:  9.0977
 I0(mW m^-2nm^-1)  11663.32  9365.53  7180.34  4884.25  3974.18  3142.60 ETC:    1337 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1343, So2/O3(A2)=  2.8007
O3 factor from Bass &amp; Paur to Daumont  =  0.9673 
O3 factor from Bass &amp; Paur to Bremen  =  0.9924 
 1025 WL(A)         3032.18  3063.22  3100.74  3135.27  3168.30  3200.38
      Res(A)          11.18    10.90    10.77    11.03    10.92    10.72
      O3abs(1/cm)    2.5896   1.7758   1.0040   0.6752   0.3753   0.2909 O3:  0.3352
Daumt O3abs(1/cm)    2.5965   1.7711   0.9954   0.6701   0.3683   0.2922 O3:  0.3468
     So2abs(1/cm)    3.3807   5.7209   2.4333   1.8578   1.0601   0.5987
Bremen O3abs(1/cm)    2.6005   1.7737   1.0010   0.6792   0.3736   0.2932 O3:  0.3379
 Nicolet 1e4*Rayabs(1/cm)   5048.7   4830.8   4583.2   4369.5   4176.8   4000.0 R:  9.4689
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5045.3   4828.8   4582.7   4370.2   4178.4   4002.3 R:  9.0970
 I0(mW m^-2nm^-1)  11657.12  9359.11  7164.81  4880.30  3964.36  3134.51 ETC:    1332 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1304, So2/O3(A2)=  2.8169
O3 factor from Bass &amp; Paur to Daumont  =  0.9668 
O3 factor from Bass &amp; Paur to Bremen  =  0.9921 
Unable to read file '/Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/183_19_219.mat'. No such file or directory.

datefile =

      737644

now:W1021819.183
now:W3021819.183
now:W7021819.183
now:W8021819.183
now:W9021819.183
now:W11021819.183
now:W12021819.183
now:W1121819.183
now:W3121819.183
now:W7121819.183
now:W8121819.183
now:W9121819.183
now:W11121819.183
now:W12121819.183
now:W13121819.183
now:W3221819.183
now:W7221819.183
now:W8221819.183
now:W9221819.183
now:W11221819.183
now:W12221819.183
now:W13221819.183
now:W3321819.183
now:W7321819.183
now:W8321819.183
now:W9321819.183
now:W11321819.183
now:W12321819.183
now:W13321819.183
now:W7421819.183
now:W8421819.183
now:W9421819.183
now:W11421819.183
now:W12421819.183
now:W13421819.183
now:W7521819.183
now:W8521819.183
now:W9521819.183
now:W11521819.183
now:W12521819.183
now:W13521819.183
now:W14521819.183
lines_dsp_21819__183
saving alldsp to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/alldsp_21819_183.183
eliminamos la linea slit 4 3341.480000 0.257571
eliminamos la linea slit 3 3133.167000 -0.276488
eliminamos la linea slit 2 3499.952000 -0.348237
eliminamos la linea slit 6 3403.652000 0.129980
eliminamos la linea slit 5 3261.055000 -0.136259
eliminamos la linea slit 4 3499.952000 -0.171180
eliminamos la linea slit 3 3499.952000 -0.147319
eliminamos la linea slit 2 3403.652000 -0.164595
eliminamos la linea slit 1 3403.652000 -0.155727
eliminamos la linea slit 6 3341.480000 0.149554
eliminamos la linea slit 3 3080.822000 -0.134291
eliminamos la linea slit 2 3261.055000 0.125907
eliminamos la linea slit 1 3261.055000 0.137112
eliminamos la linea slit 2 2967.280000 -0.147543
saving normaldsp to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/dspnorm_21819_183.183 as brewer compatible file
Use polyval(pwl(2,:),wl) for calculating normal wavelengths
Saving ozonecoeffs to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/opos21819_183.183
 1015 WL(A)         3031.39  3062.44  3099.73  3134.53  3167.46  3199.71
      Res(A)          11.18    11.01    10.75    11.05    10.91    10.71
      O3abs(1/cm)    2.6180   1.7919   1.0080   0.6783   0.3748   0.2959 O3:  0.3474
Daumt O3abs(1/cm)    2.6248   1.7858   1.0002   0.6715   0.3681   0.2961 O3:  0.3579
     So2abs(1/cm)    3.5635   5.4569   2.3314   1.9787   1.0452   0.6206
Bremen O3abs(1/cm)    2.6279   1.7893   1.0058   0.6812   0.3732   0.2972 O3:  0.3495
 Nicolet 1e4*Rayabs(1/cm)   5054.4   4836.1   4589.7   4374.0   4181.6   4003.6 R:  9.1962
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.9   4834.1   4589.1   4374.6   4183.2   4005.9 R:  8.8256
 I0(mW m^-2nm^-1)  11724.63  9429.03  7474.61  4921.76  4085.20  3227.25 ETC:    1513 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.6 DU
Ozone offset due to Rayleigh (Bodhaine): -2.8 DU
Ratio Ozone for So2(A3)=  1.1646, So2/O3(A2)=  2.6213
O3 factor from Bass &amp; Paur to Daumont  =  0.9705 
O3 factor from Bass &amp; Paur to Bremen  =  0.9940 
 1016 WL(A)         3031.46  3062.51  3099.80  3134.60  3167.52  3199.78
      Res(A)          11.18    11.01    10.75    11.05    10.91    10.71
      O3abs(1/cm)    2.6152   1.7905   1.0077   0.6781   0.3748   0.2954 O3:  0.3463
Daumt O3abs(1/cm)    2.6221   1.7845   0.9998   0.6715   0.3680   0.2957 O3:  0.3571
     So2abs(1/cm)    3.5443   5.4849   2.3374   1.9674   1.0465   0.6184
Bremen O3abs(1/cm)    2.6252   1.7880   1.0054   0.6811   0.3732   0.2969 O3:  0.3486
 Nicolet 1e4*Rayabs(1/cm)   5053.9   4835.6   4589.2   4373.5   4181.2   4003.2 R:  9.1921
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.4   4833.6   4588.7   4374.2   4182.8   4005.5 R:  8.8181
 I0(mW m^-2nm^-1)  11718.33  9422.62  7448.34  4917.79  4075.12  3217.37 ETC:    1494 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.8 DU
Ratio Ozone for So2(A3)=  1.1616, So2/O3(A2)=  2.6418
O3 factor from Bass &amp; Paur to Daumont  =  0.9697 
O3 factor from Bass &amp; Paur to Bremen  =  0.9934 
 1017 WL(A)         3031.53  3062.59  3099.87  3134.67  3167.59  3199.85
      Res(A)          11.18    11.01    10.75    11.05    10.91    10.71
      O3abs(1/cm)    2.6123   1.7890   1.0074   0.6779   0.3748   0.2949 O3:  0.3452
Daumt O3abs(1/cm)    2.6194   1.7832   0.9994   0.6714   0.3680   0.2954 O3:  0.3563
     So2abs(1/cm)    3.5252   5.5110   2.3434   1.9559   1.0477   0.6164
Bremen O3abs(1/cm)    2.6226   1.7866   1.0051   0.6810   0.3731   0.2965 O3:  0.3478
 Nicolet 1e4*Rayabs(1/cm)   5053.4   4835.1   4588.7   4373.1   4180.8   4002.9 R:  9.1881
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.9   4833.1   4588.2   4373.8   4182.4   4005.1 R:  8.8136
 I0(mW m^-2nm^-1)  11712.04  9416.22  7422.22  4913.83  4065.06  3207.51 ETC:    1475 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.8 DU
Ratio Ozone for So2(A3)=  1.1586, So2/O3(A2)=  2.6609
O3 factor from Bass &amp; Paur to Daumont  =  0.9689 
O3 factor from Bass &amp; Paur to Bremen  =  0.9928 
 1018 WL(A)         3031.61  3062.66  3099.94  3134.74  3167.66  3199.92
      Res(A)          11.18    11.01    10.75    11.05    10.91    10.71
      O3abs(1/cm)    2.6095   1.7876   1.0071   0.6777   0.3748   0.2944 O3:  0.3443
Daumt O3abs(1/cm)    2.6167   1.7819   0.9991   0.6714   0.3680   0.2951 O3:  0.3555
     So2abs(1/cm)    3.5060   5.5363   2.3495   1.9444   1.0490   0.6141
Bremen O3abs(1/cm)    2.6200   1.7852   1.0047   0.6809   0.3731   0.2962 O3:  0.3469
 Nicolet 1e4*Rayabs(1/cm)   5052.8   4834.6   4588.3   4372.7   4180.4   4002.5 R:  9.1841
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.4   4832.6   4587.8   4373.3   4182.0   4004.8 R:  8.8126
 I0(mW m^-2nm^-1)  11705.76  9409.83  7396.26  4909.87  4055.02  3197.67 ETC:    1456 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1557, So2/O3(A2)=  2.6789
O3 factor from Bass &amp; Paur to Daumont  =  0.9686 
O3 factor from Bass &amp; Paur to Bremen  =  0.9926 
 1019 WL(A)         3031.68  3062.73  3100.02  3134.81  3167.73  3199.99
      Res(A)          11.18    11.01    10.75    11.05    10.91    10.71
      O3abs(1/cm)    2.6070   1.7861   1.0069   0.6774   0.3748   0.2940 O3:  0.3434
Daumt O3abs(1/cm)    2.6140   1.7805   0.9987   0.6713   0.3680   0.2947 O3:  0.3546
     So2abs(1/cm)    3.4871   5.5616   2.3562   1.9328   1.0503   0.6119
Bremen O3abs(1/cm)    2.6174   1.7837   1.0044   0.6807   0.3731   0.2958 O3:  0.3459
 Nicolet 1e4*Rayabs(1/cm)   5052.3   4834.1   4587.8   4372.3   4180.1   4002.1 R:  9.1801
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.8   4832.1   4587.3   4372.9   4181.6   4004.4 R:  8.8076
 I0(mW m^-2nm^-1)  11699.49  9403.45  7370.46  4905.91  4045.01  3187.86 ETC:    1438 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1527, So2/O3(A2)=  2.6970
O3 factor from Bass &amp; Paur to Daumont  =  0.9684 
O3 factor from Bass &amp; Paur to Bremen  =  0.9926 
 1020 WL(A)         3031.75  3062.80  3100.09  3134.88  3167.80  3200.06
      Res(A)          11.18    11.01    10.75    11.05    10.90    10.71
      O3abs(1/cm)    2.6044   1.7846   1.0066   0.6772   0.3748   0.2935 O3:  0.3424
Daumt O3abs(1/cm)    2.6113   1.7792   0.9984   0.6711   0.3680   0.2943 O3:  0.3536
     So2abs(1/cm)    3.4702   5.5869   2.3630   1.9214   1.0515   0.6097
Bremen O3abs(1/cm)    2.6148   1.7823   1.0040   0.6805   0.3732   0.2954 O3:  0.3449
 Nicolet 1e4*Rayabs(1/cm)   5051.8   4833.6   4587.4   4371.8   4179.7   4001.7 R:  9.1761
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.3   4831.7   4586.9   4372.5   4181.2   4004.0 R:  8.8011
 I0(mW m^-2nm^-1)  11693.23  9397.08  7344.80  4901.96  4035.02  3178.06 ETC:    1419 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1496, So2/O3(A2)=  2.7155
O3 factor from Bass &amp; Paur to Daumont  =  0.9683 
O3 factor from Bass &amp; Paur to Bremen  =  0.9926 
 1021 WL(A)         3031.83  3062.88  3100.16  3134.95  3167.87  3200.12
      Res(A)          11.18    11.01    10.75    11.05    10.90    10.71
      O3abs(1/cm)    2.6019   1.7831   1.0063   0.6769   0.3749   0.2930 O3:  0.3414
Daumt O3abs(1/cm)    2.6087   1.7778   0.9981   0.6710   0.3680   0.2939 O3:  0.3526
     So2abs(1/cm)    3.4535   5.6100   2.3698   1.9097   1.0527   0.6074
Bremen O3abs(1/cm)    2.6123   1.7808   1.0037   0.6803   0.3732   0.2950 O3:  0.3439
 Nicolet 1e4*Rayabs(1/cm)   5051.3   4833.2   4586.9   4371.4   4179.3   4001.4 R:  9.1721
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.8   4831.2   4586.4   4372.1   4180.8   4003.7 R:  8.7997
 I0(mW m^-2nm^-1)  11686.98  9390.72  7319.30  4898.01  4025.05  3168.29 ETC:    1401 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1464, So2/O3(A2)=  2.7322
O3 factor from Bass &amp; Paur to Daumont  =  0.9681 
O3 factor from Bass &amp; Paur to Bremen  =  0.9926 
 1022 WL(A)         3031.90  3062.95  3100.23  3135.02  3167.94  3200.19
      Res(A)          11.18    11.01    10.75    11.05    10.90    10.71
      O3abs(1/cm)    2.5994   1.7816   1.0060   0.6765   0.3749   0.2925 O3:  0.3403
Daumt O3abs(1/cm)    2.6061   1.7764   0.9977   0.6708   0.3680   0.2935 O3:  0.3516
     So2abs(1/cm)    3.4368   5.6323   2.3766   1.8980   1.0540   0.6051
Bremen O3abs(1/cm)    2.6098   1.7793   1.0033   0.6801   0.3732   0.2945 O3:  0.3429
 Nicolet 1e4*Rayabs(1/cm)   5050.7   4832.7   4586.5   4371.0   4178.9   4001.0 R:  9.1680
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.3   4830.7   4586.0   4371.6   4180.4   4003.3 R:  8.7968
 I0(mW m^-2nm^-1)  11680.73  9384.37  7293.94  4894.06  4015.10  3158.53 ETC:    1383 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1431, So2/O3(A2)=  2.7485
O3 factor from Bass &amp; Paur to Daumont  =  0.9678 
O3 factor from Bass &amp; Paur to Bremen  =  0.9924 
 1023 WL(A)         3031.97  3063.02  3100.30  3135.09  3168.01  3200.26
      Res(A)          11.18    11.01    10.75    11.05    10.90    10.71
      O3abs(1/cm)    2.5967   1.7801   1.0057   0.6761   0.3750   0.2919 O3:  0.3390
Daumt O3abs(1/cm)    2.6035   1.7750   0.9974   0.6706   0.3680   0.2930 O3:  0.3505
     So2abs(1/cm)    3.4205   5.6543   2.3841   1.8863   1.0552   0.6027
Bremen O3abs(1/cm)    2.6073   1.7778   1.0030   0.6799   0.3733   0.2941 O3:  0.3418
 Nicolet 1e4*Rayabs(1/cm)   5050.2   4832.2   4586.0   4370.6   4178.5   4000.6 R:  9.1640
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.7   4830.2   4585.5   4371.2   4180.0   4002.9 R:  8.7905
 I0(mW m^-2nm^-1)  11674.49  9378.02  7268.72  4890.11  4005.17  3148.80 ETC:    1365 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1393, So2/O3(A2)=  2.7658
O3 factor from Bass &amp; Paur to Daumont  =  0.9670 
O3 factor from Bass &amp; Paur to Bremen  =  0.9918 
 1024 WL(A)         3032.05  3063.09  3100.37  3135.16  3168.08  3200.33
      Res(A)          11.18    11.01    10.75    11.05    10.90    10.71
      O3abs(1/cm)    2.5940   1.7784   1.0054   0.6757   0.3750   0.2913 O3:  0.3377
Daumt O3abs(1/cm)    2.6010   1.7735   0.9971   0.6704   0.3681   0.2926 O3:  0.3494
     So2abs(1/cm)    3.4059   5.6763   2.3917   1.8747   1.0564   0.6003
Bremen O3abs(1/cm)    2.6048   1.7763   1.0026   0.6796   0.3733   0.2936 O3:  0.3406
 Nicolet 1e4*Rayabs(1/cm)   5049.7   4831.7   4585.5   4370.1   4178.1   4000.3 R:  9.1600
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.2   4829.7   4585.1   4370.8   4179.7   4002.6 R:  8.7868
 I0(mW m^-2nm^-1)  11668.27  9371.69  7243.66  4886.17  3995.27  3139.09 ETC:    1347 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1354, So2/O3(A2)=  2.7833
O3 factor from Bass &amp; Paur to Daumont  =  0.9664 
O3 factor from Bass &amp; Paur to Bremen  =  0.9913 
 1025 WL(A)         3032.12  3063.17  3100.44  3135.24  3168.15  3200.40
      Res(A)          11.18    11.01    10.75    11.05    10.90    10.71
      O3abs(1/cm)    2.5914   1.7768   1.0052   0.6753   0.3751   0.2907 O3:  0.3365
Daumt O3abs(1/cm)    2.5985   1.7721   0.9967   0.6701   0.3682   0.2921 O3:  0.3483
     So2abs(1/cm)    3.3918   5.6964   2.3994   1.8630   1.0576   0.5979
Bremen O3abs(1/cm)    2.6024   1.7747   1.0023   0.6793   0.3734   0.2931 O3:  0.3394
 Nicolet 1e4*Rayabs(1/cm)   5049.1   4831.2   4585.1   4369.7   4177.7   3999.9 R:  9.1560
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5045.7   4829.2   4584.6   4370.4   4179.3   4002.2 R:  8.7850
 I0(mW m^-2nm^-1)  11662.05  9365.36  7228.02  4882.24  3985.39  3133.63 ETC:    1346 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.7 DU
Ozone offset due to Rayleigh (Bodhaine): -2.9 DU
Ratio Ozone for So2(A3)=  1.1316, So2/O3(A2)=  2.7992
O3 factor from Bass &amp; Paur to Daumont  =  0.9661 
O3 factor from Bass &amp; Paur to Bremen  =  0.9912 
saving powfiu7 to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/dsp_21819_183.183

freecoef =

     4


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9


freecoef =

     9

saving data to file:/Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/dsp_21819_183.183
Use brstps2 to calculate steps and wavelengths
Saving ozonecoeffs to /Users/aredondasm/CODE/rbcce.aemet.es/iberonesia/RBCC_E/2019/../DSP/183_19_219/opos_pow7_21819_183.183
 1015 WL(A)         3031.47  3062.55  3100.05  3134.60  3167.67  3199.75
      Res(A)          11.16    10.99    10.75    11.03    10.92    10.70
      O3abs(1/cm)    2.6148   1.7898   1.0067   0.6781   0.3748   0.2956 O3:  0.3457
Daumt O3abs(1/cm)    2.6216   1.7839   0.9986   0.6715   0.3680   0.2959 O3:  0.3562
     So2abs(1/cm)    3.5408   5.4988   2.3598   1.9666   1.0491   0.6195
Bremen O3abs(1/cm)    2.6248   1.7873   1.0042   0.6811   0.3732   0.2971 O3:  0.3477
 Nicolet 1e4*Rayabs(1/cm)   5053.8   4835.4   4587.6   4373.5   4180.4   4003.4 R:  9.7123
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5050.3   4833.4   4587.1   4374.1   4182.0   4005.7 R:  9.3405
 I0(mW m^-2nm^-1)  11717.61  9419.48  7357.02  4917.42  4054.21  3222.01 ETC:    1456 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1617, So2/O3(A2)=  2.6470
O3 factor from Bass &amp; Paur to Daumont  =  0.9704 
O3 factor from Bass &amp; Paur to Bremen  =  0.9943 
 1016 WL(A)         3031.54  3062.62  3100.12  3134.67  3167.74  3199.82
      Res(A)          11.16    10.99    10.75    11.03    10.92    10.70
      O3abs(1/cm)    2.6119   1.7884   1.0065   0.6779   0.3748   0.2952 O3:  0.3447
Daumt O3abs(1/cm)    2.6189   1.7826   0.9982   0.6715   0.3680   0.2956 O3:  0.3554
     So2abs(1/cm)    3.5216   5.5247   2.3666   1.9551   1.0503   0.6174
Bremen O3abs(1/cm)    2.6222   1.7859   1.0038   0.6810   0.3732   0.2967 O3:  0.3468
 Nicolet 1e4*Rayabs(1/cm)   5053.3   4834.9   4587.1   4373.1   4180.0   4003.0 R:  9.7099
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.8   4832.9   4586.6   4373.7   4181.6   4005.3 R:  9.3357
 I0(mW m^-2nm^-1)  11711.32  9413.08  7331.44  4913.45  4044.21  3212.12 ETC:    1438 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1586, So2/O3(A2)=  2.6659
O3 factor from Bass &amp; Paur to Daumont  =  0.9699 
O3 factor from Bass &amp; Paur to Bremen  =  0.9940 
 1017 WL(A)         3031.62  3062.69  3100.20  3134.75  3167.81  3199.89
      Res(A)          11.16    10.99    10.75    11.03    10.92    10.70
      O3abs(1/cm)    2.6091   1.7869   1.0062   0.6777   0.3749   0.2947 O3:  0.3436
Daumt O3abs(1/cm)    2.6162   1.7813   0.9979   0.6714   0.3680   0.2952 O3:  0.3545
     So2abs(1/cm)    3.5025   5.5500   2.3734   1.9435   1.0516   0.6152
Bremen O3abs(1/cm)    2.6196   1.7845   1.0035   0.6809   0.3732   0.2964 O3:  0.3459
 Nicolet 1e4*Rayabs(1/cm)   5052.8   4834.4   4586.7   4372.6   4179.6   4002.7 R:  9.7076
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5049.3   4832.4   4586.2   4373.3   4181.2   4005.0 R:  9.3336
 I0(mW m^-2nm^-1)  11705.03  9406.69  7306.01  4909.48  4034.24  3202.25 ETC:    1420 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1556, So2/O3(A2)=  2.6845
O3 factor from Bass &amp; Paur to Daumont  =  0.9693 
O3 factor from Bass &amp; Paur to Bremen  =  0.9935 
 1018 WL(A)         3031.69  3062.77  3100.27  3134.82  3167.88  3199.95
      Res(A)          11.16    10.99    10.75    11.03    10.92    10.70
      O3abs(1/cm)    2.6066   1.7854   1.0059   0.6775   0.3749   0.2942 O3:  0.3426
Daumt O3abs(1/cm)    2.6136   1.7799   0.9975   0.6713   0.3680   0.2949 O3:  0.3536
     So2abs(1/cm)    3.4838   5.5753   2.3805   1.9320   1.0528   0.6130
Bremen O3abs(1/cm)    2.6170   1.7831   1.0031   0.6808   0.3732   0.2960 O3:  0.3449
 Nicolet 1e4*Rayabs(1/cm)   5052.2   4833.9   4586.2   4372.2   4179.2   4002.3 R:  9.7052
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.8   4831.9   4585.7   4372.9   4180.8   4004.6 R:  9.3326
 I0(mW m^-2nm^-1)  11698.75  9400.30  7280.72  4905.51  4024.28  3192.40 ETC:    1402 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1525, So2/O3(A2)=  2.7030
O3 factor from Bass &amp; Paur to Daumont  =  0.9689 
O3 factor from Bass &amp; Paur to Bremen  =  0.9933 
 1019 WL(A)         3031.76  3062.84  3100.34  3134.89  3167.95  3200.02
      Res(A)          11.16    10.99    10.75    11.03    10.92    10.70
      O3abs(1/cm)    2.6040   1.7839   1.0056   0.6772   0.3749   0.2938 O3:  0.3416
Daumt O3abs(1/cm)    2.6109   1.7785   0.9972   0.6712   0.3680   0.2945 O3:  0.3526
     So2abs(1/cm)    3.4671   5.5994   2.3881   1.9206   1.0541   0.6108
Bremen O3abs(1/cm)    2.6144   1.7816   1.0028   0.6806   0.3732   0.2956 O3:  0.3439
 Nicolet 1e4*Rayabs(1/cm)   5051.7   4833.4   4585.8   4371.8   4178.8   4001.9 R:  9.7028
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5048.2   4831.4   4585.3   4372.5   4180.4   4004.2 R:  9.3300
 I0(mW m^-2nm^-1)  11692.48  9393.93  7255.58  4901.55  4014.35  3182.58 ETC:    1384 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1493, So2/O3(A2)=  2.7206
O3 factor from Bass &amp; Paur to Daumont  =  0.9686 
O3 factor from Bass &amp; Paur to Bremen  =  0.9931 
 1020 WL(A)         3031.84  3062.91  3100.41  3134.96  3168.02  3200.09
      Res(A)          11.16    10.99    10.75    11.03    10.92    10.70
      O3abs(1/cm)    2.6015   1.7824   1.0053   0.6769   0.3750   0.2933 O3:  0.3405
Daumt O3abs(1/cm)    2.6083   1.7772   0.9969   0.6710   0.3681   0.2941 O3:  0.3516
     So2abs(1/cm)    3.4504   5.6223   2.3957   1.9089   1.0553   0.6086
Bremen O3abs(1/cm)    2.6119   1.7801   1.0025   0.6804   0.3733   0.2952 O3:  0.3429
 Nicolet 1e4*Rayabs(1/cm)   5051.2   4832.9   4585.3   4371.4   4178.4   4001.6 R:  9.7004
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.7   4830.9   4584.8   4372.0   4180.0   4003.8 R:  9.3270
 I0(mW m^-2nm^-1)  11686.23  9387.56  7235.49  4897.59  4004.43  3172.77 ETC:    1371 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.8 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1460, So2/O3(A2)=  2.7376
O3 factor from Bass &amp; Paur to Daumont  =  0.9683 
O3 factor from Bass &amp; Paur to Bremen  =  0.9930 
 1021 WL(A)         3031.91  3062.98  3100.48  3135.03  3168.09  3200.16
      Res(A)          11.16    10.99    10.74    11.03    10.92    10.70
      O3abs(1/cm)    2.5990   1.7809   1.0050   0.6766   0.3750   0.2928 O3:  0.3394
Daumt O3abs(1/cm)    2.6057   1.7758   0.9966   0.6708   0.3681   0.2937 O3:  0.3506
     So2abs(1/cm)    3.4337   5.6443   2.4033   1.8972   1.0565   0.6063
Bremen O3abs(1/cm)    2.6094   1.7786   1.0021   0.6802   0.3734   0.2948 O3:  0.3418
 Nicolet 1e4*Rayabs(1/cm)   5050.7   4832.4   4584.8   4370.9   4178.0   4001.2 R:  9.6981
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5047.2   4830.4   4584.4   4371.6   4179.6   4003.5 R:  9.3254
 I0(mW m^-2nm^-1)  11679.98  9381.20  7220.14  4893.63  3994.55  3162.99 ETC:    1362 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.9 DU
Ozone offset due to Rayleigh (Bodhaine): -3.0 DU
Ratio Ozone for So2(A3)=  1.1427, So2/O3(A2)=  2.7541
O3 factor from Bass &amp; Paur to Daumont  =  0.9682 
O3 factor from Bass &amp; Paur to Bremen  =  0.9930 
 1022 WL(A)         3031.98  3063.05  3100.55  3135.10  3168.16  3200.23
      Res(A)          11.16    10.99    10.74    11.03    10.92    10.70
      O3abs(1/cm)    2.5963   1.7793   1.0048   0.6762   0.3751   0.2922 O3:  0.3382
Daumt O3abs(1/cm)    2.6031   1.7743   0.9962   0.6706   0.3682   0.2933 O3:  0.3495
     So2abs(1/cm)    3.4174   5.6663   2.4112   1.8854   1.0577   0.6039
Bremen O3abs(1/cm)    2.6069   1.7771   1.0018   0.6799   0.3734   0.2943 O3:  0.3407
 Nicolet 1e4*Rayabs(1/cm)   5050.1   4831.9   4584.4   4370.5   4177.6   4000.8 R:  9.6957
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.7   4829.9   4583.9   4371.2   4179.2   4003.1 R:  9.3244
 I0(mW m^-2nm^-1)  11673.73  9374.86  7205.24  4889.68  3984.68  3153.23 ETC:    1355 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.9 DU
Ozone offset due to Rayleigh (Bodhaine): -3.1 DU
Ratio Ozone for So2(A3)=  1.1389, So2/O3(A2)=  2.7714
O3 factor from Bass &amp; Paur to Daumont  =  0.9678 
O3 factor from Bass &amp; Paur to Bremen  =  0.9928 
 1023 WL(A)         3032.06  3063.13  3100.62  3135.17  3168.23  3200.30
      Res(A)          11.16    10.99    10.74    11.03    10.92    10.70
      O3abs(1/cm)    2.5936   1.7777   1.0045   0.6757   0.3752   0.2916 O3:  0.3370
Daumt O3abs(1/cm)    2.6006   1.7729   0.9959   0.6704   0.3683   0.2928 O3:  0.3483
     So2abs(1/cm)    3.4032   5.6874   2.4195   1.8739   1.0589   0.6015
Bremen O3abs(1/cm)    2.6045   1.7756   1.0015   0.6796   0.3735   0.2939 O3:  0.3395
 Nicolet 1e4*Rayabs(1/cm)   5049.6   4831.4   4583.9   4370.1   4177.2   4000.4 R:  9.6933
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5046.1   4829.5   4583.5   4370.8   4178.8   4002.7 R:  9.3203
 I0(mW m^-2nm^-1)  11667.50  9368.52  7190.76  4885.73  3974.83  3143.49 ETC:    1347 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.9 DU
Ozone offset due to Rayleigh (Bodhaine): -3.1 DU
Ratio Ozone for So2(A3)=  1.1351, So2/O3(A2)=  2.7884
O3 factor from Bass &amp; Paur to Daumont  =  0.9674 
O3 factor from Bass &amp; Paur to Bremen  =  0.9925 
 1024 WL(A)         3032.13  3063.20  3100.70  3135.24  3168.30  3200.37
      Res(A)          11.16    10.99    10.74    11.03    10.92    10.70
      O3abs(1/cm)    2.5911   1.7761   1.0042   0.6753   0.3753   0.2910 O3:  0.3356
Daumt O3abs(1/cm)    2.5981   1.7714   0.9956   0.6702   0.3683   0.2924 O3:  0.3471
     So2abs(1/cm)    3.3891   5.7071   2.4279   1.8622   1.0600   0.5991
Bremen O3abs(1/cm)    2.6021   1.7740   1.0012   0.6793   0.3736   0.2934 O3:  0.3383
 Nicolet 1e4*Rayabs(1/cm)   5049.1   4830.9   4583.5   4369.7   4176.9   4000.1 R:  9.6910
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5045.6   4829.0   4583.0   4370.3   4178.4   4002.4 R:  9.3186
 I0(mW m^-2nm^-1)  11661.28  9362.19  7176.68  4881.78  3965.01  3135.47 ETC:    1343 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.9 DU
Ozone offset due to Rayleigh (Bodhaine): -3.1 DU
Ratio Ozone for So2(A3)=  1.1311, So2/O3(A2)=  2.8044
O3 factor from Bass &amp; Paur to Daumont  =  0.9668 
O3 factor from Bass &amp; Paur to Bremen  =  0.9921 
 1025 WL(A)         3032.20  3063.27  3100.77  3135.31  3168.37  3200.44
      Res(A)          11.16    10.99    10.74    11.03    10.92    10.70
      O3abs(1/cm)    2.5887   1.7745   1.0039   0.6749   0.3754   0.2904 O3:  0.3344
Daumt O3abs(1/cm)    2.5956   1.7699   0.9952   0.6699   0.3684   0.2919 O3:  0.3459
     So2abs(1/cm)    3.3749   5.7257   2.4364   1.8504   1.0612   0.5967
Bremen O3abs(1/cm)    2.5997   1.7724   1.0008   0.6790   0.3737   0.2929 O3:  0.3371
 Nicolet 1e4*Rayabs(1/cm)   5048.5   4830.4   4583.0   4369.2   4176.5   3999.7 R:  9.6886
Bates(fix)  1e4*Rayabs(1/cm)      0.0   4870.0   4620.0   4410.0   4220.0   4040.0 R: -1.0000
Bodhaine  1e4*Rayabs(1/cm)   5045.1   4828.5   4582.6   4369.9   4178.0   4002.0 R:  9.3168
 I0(mW m^-2nm^-1)  11655.06  9355.87  7159.76  4877.83  3955.21  3132.20 ETC:    1344 
Ozone offset due to Rayleigh  (RayCOeff/O3Coeff): -2.9 DU
Ozone offset due to Rayleigh (Bodhaine): -3.1 DU
Ratio Ozone for So2(A3)=  1.1273, So2/O3(A2)=  2.8193
O3 factor from Bass &amp; Paur to Daumont  =  0.9666 
O3 factor from Bass &amp; Paur to Bremen  =  0.9920 

dsp_sum = 

  struct with fields:

       day: 177
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 203
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 219
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 252
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 331
      year: 15
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 8
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 44
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 64
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 105
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 133
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 159
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 168
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 210
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 237
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 250
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 293
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 323
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 364
      year: 16
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 12
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 40
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 62
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 95
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 120
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 137
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 167
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 187
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 235
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 270
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 290
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 354
      year: 17
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 25
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 31
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 68
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 106
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 143
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 178
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 200
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 254
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 306
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 331
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 354
      year: 18
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 24
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 41
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 57
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 75
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 108
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 141
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 193
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]


dsp_sum = 

  struct with fields:

       day: 219
      year: 19
    brewnb: 183
       cfg: [52&times;1 double]
       uvr: []
       res: [15&times;9&times;2 double]
    detail: [7&times;6&times;15&times;2 double]
    salida: [1&times;1 struct]

index =0 will be an error if you use for matrix asigment

DSP  week Analysis

DSP Analysis
                                     |        CSN |       wl_0 |       wl_2 |       wl_3 |       wl_4 |       wl_5 |     fwhm_6 |   A1 quad. |        std |   A1 cubic |        std |          N |  RayleighB |  RayleighN |  Aq_Bremen |  Ac_Bremen |      SO2_q |      SO2_c
                         "SL replc." |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN
                            "IOS 15" |  1020.0000 |  3031.9130 |  3062.9556 |  3100.4504 |  3135.0075 |  3168.0308 |  3200.1068 |     0.3402 |     0.0004 |     0.3405 |     0.0003 |     4.0000 |     1.0302 |     0.9602 |     0.3428 |     0.3430 |     3.1132 |     3.1426
                        "Lab  1000W" |  1020.0000 |  3031.8804 |  3062.9404 |  3100.4369 |  3134.9816 |  3168.0101 |  3200.0687 |     0.3406 |     0.0009 |     0.3411 |     0.0006 |     3.0000 |     0.9950 |     0.9699 |     0.3431 |     0.3436 |     3.1043 |     3.1427
                             "Storm" |  1020.0000 |  3031.9362 |  3062.9938 |  3100.4386 |  3135.0189 |  3168.0364 |  3200.1082 |     0.3402 |     0.0000 |     0.3406 |     0.0000 |     1.0000 |     1.1012 |     0.9767 |     0.3427 |     0.3430 |     3.1219 |     3.1567
           " Kipp&amp;Zonen maintenance" |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN
                         "Lab 1000W" |  1020.0000 |  3031.9546 |  3063.0016 |  3100.5009 |  3135.0490 |  3168.0554 |  3200.1343 |     0.3398 |     0.0004 |     0.3401 |     0.0004 |     4.0000 |     1.0162 |     0.9459 |     0.3422 |     0.3425 |     3.1098 |     3.1491
                    "SL replacement" |  1020.0000 |  3031.9572 |  3063.0001 |  3100.5118 |  3135.0588 |  3168.0884 |  3200.1503 |     0.3394 |     0.0004 |     0.3396 |     0.0002 |     5.0000 |     0.9952 |     0.9685 |     0.3418 |     0.3420 |     3.1160 |     3.1445
                       "Bad weather" |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN
                          "183 Roof" |  1020.0000 |  3031.9306 |  3062.9760 |  3100.4714 |  3135.0161 |  3168.0378 |  3200.1099 |     0.3403 |     0.0003 |     0.3405 |     0.0004 |     3.0000 |     1.0437 |     0.9552 |     0.3428 |     0.3429 |     3.1180 |     3.1480
                          "183 Roof" |  1020.0000 |  3031.8930 |  3062.9693 |  3100.4674 |  3134.9990 |  3168.0089 |  3200.1048 |     0.3402 |     0.0000 |     0.3406 |     0.0000 |     1.0000 |     0.9619 |     0.9213 |     0.3427 |     0.3430 |     3.1183 |     3.1435
                      "Kipp &amp; Zonen" |  1020.0000 |  3031.8802 |  3062.9222 |  3100.4080 |  3134.9786 |  3168.0116 |  3200.0828 |     0.3408 |     0.0003 |     0.3407 |     0.0004 |     8.0000 |     1.0572 |     0.9764 |     0.3433 |     0.3432 |     3.1177 |     3.1401
              "HV jump  1545--&gt;1533" |  1020.0000 |  3031.8713 |  3062.9203 |  3100.4009 |  3134.9653 |  3167.9707 |  3200.0604 |     0.3408 |     0.0000 |     0.3411 |     0.0000 |     1.0000 |     1.0557 |     0.9465 |     0.3433 |     0.3434 |     3.1098 |     3.1430
"Bad weather.HV back original value" |  1020.0000 |  3031.9063 |  3062.9599 |  3100.4690 |  3135.0143 |  3168.0440 |  3200.1234 |     0.3405 |     0.0002 |     0.3401 |     0.0004 |     2.0000 |     1.0025 |     0.9516 |     0.3429 |     0.3424 |     3.1284 |     3.1459
                       "Bad weather" |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN |        NaN
                          "183 roof" |  1020.0000 |  3031.9307 |  3062.9908 |  3100.4686 |  3135.0418 |  3168.0790 |  3200.1212 |     0.3404 |     0.0004 |     0.3403 |     0.0001 |     2.0000 |     1.0818 |     1.0057 |     0.3429 |     0.3427 |     3.1215 |     3.1510
                    "SL replacement" |  1020.0000 |  3031.9209 |  3062.9688 |  3100.4715 |  3135.0302 |  3168.0738 |  3200.1418 |     0.3399 |     0.0006 |     0.3399 |     0.0005 |     4.0000 |     1.0175 |     0.9753 |     0.3424 |     0.3424 |     3.1164 |     3.1426
                  "Sof back to 3.77" |  1020.0000 |  3031.8871 |  3062.9540 |  3100.4448 |  3134.9987 |  3168.0582 |  3200.0924 |     0.3413 |     0.0011 |     0.3404 |     0.0004 |     8.0000 |     1.0001 |     1.0084 |     0.3437 |     0.3429 |     3.1389 |     3.1478
                       "Maintenance" |  1020.0000 |  3031.8822 |  3062.9656 |  3100.4352 |  3134.9962 |  3168.0652 |  3200.0954 |     0.3411 |     0.0000 |     0.3404 |     0.0000 |     1.0000 |     0.9876 |     1.0198 |     0.3435 |     0.3429 |     3.1381 |     3.1552
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_37.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_38.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_39.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_40.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_41.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_42.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_43.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_44.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_45.png" alt=""> <img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_46.png" alt=""> <h2 id="26">Historic</h2><pre class="codeinput">figure; set(gcf,<span class="string">'Tag'</span>,strcat(<span class="string">'DSP_A1_HIST'</span>,Cal.brw_str{Cal.n_inst}));
tabla_dsp.data(isnan(tabla_dsp.data(:,2)),:)=[];
l1=ploty(tabla_dsp.data(:,[1 15 17]),<span class="string">'s'</span>);
set(l1(1),<span class="string">'Marker'</span>,<span class="string">'s'</span>,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'Color'</span>,<span class="string">'k'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>);
set(l1(2),<span class="string">'Marker'</span>,<span class="string">'s'</span>,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'Color'</span>,<span class="string">'g'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
lim=get(gca,<span class="string">'XLim'</span>); set(gca,<span class="string">'YLim'</span>,[0.3360 0.3435],<span class="string">'XLim'</span>,[lim(1)-10 lim(2)+10]);
hold <span class="string">on</span>; s(2)=stairs([events_cfg_chk.data(1,:) tabla_dsp.data(end,1)],[events_cfg_chk.data(7,:) events_cfg_chk.data(7,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
         s(1)=stairs([events_cfg_op.data(1,:) tabla_dsp.data(end,1)],[events_cfg_op.data(7,:) events_cfg_op.data(7,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,2);
vl=vline_v(events_cfg_op.data(1,:),<span class="string">'-r'</span>,Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))&gt;=events_cfg_op.data(1,1),3));
set(vl,<span class="string">'LineStyle'</span>,<span class="string">'None'</span>); set(findobj(gca,<span class="string">'Type'</span>,<span class="string">'text'</span>),<span class="string">'FontSize'</span>,7);
title(sprintf(<span class="string">'A1: %s'</span>,Cal.brw_name{Cal.n_inst}));
datetick(<span class="string">'x'</span>,12,<span class="string">'KeepLimits'</span>,<span class="string">'keepTicks'</span>); ylabel(<span class="string">'Ozone Absorption Coefficient (A1)'</span>); grid
legendflex([l1;s(1);s(2)],{<span class="string">'A1 Quad'</span>,<span class="string">'A1 Cubic'</span>,<span class="string">'A1 ref (Op)'</span>,<span class="string">'A1 ref (Chk)'</span>}, <span class="keyword">...</span>
                           <span class="string">'anchor'</span>, {<span class="string">'sw'</span>,<span class="string">'sw'</span>}, <span class="string">'buffer'</span>,[10 -5], <span class="string">'nrow'</span>,2,<span class="string">'fontsize'</span>,8,<span class="string">'box'</span>,<span class="string">'on'</span>);
set(findobj(gcf,<span class="string">'Type'</span>,<span class="string">'text'</span>),<span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>);

printfiles_report(gcf,Cal.dir_figs,<span class="string">'Width'</span>,21,<span class="string">'Height'</span>,9,<span class="string">'LineMode'</span>,<span class="string">'Scaled'</span>);
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_47.png" alt=""> <pre class="codeinput">figure;
set(gcf,<span class="string">'Tag'</span>,strcat(<span class="string">'DSP_A1'</span>,Cal.brw_str{Cal.n_inst}));
tabla_dsp.data(isnan(tabla_dsp.data(:,2)),:)=[];
l1=ploty(tabla_dsp.data(:,[1 15 17]),<span class="string">'s'</span>);
set(l1(1),<span class="string">'Marker'</span>,<span class="string">'s'</span>,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'Color'</span>,<span class="string">'k'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>);
set(l1(2),<span class="string">'Marker'</span>,<span class="string">'s'</span>,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'Color'</span>,<span class="string">'g'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
lim=get(gca,<span class="string">'XLim'</span>);
set(gca,<span class="string">'YLim'</span>,[0.3360 0.3435],<span class="string">'XLim'</span>,[lim(1)-10 lim(2)+10]);
hold <span class="string">on</span>;
s(2)=stairs([events_cfg_chk.data(1,:) tabla_dsp.data(end,1)],[events_cfg_chk.data(7,:) events_cfg_chk.data(7,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
 s(1)=stairs([events_cfg_op.data(1,:) tabla_dsp.data(end,1)],[events_cfg_op.data(7,:) events_cfg_op.data(7,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,2);

<span class="comment">%vl=vline_v(events_cfg_op.data(1,:),'-r',Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))&gt;=events_cfg_op.data(1,1),3));</span>
<span class="comment">%set(vl,'LineStyle','None'); set(findobj(gca,'Type','text'),'FontSize',7);</span>

title(sprintf(<span class="string">'A1: %s'</span>,Cal.brw_name{Cal.n_inst}));
datetick(<span class="string">'x'</span>,12,<span class="string">'KeepLimits'</span>,<span class="string">'keepTicks'</span>); ylabel(<span class="string">'Ozone Absorption Coefficient (A1)'</span>); grid
legendflex([l1;s(1);s(2)],{<span class="string">'A1 Quad'</span>,<span class="string">'A1 Cubic'</span>,<span class="string">'A1 ref (Op)'</span>,<span class="string">'A1 ref (Chk)'</span>}, <span class="keyword">...</span>
                           <span class="string">'anchor'</span>, {<span class="string">'sw'</span>,<span class="string">'sw'</span>}, <span class="string">'buffer'</span>,[10 -5], <span class="string">'nrow'</span>,2,<span class="string">'fontsize'</span>,12,<span class="string">'box'</span>,<span class="string">'off'</span>);
set(findobj(gcf,<span class="string">'Type'</span>,<span class="string">'text'</span>),<span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>);

printfiles_report(gcf,Cal.dir_figs,<span class="string">'Width'</span>,14,<span class="string">'Height'</span>,7,<span class="string">'LineMode'</span>,<span class="string">'Scaled'</span>);
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_48.png" alt=""> <pre class="codeinput">fprintf(<span class="string">'\r\nDSP Analysis\r\n'</span>);
jn=~isnan(tabla_dsp.data(:,2));
<span class="comment">% if any(jnan)</span>
<span class="comment">% tabla_dsp.data(jnan,:)=[];</span>
<span class="comment">% tabla_~dsp.events(jnan)=[];</span>
<span class="comment">% end</span>
dsp_table=array2table(tabla_dsp.data(jn,1:end),<span class="string">'VariableNames'</span>,varname(tabla_dsp.data_lbl),<span class="string">'Rownames'</span>,varname(tabla_dsp.events(jn)));
dsp_table.Date=datetime(datestr(tabla_dsp.data(:,1)));

t_dsp_183=display_table(tabla_dsp.data(jn,[1,2 15,17]),tabla_dsp.data_lbl([1,2 15,17]),10,<span class="string">'.4f'</span>,tabla_dsp.events(jn))


matrix2latex_ctable(tabla_dsp.data(jn,15:end),fullfile(Cal.file_latex,[<span class="string">'table_dsp_'</span>,Cal.brw_str{Cal.n_inst},<span class="string">'.tex'</span>]),<span class="keyword">...</span>
                                    <span class="string">'rowlabels'</span>,tabla_dsp.events,<span class="string">'columnlabels'</span>,tabla_dsp.data_lbl(14:end),<span class="keyword">...</span>
                                    <span class="string">'alignment'</span>,<span class="string">'c'</span>,<span class="string">'resize'</span>,0.9);
</pre><pre class="codeoutput">
DSP Analysis

t_dsp_183 =

  14&times;4 table

                                            Date       CSN     A1Quad_    A1Cubic
                                         __________    ____    _______    _______

    x_SLReplc__                          7.3612e+05    1020    0.34024    0.34053
    x_IOS15_                             7.3623e+05    1020    0.34056    0.34109
    x_Lab1000W_                          7.3638e+05    1020    0.34023    0.34057
    x_Storm_                             7.3641e+05    1020    0.33978    0.34011
    x_Kipp_ZonenMaintenance_             7.3652e+05    1020    0.33938    0.33962
    x_Lab1000W__1                        7.3667e+05    1020    0.34029     0.3405
    x_SLReplacement_                     7.3674e+05    1020    0.34016    0.34057
    x_BadWeather_                        7.3676e+05    1020    0.34084    0.34075
    x_183Roof_                           7.3700e+05    1020    0.34084    0.34105
    x_183Roof__1                         7.3707e+05    1020    0.34053    0.34006
    x_Kipp_Zonen_                        7.3712e+05    1020     0.3404    0.34026
    x_HVJump1545___1533_                 7.3718e+05    1020    0.33991    0.33991
    x_BadWeather_HVBackOriginalValue_    7.3736e+05    1020    0.34133    0.34045
    x_BadWeather__1                      7.3754e+05    1020    0.34113    0.34042

</pre><pre class="codeinput">figure;
set(gcf,<span class="string">'Tag'</span>,<span class="string">'DSP_A1_AVG'</span>)
l1=ploty(tabla_dsp.data(:,[1 15 17]),<span class="string">'s'</span>);
hold <span class="string">all</span>
errorbar(tabla_dsp.data(:,1),tabla_dsp.data(:,15),tabla_dsp.data(:,16));
errorbar(tabla_dsp.data(:,1),tabla_dsp.data(:,17),tabla_dsp.data(:,18));
set(l1(1),<span class="string">'Marker'</span>,<span class="string">'s'</span>,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'Color'</span>,<span class="string">'k'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'k'</span>);
set(l1(2),<span class="string">'Marker'</span>,<span class="string">'s'</span>,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'Color'</span>,<span class="string">'g'</span>,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);
lim=get(gca,<span class="string">'XLim'</span>);
set(gca,<span class="string">'YLim'</span>,[0.3360 0.3435],<span class="string">'XLim'</span>,[lim(1)-10 lim(2)+10]);
vline_v(event_info.dates,<span class="string">'r'</span>,event_info.labels)
hold <span class="string">on</span>;
s(2)=stairs([events_cfg_chk.data(1,:) tabla_dsp.data(end,1)],[events_cfg_chk.data(7,:) events_cfg_chk.data(7,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'m'</span>,<span class="string">'LineWidth'</span>,2);
s(1)=stairs([events_cfg_op.data(1,:) tabla_dsp.data(end,1)],[events_cfg_op.data(7,:) events_cfg_op.data(7,end)],<span class="string">'-'</span>,<span class="string">'color'</span>,<span class="string">'b'</span>,<span class="string">'LineWidth'</span>,2);

<span class="comment">%vl=vline_v(events_cfg_op.data(1,:),'-r',Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))&gt;=events_cfg_op.data(1,1),3));</span>
<span class="comment">%set(vl,'LineStyle','None'); set(findobj(gca,'Type','text'),'FontSize',7);</span>

title(sprintf(<span class="string">'A1: %s'</span>,Cal.brw_name{Cal.n_inst}));
datetick(<span class="string">'x'</span>,12,<span class="string">'KeepLimits'</span>,<span class="string">'keepTicks'</span>); ylabel(<span class="string">'Ozone Absorption Coefficient (A1)'</span>); grid
set(findobj(gcf,<span class="string">'Type'</span>,<span class="string">'text'</span>),<span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>);
m183=nanmean(tabla_dsp.data(:,[15,17]));
hline(m183(1),<span class="string">'k'</span>,sprintf(<span class="string">'quad=%.4f '</span>,m183(1)))
hline(m183(2),<span class="string">'g'</span>,sprintf(<span class="string">' cubic=%.4f'</span>,m183(2)))
legendflex([l1;s(1);s(2)],{<span class="string">'A1 Quad'</span>,<span class="string">'A1 Cubic'</span>,<span class="string">'A1 ref (Op)'</span>,<span class="string">'A1 ref (Chk)'</span>}, <span class="keyword">...</span>
       <span class="string">'anchor'</span>, {<span class="string">'sw'</span>,<span class="string">'sw'</span>}, <span class="string">'buffer'</span>,[15 15], <span class="string">'nrow'</span>,2,<span class="string">'fontsize'</span>,12,<span class="string">'box'</span>,<span class="string">'off'</span>);
</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_49.png" alt=""> <pre class="codeinput">figure
set(gcf,<span class="string">'Tag'</span>,<span class="string">'DSP_A1_RES'</span>)
mq=mean_smooth_abs(tabla_dsp.data(:,1),tabla_dsp.data(:,[15]),90,0);
mc=mean_smooth_abs(tabla_dsp.data(:,1),tabla_dsp.data(:,[17]),90,0);
hold <span class="string">on</span>
m183=nanmean(tabla_dsp.data(:,[15,17]))
s183=nanstd(tabla_dsp.data(:,[15,17]))

plot(tabla_dsp.data(:,1),(mq(:,1)-m183(1))/0.001)
hold <span class="string">on</span>
plot(tabla_dsp.data(:,1),(mc(:,1)-m183(2))/0.001)
legend({<span class="string">'cuadratic'</span>,<span class="string">'cubic'</span>})
plot(tabla_dsp.data(:,1),(tabla_dsp.data(:,15)-m183(1))/0.001,<span class="string">'k+'</span>)
hold <span class="string">on</span>
plot(tabla_dsp.data(:,1),(tabla_dsp.data(:,17)-m183(2))/0.001,<span class="string">'bx'</span>)

datetick(<span class="string">'x'</span>,<span class="string">'mmm/yy'</span>,<span class="string">'keepticks'</span>)
grid <span class="string">on</span>
ylabel(<span class="string">'Micromenter step'</span>)
title({<span class="string">'Brewer  #183 Ozone Abs coeff diff vs mean'</span>,sprintf(<span class="string">'quad=%.4f cubic=%.4f'</span>,m183)})
box <span class="string">on</span>
set(gca,<span class="string">'YLim'</span>,[-2 2])
vline_v(event_info.dates,<span class="string">'k'</span>,event_info.labels);
hfill([-0.5,0.5],<span class="string">'grey'</span>)
</pre><pre class="codeoutput">
m183 =

    0.3404    0.3404


s183 =

   1.0e-03 *

    0.5268    0.4086

</pre><img vspace="5" hspace="5" src="Inst_Wl183_2016_2019_50.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div><!--
##### SOURCE BEGIN #####
% options_pub=struct('outputDir',fullfile('..','html'),'showCode',true); 
% close all; publish(fullfile(pwd,'Inst_Wl183.m'),options_pub);

%% Brewer Evaluation
clear all; 
file_setup='calizo_setup'; 
run(fullfile('..',file_setup));     % configuracion por defecto

Cal.n_inst=find(Cal.brw==183); 
Cal.Date.CALC_DAYS=datenum(2015,6,1):now;

OP_config =Cal.brw_config_files{Cal.n_inst,1};
ALT_config=Cal.brw_config_files{Cal.n_inst,2};

Cal.file_latex = fullfile('..','latex');
Cal.dir_figs   = fullfile(Cal.file_latex,filesep(),'figures');
mkdir(Cal.dir_figs);

%% Configs: Operative
[a b c]=fileparts(OP_config);
try
   if ~strcmpi(strcat(b,c),sprintf('config%d.cfg',Cal.brw(Cal.n_inst)))
      fprintf(strcat(1,'\rCUIDADO!! Puede que las configuraciones cargadas no sean las esperadas\n',...
                       '(Expected: %s, Loading: %s)\n'),...
              sprintf('config%d.cfg',Cal.brw(Cal.n_inst)),strcat(b,c)); 
   end
   events_cfg_op=getcfgs(Cal.Date.CALC_DAYS,OP_config);    
   fprintf('\nBrewer %s: Operative Config.\n',Cal.brw_name{Cal.n_inst});
   displaytable(events_cfg_op.data(2:end,:),cellstr(datestr(events_cfg_op.data(1,:),1))',12,'.5g',events_cfg_op.legend(2:end));
catch exception
   fprintf('%s, brewer: %s\n',exception.message,Cal.brw_str{Cal.n_inst});
end
matrix2latex_config(events_cfg_op.data(2:end,:),fullfile(Cal.file_latex,['Op_config_',Cal.brw_str{Cal.n_inst},'.tex']),...
                    'rowlabels',events_cfg_op.legend(2:end),'columnlabels',cellstr(datestr(events_cfg_op.data(1,:),1))',...
                    'size','footnotesize');
                
[c,ia]=unique(events_cfg_op.data(2:end,:)','rows','stable');               
tableop_183=array2table(c,'VariableNames',str2name(events_cfg_op.legend(2:end)));                
tableop_183.Date=datetime(datestr(events_cfg_op.data(1,ia)));                
tableop_183=tableop_183(:,[end,1:end-1])
%% Configs: Check
[a b c]=fileparts(ALT_config);
try
   if ~strcmpi(strcat(b,c),sprintf('config%d_a.cfg',Cal.brw(Cal.n_inst)))
      fprintf(strcat(1,'\rCUIDADO!! Puede que las configuraciones cargadas no sean las esperadas\n',...
                       '(Expected: %s, Loading: %s)\n'),...
              sprintf('config%d_a.cfg',Cal.brw(Cal.n_inst)),strcat(b,c)); 
   end    
   events_cfg_chk=getcfgs(Cal.Date.CALC_DAYS,ALT_config);    
   fprintf('\nBrewer %s: Second Config.\n',Cal.brw_name{Cal.n_inst});
   displaytable(events_cfg_chk.data(2:end,:),cellstr(datestr(events_cfg_chk.data(1,:),1))',12,'.5g',events_cfg_chk.legend(2:end));
catch exception
   fprintf('%s, brewer: %s\n',exception.message,Cal.brw_str{Cal.n_inst});
end
matrix2latex_config(events_cfg_chk.data(2:end,:),fullfile(Cal.file_latex,['Chk_config_',Cal.brw_str{Cal.n_inst},'.tex']),...
                    'rowlabels',events_cfg_chk.legend(2:end),'columnlabels',cellstr(datestr(events_cfg_chk.data(1,:),1))',...
                    'size','footnotesize');
                
[c,ia]=unique(events_cfg_chk.data(2:end,:)','rows','stable')               
tablec_183=array2table(c,'VariableNames',str2name(events_cfg_op.legend(2:end)))                
tablec_183.Date=datetime(datestr(events_cfg_op.data(1,ia)));                
tablec_183=tablec_183(:,[end,1:end-1])                
                
%%
%%  EVENTOS               
event_info=getevents(Cal,'gr','events');


matrix2latex_ctable(cellstr(datestr(event_info.dates)),fullfile(Cal.file_latex,['table_events_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                   'rowlabels',event_info.labels','columnlabels',{'DATE'},...
                                   'alignment','c','resize',0.9);


event_info.labels
cellstr(datestr(event_info.dates))'

t_events=display_table(event_info.labels',{'events'},30,'%f',cellstr(datestr(event_info.dates))');

%%eventos importantes-> SELECCIONAMOS LOS IMPORTANTES<-
ev=table();
ev.label=event_info.labels';
ev.dates=datetime(datestr(event_info.dates))
events_table=ev;


event_info.labels=event_info.labels;
event_info.dates=event_info.dates;


% event_info.labels=event_info.labels(4:end);
% event_info.dates=event_info.dates(4:end);
 displaytable(event_info.labels',{'events'},30,'%f',cellstr(datestr(event_info.dates))');                


                
               

%% Historical review AVG info
close all; 
[tabla_avg,sl_data,dt_data,rs_data,ap_data ]=report_avg(Cal,'grp','events','outlier_flag',{'sl','','','','','',''});      

f=figure(findobj('Tag','SLAVG_F5'));
vline_v(event_info.dates,'k',event_info.labels)
hold all;

f=figure(findobj('Tag','SLAVG_R6'));
vline_v(event_info.dates,'k',event_info.labels)
 set(gca,'YLim',median(events_cfg_op.data(17,:))+[-30,30])
hold all;
s(1)=stairs([events_cfg_op.data(1,:) sl_data(end,1)],[events_cfg_op.data(17,:) events_cfg_op.data(17,end)],'-','color','m','LineWidth',2);
hold on
s(2)=stairs([events_cfg_chk.data(1,:) sl_data(end,1)],[events_cfg_chk.data(17,:) events_cfg_chk.data(17,end)],'-','color','k','LineWidth',2);
legend(s,{'R6 ref (Op)','R6 ref (Chk)'},'Location','NorthEast');

f=figure(maxf(findobj('tag','SLAVG_R6')));
Width=36; Height=12;
R6tag=[Cal.brw_str{Cal.n_inst},'_',get(f,'tag')];
set(f,'tag',R6tag)
ylim([320 400])

f=figure(maxf(findobj('tag','DTAVG')));
hold on
try
 [a,b]=findchangepts(rmmissing(dt_data(:,5)),'MinThreshold', 1700,'MinDistance',7,'Statistic','mean');
 
 vline_v(datenum(dt_data(a,1)),'r',cellstr(datestr(dt_data(a,1))))
catch
    disp('signal');
end


printfiles_report(f,Cal.dir_figs,'Width',Width,'Height',Height);
                           
%%
table_avg_183=array2table(tabla_avg.data,'VariableNames',str2name(['fecha',tabla_avg.data_lbl]));               
table_avg_183.Date=datetime(datestr(tabla_avg.data(:,1)));   
table_avg_183.Properties.RowNames=varname(tabla_avg.events);   
table_avg_183=table_avg_183(:,[end,1:end-1])      
try
  rows2vars(table_avg_183)
catch
  disp('transpose');
end

input.data=table_avg_183(:,2:end); %(solo los nmeros,quitamos las fechas()
input.transposeTable = 1;
input.tableCaption = 'Brewer #156 average table';
latex_avg = latexTable(input);
cellwrite('table_avg_183.tex',latex_avg);
writetable(table_avg_183,'table_avg_183.xls')


%%
 figure(findobj('Tag','SLAVG_F5'));
 vline_v(event_info.dates,'k',event_info.labels)
 
%%

figure(findobj('-regexp','Tag',R6tag));
vline_v(event_info.dates,'k',event_info.labels)

try
 [a,b]=findchangepts(rmmissing(sl_data(:,12)),'MinThreshold', 50,'MinDistance',7,'Statistic','mean') 
 vline_v(datenum(sl_data(a,1)),'r',cellstr(datestr(sl_data(a,1))))
catch
    disp('need signal');
end 

%%
  figure
  plot(ap_data(:,1),ap_data(:,6),'x')
  vline_v(event_info.dates,'r',event_info.labels)
  datetick('x','yy/mmm')
  ylabel('Amps');
  title('SL lamp Intesity');
%% DT
figure
mdt=meanmonth(dt_data,12);
hold on
shadedErrorBar(mdt.media(:,1),mdt.media(:,8),mdt.sigma(:,8),'r',1)
shadedErrorBar(mdt.media(:,1),mdt.media(:,7),mdt.sigma(:,7),'b',1)
datetick('x',12,'Keeplimits','Keepticks');
gx=get(gca,'XLim');
hold all;

%DT table

  dt_op=[[events_cfg_op.data(1,:) dt_data(end,1)];1E9*[events_cfg_op.data(9,:) events_cfg_op.data(9,end)]]';
  dt_alt=[[events_cfg_chk.data(1,:) dt_data(end,1)];1E9*[events_cfg_chk.data(9,:) events_cfg_chk.data(9,end)]]';
  

s(1)=stairs([events_cfg_op.data(1,:) dt_data(end,1)],1E9*[events_cfg_op.data(9,:) events_cfg_op.data(9,end)],'-','color','m','LineWidth',2);
hold on
s(2)=stairs([events_cfg_chk.data(1,:) dt_data(end,1)],1E9*[events_cfg_chk.data(9,:) events_cfg_chk.data(9,end)],'-','color','k','LineWidth',2);
legend(s,{'DT ref (Op)','DT ref (Chk)'},'Location','NorthEast');

set(gcf,'Tag','DT_AVG');
title(['DT  Brewer#', Cal.brw_str{Cal.n_inst}]);
legend(s,{'DT ref (Op)','DT ref (Chk)'},'Location','NorthEast');
box on
ylabel('DT ns');
set(gca,'Xlim',gx)


%%
%%
figure(maxf(findobj('Tag','DTAVG')));
hold all;
s=[];
vline_v(event_info.dates,'k',event_info.labels)
s(1)=stairs(tabla_avg.data(:,1),tabla_avg.data(:,7),'linewidth',4);
s(2)=stairs(tabla_avg.data(:,1),tabla_avg.data(:,9),'linewidth',4);
s(3)=stairs([events_cfg_op.data(1,:) sl_data(end,1)],1E9*[events_cfg_op.data(9,:) events_cfg_op.data(9,end)],'-','color','m','LineWidth',2);
s(4)=stairs([events_cfg_chk.data(1,:) sl_data(end,1)],1E9*([events_cfg_chk.data(9,:) events_cfg_chk.data(9,end)]),'-','color','k','LineWidth',2);
legend(s,{'DT high','Dt low','DT ref (Op)','DT ref (Chk)'},'Location','NorthEast');
%set(gca,'Ylim',[25,35])
f=figure(maxf(findobj('tag','DTAVG')));
Width=15; Height=20;
set(f,'tag',[Cal.brw_str{Cal.n_inst},'_',get(f,'tag')])
printfiles_report(f,Cal.dir_figs,'Width',Width,'Height',Height);


%% Command-Print 
fprintf('\r\nAVG data\r\n'); 
% if size(tabla_avg.data,1)<15      
%    displaytable(tabla_avg.data(:,2:end)',tabla_avg.events,15,'.4f',tabla_avg.data_lbl);
% else
%    displaytable(tabla_avg.data(:,2:end),tabla_avg.data_lbl,7,'.4f',tabla_avg.events);
% end
avg_t=display_table(tabla_avg.data(:,2:end)',tabla_avg.events,15,'.4f',tabla_avg.data_lbl);
writetable(avg_t,'avg_ev_2019_183.txt');
matrix2latex_ctable(tabla_avg.data(:,2:end)',fullfile(Cal.file_latex,['table_avg_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                   'rowlabels',tabla_avg.data_lbl,'columnlabels',tabla_avg.events,...
                                   'alignment','c','resize',0.9);
                               
                               
 avg_t=array2table(tabla_avg.data(:,1:end)','RowNames',['Date',str2name(tabla_avg.data_lbl)],'VariableNames',varname(cellstr(datestr(tabla_avg.data(:,1)))))  ;                           
 %avg_t.Fecha=datetime(datestr(avg_t.Date));
 %avg_t=[avg_t,tabla_avg.events];

%input.data =avg_t(:,2:11);
% lx=latexTable(input);
% lx=strrep(lx,'_',' ');
% lx=strrep(lx,'x ',' ');
% fid=fopen('sl_avg_183.tex','w');
% [nrows,ncols] = size(lx);
% for row = 1:nrows
%     fprintf(fid,'%s\n',lx{row,:});
% end
% fclose(fid);

%avg_t.Date=datetime(datestr(tabla_avg.data(:,1)))

%% Temperature dependence

close all; 
 
t.dates=[datenum(2015,6,1),datenum(2017,12,10),datenum(2018,05,12)];
t.labels=[{'start','hv','SL chg'}];
%t.dates=[datenum(2019,1,1)];
%t.labels=[{'2019'}];
%  Hay que mirar si hay cambios en la intensidad de la lampara ->
%  
 
[tabla_tc,sl_raw_183]=report_temperature(Cal,OP_config,OP_config,'grp_custom',t,'reprocess',0);
%[tabla_tc,sl_raw_183]=report_temperature(Cal,OP_config,ALT_config,'grp','events','reprocess',0)
%% Global temperature
sl=cat(1,tabla_tc.sl{:});
sl_m=grpstats(sl(:,[1,end]),{year(sl(:,1)),month(sl(:,1))});


f=figure;
set(f,'Tag','SL_R6');
plot(sl(:,1),sl(:,end),'.');hold all
plot(sl_m(:,1), sl_m(:,2),'lineWidth',4)


datetick('keeplimits');
sx=get(gca,'XLim');
vline_v(event_info.dates,'k',event_info.labels)
% set(gca,'YLim',median(events_cfg_op.data(17,:))+[-30,30])
s(1)=stairs([events_cfg_op.data(1,:) sl_data(end,1)],[events_cfg_op.data(17,:) events_cfg_op.data(17,end)],'-','color','m','LineWidth',2);
hold on
s(2)=stairs([events_cfg_chk.data(1,:) sl_data(end,1)],[events_cfg_chk.data(17,:) events_cfg_chk.data(17,end)],'-','color','k','LineWidth',2);
set(gca,'XLim',sx);
legend(s,{'obs','mean','R6 ref (Op)','R6 ref (Chk)'});
Width=24; Height=12;
set(f,'tag',[Cal.brw_str{Cal.n_inst},'_',get(f,'tag')])
set(gca,'XLim',sx);
printfiles_report(f,Cal.dir_figs,'Width',Width,'Height',Height,'no_export');


%%
%tabla_tc_183=display_table(tabla_tc.data(:,2:end)',tabla_tc.events,12,'.2f',tabla_tc.data_lbl)

%[tabla_tc,sl_raw_183]=report_temperature(Cal,OP_config,ALT_config,'grp','events');
% Command-Print
%  fprintf('\r\nTemp. Dependence\r\n'); 
%  if size(tabla_tc.data,1)<9      
%     displaytable(tabla_tc.data(:,2:end)',tabla_tc.events,12,'.2f',tabla_tc.data_lbl);
%  else
%     displaytable(tabla_tc.data(:,2:end),tabla_tc.data_lbl,8,'.2f',tabla_tc.events);
%  end 
 matrix2latex_ctable(tabla_tc.data(:,2:end)',fullfile(Cal.file_latex,['table_tc_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                    'rowlabels',tabla_tc.data_lbl,'columnlabels',tabla_tc.events,...
                                    'alignment','c','resize',0.9);
                                
ix=sort(findobj('-regexp','Tag','TEMP_COMP\w+'));
arrayfun( @(x) set(x,'tag',[Cal.brw_str{Cal.n_inst},'_',get(x,'tag')]),ix)

printfiles_report(ix',Cal.dir_figs,'Width',Width,'Height',Height);
close all

nanmean(tabla_tc.sl{1})
nanmean(tabla_tc.sl_r{1})

% SL reference 371
                                
%% dark evaluation
figure
ploty(sl_raw_183(:,[4,12]),'+')
title('Dark Count (SL) 183')
xlabel('Temperature')
grid

%% DARK

figure
gscatter(sl_raw_183(:,1),sl_raw_183(:,12),fix(sl_raw_183(:,4)/2.5)*2.5)
datetick
set(gca,'Ylim',[0,60])
vline_v(event_info.dates,'k',event_info.labels)
title('Dark Count (SL) 183')
grid
%%
figure
hx=gscatter(sl_raw_183(:,4),sl_raw_183(:,12),datestr(fix(sl_raw_183(:,1)/30)*30,'yymm'))
set(gca,'Ylim',[000,60])
title('Dark Count (SL) #183')
grid
xlabel('Temperature')
% set(findobj(hx,'DisplayName','1701'),'Marker','x')
% set(findobj(hx,'DisplayName','1601'),'Marker','x')


                                
%% Filter attenuation

% para evauar por periodos, por ejemplos cuando se cambia un filtro
close all; 

t.dates=[datenum(2010,6,1),datenum(2018,6,1),datenum(2019,4,12)];
t.labels=[{'historic','last year','now'}];

tabla_fi=report_filter(Cal,'grp_custom',t,'date_range',t.dates);


% Command-Print 
% fprintf('\r\nFI Analysis\r\n');  
%  if size(tabla_fi.data,1)<11      
%     displaytable(tabla_fi.data(:,2:end)',tabla_fi.events,12,'.2f',tabla_fi.data_lbl);
%  else
%     displaytable(tabla_fi.data(:,2:end),tabla_fi.data_lbl,10,'.2f',tabla_fi.events);
%  end
 displaytable(tabla_fi.data(:,2:end),tabla_fi.data_lbl,10,'.2f',tabla_fi.events);
 matrix2latex_ctable(tabla_fi.data(:,2:end)',fullfile(Cal.file_latex,['table_fi_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                     'rowlabels',str2latex(tabla_fi.data_lbl),'columnlabels',str2latex(tabla_fi.events),...
                                     'alignment','c','resize',0.9);

%% SC's 
close all; 

Cal.Date.CALC_DAYS=datenum(2015,6,1):now;
tabla_sc=report_sc(Cal,OP_config,'grp','events');
tabla_sc_183=display_table(tabla_sc.data(:,2:end),tabla_sc.data_lbl,15,'.0f',tabla_sc.events)
writetable(tabla_sc_183,'SC_summary_2019_183.txt')
writetable(tabla_sc_183,'SC_summary_2019_183.xls')

% Command-Print 
% fprintf('\r\nSC Analysis\r\n'); 
% if size(tabla_sc.data,1)<10      
%    displaytable(tabla_sc.data(:,2:end)',tabla_sc.events,15,'.0f',tabla_sc.data_lbl);
% else
%    displaytable(tabla_sc.data(:,2:end),tabla_sc.data_lbl,15,'.0f',tabla_sc.events);
% end
 matrix2latex_ctable(tabla_sc.data(:,2:end)',fullfile(Cal.file_latex,['table_sc_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                     'rowlabels',str2latex(tabla_sc.data_lbl),'columnlabels',str2latex(tabla_sc.events),...
                                     'alignment','c','resize',0.9);

                                
figure; set(gcf,'Tag',strcat('SC_CSN_hist',Cal.brw_str{Cal.n_inst}));
patch([min(tabla_sc.data(:,1))-10 max(tabla_sc.data(:,1))+10 max(tabla_sc.data(:,1))+10 min(tabla_sc.data(:,1))-10],...
      [repmat(1025,1,2) repmat(1027,1,2)], ...
      [.953,.953,.953],'LineStyle',':'); hold on;
errorbar(tabla_sc.data(:,1),tabla_sc.data(:,2),matadd(tabla_sc.data(:,2),-tabla_sc.data(:,3)),matadd(tabla_sc.data(:,4),-tabla_sc.data(:,2)),'*'); 
set(gca,'Layer','Top');
grid; datetick('x',12,'keepLimits','keepTicks');
title(sprintf('Brewer %s ' ,Cal.brw_name{Cal.n_inst})); 
ylabel('Cal Step Number'); box on; axis('tight');
hold on; s=stairs(tabla_sc.data(:,1),tabla_sc.data(:,end-1),'-','color','m','LineWidth',2);
vl=vline_v(events_cfg_op.data(1,:),'-r',Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))>=events_cfg_op.data(1,1),3)); 
set(vl,'LineStyle','None'); set(findobj(gcf,'Type','Text'),'FontSize',7);

ix=sort(findobj('-regexp','Tag','SC\w+'));
arrayfun( @(x) set(x,'tag',[Cal.brw_str{Cal.n_inst},'_',get(x,'tag')]),ix)

printfiles_report(ix',Cal.dir_figs,'Width',Width,'Height',Height);
close all
writetable(tabla_sc_183,'SC_summary_183.txt')
writetable(tabla_sc_183,'SC_summary_183.xls')

%nanmean(tabla_tc.sl{1})
%nanmean(tabla_tc.sl_r{1})



%% CZ Report
close all; [tabla_HS tabla_HL]=report_wavelength(Cal,'grp','events');
tabla_hl_183=display_table(tabla_HS.data(:,2:end)',tabla_HS.events,12,'.4f',tabla_HS.data_lbl)
tabla_hs_183=display_table(tabla_HL.data(:,2:end)',tabla_HL.events,12,'.4f',tabla_HL.data_lbl)

% Command-Print
%  fprintf('\r\nHS Scans\r\n'); 
%  if size(tabla_HS.data,1)<11      
%    displaytable(tabla_HS.data(:,2:end)',tabla_HS.events,12,'.4f',tabla_HS.data_lbl);
%  else
%    displaytable(tabla_HS.data(:,2:end),tabla_HS.data_lbl,11,'.4f',tabla_HS.events);
%  end
  matrix2latex_ctable(tabla_HS.data(:,2:end)',fullfile(Cal.file_latex,['table_hs_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                     'rowlabels',tabla_HS.data_lbl,'columnlabels',tabla_HS.events,...
                                     'alignment','c','resize',0.9);
 
%  fprintf('\r\nHL Scans\r\n'); 
%  if size(tabla_HL.data,1)<11     
%    displaytable(tabla_HL.data(:,2:end)',tabla_HL.events,12,'.4f',tabla_HL.data_lbl);
%  else
%    displaytable(tabla_HL.data(:,2:end),tabla_HL.data_lbl,11,'.4f',tabla_HL.events);
%  end
 matrix2latex_ctable(tabla_HL.data(:,2:end)',fullfile(Cal.file_latex,['table_hl_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                    'rowlabels',tabla_HL.data_lbl,'columnlabels',tabla_HL.events,...
                                    'alignment','c','resize',0.9);

%% DSP's 
close all; 
Cal.Date.CALC_DAYS=datenum(2015,6,1):now;
tabla_dsp=report_dispersion_new(Cal,'grp','events','fpath',fullfile(Cal.path_root,'..','DSP'),'process',0,...
                                           'date_range',Cal.Date.CALC_DAYS);  

Cal.Date.CALC_DAYS=datenum(2015,6,1):now;
[tabla_dsp_week,dsp_quad,dsp_cubic]=report_dispersion_new(Cal,'grp','week','fpath',fullfile(Cal.path_root,'..','DSP'),'process',0,...
                                           'date_range',Cal.Date.CALC_DAYS);  
                                       
fprintf('\r\nDSP  week Analysis\r\n');  
jn=~isnan(tabla_dsp_week.data(:,2));
dsp_week=array2table(tabla_dsp_week.data(jn,1:end),'VariableNames',varname(tabla_dsp_week.data_lbl),'Rownames',varname(tabla_dsp_week.events(jn)));
dsp_week.Date=datetime(datestr(tabla_dsp_week.data(jn,1)));

writetable(dsp_week,'dsp_2019_183.txt')


t_dsp_183=display_table(tabla_dsp_week.data(jn,[1,2 15,17]),tabla_dsp_week.data_lbl([1,2 15,17]),10,'.4f',tabla_dsp_week.events(jn));
matrix2latex_ctable(tabla_dsp_week.data(jn,15:end),fullfile(Cal.file_latex,['table_dsp_week',Cal.brw_str{Cal.n_inst},'.tex']),...
                                    'rowlabels',tabla_dsp_week.events,'columnlabels',tabla_dsp_week.data_lbl(14:end),...
                                    'alignment','c','resize',0.9);
                                      
                                       
                                       

events_cfg_op =getcfgs(tabla_dsp.data(:,1)',OP_config);    
events_cfg_chk=getcfgs(tabla_dsp.data(:,1)',ALT_config);    
jn=~isnan(tabla_dsp.data(:,2));
%tabla_dsp_183=display_table(tabla_dsp.data(jn,[2:7 14:end]),tabla_dsp.data_lbl([2:7 14:end]),10,'.4f',tabla_dsp.events(jn))

dsp_ev=array2table(tabla_dsp.data(jn,1:end),'VariableNames',varname(tabla_dsp.data_lbl),'Rownames',varname(tabla_dsp.events(jn)));
dsp_ev.Date=datetime(datestr(tabla_dsp.data(jn,1)));

writetable(dsp_ev,'dsp_avg_2019_183.txt')


% Command-Print 
fprintf('\r\nDSP Analysis\r\n'); 
jn=~isnan(tabla_dsp.data(:,2));
if size(tabla_dsp.data,1)<13      
    displaytable(tabla_dsp.data(jn,[2:8 15:end])',tabla_dsp.events(jn),12,'.4f',tabla_dsp.data_lbl([2:7 14:end]));
 else
    displaytable(tabla_dsp.data(:,[2:8 15:end]),tabla_dsp.data_lbl([2:7 14:end]),10,'.4f',tabla_dsp.events);
 end
 matrix2latex_ctable(tabla_dsp.data(jn,15:end),fullfile(Cal.file_latex,['table_dsp_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                    'rowlabels',str2latex(tabla_dsp.events(jn)),'columnlabels',str2latex(tabla_dsp.data_lbl(14:end)),...
                                    'alignment','c','resize',0.9);

                                %%   Historic 
figure; set(gcf,'Tag',strcat('DSP_A1_HIST',Cal.brw_str{Cal.n_inst})); 
tabla_dsp.data(isnan(tabla_dsp.data(:,2)),:)=[];
l1=ploty(tabla_dsp.data(:,[1 15 17]),'s');
set(l1(1),'Marker','s','LineStyle','-','Color','k','MarkerFaceColor','k'); 
set(l1(2),'Marker','s','LineStyle','-','Color','g','MarkerFaceColor','g');
lim=get(gca,'XLim'); set(gca,'YLim',[0.3360 0.3435],'XLim',[lim(1)-10 lim(2)+10]); 
hold on; s(2)=stairs([events_cfg_chk.data(1,:) tabla_dsp.data(end,1)],[events_cfg_chk.data(7,:) events_cfg_chk.data(7,end)],'-','color','m','LineWidth',2);
         s(1)=stairs([events_cfg_op.data(1,:) tabla_dsp.data(end,1)],[events_cfg_op.data(7,:) events_cfg_op.data(7,end)],'-','color','b','LineWidth',2);
vl=vline_v(events_cfg_op.data(1,:),'-r',Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))>=events_cfg_op.data(1,1),3)); 
set(vl,'LineStyle','None'); set(findobj(gca,'Type','text'),'FontSize',7);    
title(sprintf('A1: %s',Cal.brw_name{Cal.n_inst}));
datetick('x',12,'KeepLimits','keepTicks'); ylabel('Ozone Absorption Coefficient (A1)'); grid
legendflex([l1;s(1);s(2)],{'A1 Quad','A1 Cubic','A1 ref (Op)','A1 ref (Chk)'}, ...
                           'anchor', {'sw','sw'}, 'buffer',[10 -5], 'nrow',2,'fontsize',8,'box','on');
set(findobj(gcf,'Type','text'),'BackgroundColor','w');

printfiles_report(gcf,Cal.dir_figs,'Width',21,'Height',9,'LineMode','Scaled');

%%

                            
                                                                     
figure; 
set(gcf,'Tag',strcat('DSP_A1',Cal.brw_str{Cal.n_inst})); 
tabla_dsp.data(isnan(tabla_dsp.data(:,2)),:)=[];
l1=ploty(tabla_dsp.data(:,[1 15 17]),'s');
set(l1(1),'Marker','s','LineStyle','-','Color','k','MarkerFaceColor','k'); 
set(l1(2),'Marker','s','LineStyle','-','Color','g','MarkerFaceColor','g');
lim=get(gca,'XLim');
set(gca,'YLim',[0.3360 0.3435],'XLim',[lim(1)-10 lim(2)+10]); 
hold on; 
s(2)=stairs([events_cfg_chk.data(1,:) tabla_dsp.data(end,1)],[events_cfg_chk.data(7,:) events_cfg_chk.data(7,end)],'-','color','m','LineWidth',2);
 s(1)=stairs([events_cfg_op.data(1,:) tabla_dsp.data(end,1)],[events_cfg_op.data(7,:) events_cfg_op.data(7,end)],'-','color','b','LineWidth',2);

%vl=vline_v(events_cfg_op.data(1,:),'-r',Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))>=events_cfg_op.data(1,1),3)); 
%set(vl,'LineStyle','None'); set(findobj(gca,'Type','text'),'FontSize',7);    

title(sprintf('A1: %s',Cal.brw_name{Cal.n_inst}));
datetick('x',12,'KeepLimits','keepTicks'); ylabel('Ozone Absorption Coefficient (A1)'); grid
legendflex([l1;s(1);s(2)],{'A1 Quad','A1 Cubic','A1 ref (Op)','A1 ref (Chk)'}, ...
                           'anchor', {'sw','sw'}, 'buffer',[10 -5], 'nrow',2,'fontsize',12,'box','off');
set(findobj(gcf,'Type','text'),'BackgroundColor','w');

printfiles_report(gcf,Cal.dir_figs,'Width',14,'Height',7,'LineMode','Scaled');



%%
fprintf('\r\nDSP Analysis\r\n');  
jn=~isnan(tabla_dsp.data(:,2));
% if any(jnan)
% tabla_dsp.data(jnan,:)=[];
% tabla_~dsp.events(jnan)=[];
% end
dsp_table=array2table(tabla_dsp.data(jn,1:end),'VariableNames',varname(tabla_dsp.data_lbl),'Rownames',varname(tabla_dsp.events(jn)));
dsp_table.Date=datetime(datestr(tabla_dsp.data(:,1)));

t_dsp_183=display_table(tabla_dsp.data(jn,[1,2 15,17]),tabla_dsp.data_lbl([1,2 15,17]),10,'.4f',tabla_dsp.events(jn))


matrix2latex_ctable(tabla_dsp.data(jn,15:end),fullfile(Cal.file_latex,['table_dsp_',Cal.brw_str{Cal.n_inst},'.tex']),...
                                    'rowlabels',tabla_dsp.events,'columnlabels',tabla_dsp.data_lbl(14:end),...
                                    'alignment','c','resize',0.9);
                                
                                

                                      


%%
figure; 
set(gcf,'Tag','DSP_A1_AVG')
l1=ploty(tabla_dsp.data(:,[1 15 17]),'s'); 
hold all
errorbar(tabla_dsp.data(:,1),tabla_dsp.data(:,15),tabla_dsp.data(:,16));
errorbar(tabla_dsp.data(:,1),tabla_dsp.data(:,17),tabla_dsp.data(:,18));
set(l1(1),'Marker','s','LineStyle','-','Color','k','MarkerFaceColor','k'); 
set(l1(2),'Marker','s','LineStyle','-','Color','g','MarkerFaceColor','g');
lim=get(gca,'XLim');
set(gca,'YLim',[0.3360 0.3435],'XLim',[lim(1)-10 lim(2)+10]); 
vline_v(event_info.dates,'r',event_info.labels)
hold on; 
s(2)=stairs([events_cfg_chk.data(1,:) tabla_dsp.data(end,1)],[events_cfg_chk.data(7,:) events_cfg_chk.data(7,end)],'-','color','m','LineWidth',2);
s(1)=stairs([events_cfg_op.data(1,:) tabla_dsp.data(end,1)],[events_cfg_op.data(7,:) events_cfg_op.data(7,end)],'-','color','b','LineWidth',2);

%vl=vline_v(events_cfg_op.data(1,:),'-r',Cal.events_raw{Cal.n_inst}(cell2mat(Cal.events_raw{Cal.n_inst}(:,2))>=events_cfg_op.data(1,1),3)); 
%set(vl,'LineStyle','None'); set(findobj(gca,'Type','text'),'FontSize',7);    

title(sprintf('A1: %s',Cal.brw_name{Cal.n_inst}));
datetick('x',12,'KeepLimits','keepTicks'); ylabel('Ozone Absorption Coefficient (A1)'); grid
set(findobj(gcf,'Type','text'),'BackgroundColor','w');
m183=nanmean(tabla_dsp.data(:,[15,17]));
hline(m183(1),'k',sprintf('quad=%.4f ',m183(1)))
hline(m183(2),'g',sprintf(' cubic=%.4f',m183(2)))
legendflex([l1;s(1);s(2)],{'A1 Quad','A1 Cubic','A1 ref (Op)','A1 ref (Chk)'}, ...
       'anchor', {'sw','sw'}, 'buffer',[15 15], 'nrow',2,'fontsize',12,'box','off');

%%
figure
set(gcf,'Tag','DSP_A1_RES')
mq=mean_smooth_abs(tabla_dsp.data(:,1),tabla_dsp.data(:,[15]),90,0);
mc=mean_smooth_abs(tabla_dsp.data(:,1),tabla_dsp.data(:,[17]),90,0);
hold on
m183=nanmean(tabla_dsp.data(:,[15,17]))
s183=nanstd(tabla_dsp.data(:,[15,17]))

plot(tabla_dsp.data(:,1),(mq(:,1)-m183(1))/0.001)
hold on
plot(tabla_dsp.data(:,1),(mc(:,1)-m183(2))/0.001)
legend({'cuadratic','cubic'})
plot(tabla_dsp.data(:,1),(tabla_dsp.data(:,15)-m183(1))/0.001,'k+')
hold on
plot(tabla_dsp.data(:,1),(tabla_dsp.data(:,17)-m183(2))/0.001,'bx')

datetick('x','mmm/yy','keepticks')
grid on
ylabel('Micromenter step')
title({'Brewer  #183 Ozone Abs coeff diff vs mean',sprintf('quad=%.4f cubic=%.4f',m183)})
box on
set(gca,'YLim',[-2 2])
vline_v(event_info.dates,'k',event_info.labels);
hfill([-0.5,0.5],'grey')

##### SOURCE END #####
--></body></html>